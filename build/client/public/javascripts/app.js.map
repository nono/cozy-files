{"version":3,"sources":["app/application.coffee","app/collections/files.coffee","app/collections/upload_queue.coffee","app/initialize.coffee","app/lib/base_view.coffee","app/lib/client.coffee","app/lib/folder_helpers.coffee","app/lib/long-list-rows.coffee","app/lib/socket.coffee","app/lib/view_collection.coffee","app/locales/de.json","app/locales/en.json","app/locales/es.json","app/locales/fr.json","app/locales/ro.json","app/models/file.coffee","app/router.coffee","app/utils/plugin_utils.coffee","app/views/breadcrumbs.coffee","app/views/file_info.coffee","app/views/file_view.coffee","app/views/files.coffee","app/views/folder.coffee","app/views/gallery.coffee","app/views/modal.coffee","app/views/modal_bulk_move.coffee","app/views/modal_conflict.coffee","app/views/modal_share.coffee","app/views/public_folder.coffee","app/views/templates/breadcrumbs_element.jade","app/views/templates/file.jade","app/views/templates/file_edit.jade","app/views/templates/files.jade","app/views/templates/folder.jade","app/views/templates/modal.jade","app/views/templates/modal_folder.jade","app/views/templates/progressbar.jade","app/views/templates/upload_status.jade","app/views/upload_status.coffee","app/widgets/progressbar.coffee","app/widgets/tags.coffee"],"names":[],"mappings":"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AC,GAAN;WAEd,IAAC,SAAD,CAAU,IAAC,MAAX;EAJQ;;2BAQZ,SAAQ;AACJ;IAAA,WAAW,IAAC,oBAAD;IACX,aAAa,EAAE,QAAF;IACb,eAAe,IAAC,WAAU,CAAC,IAAZ,CAAiB;aAAA,SAAC,IAAD,EAAO,KAAP;AAC5B;QAAA,OAAO,KAAC,MAAM,KAAI,CAAC,GAAL;QACd,YAAY,UAAU,CAAC,KAAX,CAAiB,IAAI,CAAC,GAAtB;AACZ,eAAO,QAAS,cAAe;MAHH;IAAA,QAAjB;IAKf,IAAa,YAAb;aAAA,IAAC,OAAD;;EARI;;;;GAnHkC;;;CCf9C;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvJA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxJA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvJA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvJA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzGA;AAAA;;ACAA;EAAA;;;;;AAAA,SAAS,QAAQ,eAAR;;;AAET;;;;;;;;;;;;;;;;;;;;;;AAqBA,MAAM,CAAC,OAAP,GAAuB;;;iBAInB,aAAY;;iBAGZ,eAAc;;iBAGd,QAAO;;iBAGP,eAAc;;iBAId,oBAAmB;;EAGnB,IAAC,eAAD,GAAiB,CAAC,IAAD,EAAO,WAAP,EAAoB,UAApB,EAAgC,SAAhC,EAA2C,UAA3C;;iBAEjB,cACI;IAAA,4BAA2C,WAA3C;IACA,wBAA2C,aAD3C;IAEA,cAA2C,WAF3C;IAGA,iBAA2C,WAH3C;IAIA,qBAA2C,WAJ3C;IAKA,mBAA2C,WAL3C;IAMA,sBAA2C,WAN3C;IAOA,sCAA2C,WAP3C;IAQA,4BAA2C,mBAR3C;IASA,iCAA2C,mBAT3C;IAUA,8BAA2C,mBAV3C;IAWA,sCAA2C,mBAX3C;IAYA,qBAA2C,kBAZ3C;IAaA,uBAA2C,kBAb3C;IAcA,4BAA2C,kBAd3C;IAeA,yBAA2C,kBAf3C;IAgBA,0CAA2C,kBAhB3C;IAiBA,mBAA2C,UAjB3C;IAkBA,aAA2C,WAlB3C;IAmBA,YAA2C,WAnB3C;IAoBA,YAA2C,WApB3C;IAqBA,4BAA2C,WArB3C;IAsBA,sBAA2C,WAtB3C;IAuBA,mBAA2C,WAvB3C;IAwBA,YAA2C,WAxB3C;IAyBA,oBAA2C,WAzB3C;IA0BA,wBAA2C,WA1B3C;IA2BA,iCAA2C,WA3B3C;IA4BA,sBAA2C,WA5B3C;IA6BA,0BAA2C,YA7B3C;IA8BA,aAA2C,YA9B3C;IA+BA,aAA2C,YA/B3C;IAgCA,cAA2C,YAhC3C;IAiCA,eAA2C,YAjC3C;IAkCA,gBAA2C,YAlC3C;IAmCA,cAA2C,YAnC3C;IAoCA,aAA2C,YApC3C;IAqCA,eAA2C,YArC3C;IAsCA,2BAA2C,YAtC3C;IAuCA,gBAA2C,YAvC3C;IAwCA,cAA2C,YAxC3C;IAyCA,cAA2C,YAzC3C;IA0CA,gBAA2C,YA1C3C;IA2CA,cAA2C,YA3C3C;IA4CA,gBAA2C,YA5C3C;IA6CA,eAA2C,YA7C3C;IA8CA,cAA2C,YA9C3C;IA+CA,gBAA2C,YA/C3C;IAgDA,eAA2C,YAhD3C;IAiDA,iBAA2C,YAjD3C;IAkDA,aAA2C,YAlD3C;IAmDA,eAA2C,YAnD3C;IAoDA,aAA2C,YApD3C;IAqDA,cAA2C,YArD3C;IAsDA,aAA2C,YAtD3C;IAuDA,mBAA2C,cAvD3C;IAwDA,mBAA2C,cAxD3C;IAyDA,mBAA2C,cAzD3C;IA0DA,sBAA2C,cA1D3C;IA2DA,uBAA2C,cA3D3C;IA4DA,sBAA2C,cA5D3C;IA6DA,0BAA2C,cA7D3C;IA8DA,4BAA2C,cA9D3C;IA+DA,gCAA2C,cA/D3C;IAgEA,iCAA2C,cAhE3C;IAiEA,oBAA2C,cAjE3C;;;EAoES,cAAC,OAAD;;AACT;IAAA,+CAAyB,CAAE,WAAjB;IACV,IAAG,qBAAa,aAAY,MAAZ,gBAAoB,QAApB,CAAhB;MACI,OAAO,CAAC,IAAR,GAAe,QADnB;;IAGA,sCAAM,OAAN;EALS;;iBASb,UAAS;AACL;IAAA,OAAO,IAAC,IAAD,CAAK,MAAL;IACP,IAAqB,CAAC,IAAI,CAAC,MAAL,GAAc,CAAf,KAAsB,CAAC,IAAK,GAAL,KAAa,GAAd,CAA3C;MAAA,OAAO,MAAI,KAAX;;IACA,OAAO,IAAC,IAAD,CAAK,MAAL;AACP,WAAU,IAAD,GAAM,GAAN,GAAS;EAJb;;iBAMT,WAAW;AAAG,WAAO,IAAC,IAAD,CAAK,MAAL,MAAgB;EAA1B;;iBACX,SAAW;AAAG,WAAO,IAAC,IAAD,CAAK,MAAL,MAAgB;EAA1B;;iBACX,UAAW;AAAG,WAAO,IAAC,IAAD,CAAK,MAAL,MAAgB,MAAhB,IAA2B,IAAC,IAAD,CAAK,OAAL,MAAiB;EAAtD;;iBACX,WAAW;AAAG,WAAO,IAAC,IAAD,CAAK,MAAL,MAAgB;EAA1B;;iBACX,SAAW;AAAG,WAAO,IAAC,IAAD,CAAK,IAAL,MAAc;EAAxB;;iBACX,WAAW;AACP;IAAA,YAAY,IAAC,IAAD,CAAK,WAAL;AACZ,WAAO,uBAAe,CAAC,cAAa,QAAb,IAAyB,SAAS,CAAC,MAAV,GAAmB,CAA7C;EAFf;;iBAIX,YAAW;AAAG;AAAA,WAAO,IAAC,OAAD,MAAc;EAAxB;;iBACX,WAAU;AAAG,WAAO,IAAC,OAAD,MAAc,CAAI,IAAC,UAAD,EAAlB,IAAmC,CAAI,IAAC,IAAD,CAAK,WAAL;EAAjD;;iBAEV,yBAAwB;AAAG,WAAO,IAAC,SAAD,MAAgB,IAAC;EAA3B;;;AAExB;;;;iBAGA,cAAa;AAAG,WAAO,IAAC,OAAD,MAAc,IAAC,aAAD,KAAiB;EAAzC;;iBACb,aAAY;AAAG,WAAO,IAAC,OAAD,MAAc,IAAC,aAAD,KAAiB;EAAzC;;iBACZ,YAAW;AAAG,WAAO,IAAC,OAAD,MAAc,IAAC,aAAD,KAAiB;EAAzC;;iBACX,aAAY;AAAG,WAAO,IAAC,aAAD,KAAiB;EAA3B;;iBACZ,gBAAe;AACX,WAAO,IAAC,YAAD,MAAkB,IAAC,WAAD,EAAlB,IAAmC,IAAC,UAAD,EAAnC,IAAmD,IAAC,WAAD;EAD/C;;;AAGf;;;;iBAGA,kBAAiB;WAAG,IAAC,iBAAD,CAAkB,WAAlB;EAAH;;iBACjB,iBAAgB;WAAG,IAAC,iBAAD,CAAkB,UAAlB;EAAH;;iBAChB,iBAAgB;WAAG,IAAC,iBAAD,CAAkB,UAAlB;EAAH;;iBAChB,gBAAe,SAAC,KAAD;WAAW,IAAC,iBAAD,CAAkB,SAAlB,EAA6B,KAA7B;EAAX;;iBACf,cAAa;IACT,IAAC,UAAD,GAAa;WACb,IAAC,iBAAD,CAAkB,IAAlB;EAFS;;;AAIb;;;;;;;;iBAOA,mBAAkB,SAAC,MAAD,EAAS,KAAT;AACd;;MADuB,QAAQ;;IAC/B,IAAG,aAAc,IAAI,CAAC,cAAnB,aAAH;MACI,UAAU,4BAAyB,MAAzB,GAAgC,OAAhC,IACA,SAAM,IAAI,CAAC,cAAX;AACV,YAAU,UAAM,OAAN,EAHd;KAAA;MAKI,IAAC,MAAD,GAAS;MACT,IAAC,aAAD,GAAgB;aAChB,IAAC,QAAD,CAAS,QAAT,EAAmB,IAAnB,EAPJ;;EADc;;iBAalB,gBAAe,SAAC,MAAD;IAGX,IAAG,6BAAH;MACI,IAAC,iBAAD,CAAkB,MAAlB;aACA,IAAC,iBAAD,GAAoB,KAFxB;KAAA;aAOI,IAAC,UAAD,GAAa,OAPjB;;EAHW;;;AAaf;;;;iBAGA,oBAAmB;AAAG,WAAO,IAAC,IAAD,CAAK,WAAL,KAAsB,CAAI,IAAC,cAAD;EAApC;;;AAInB;;;;;;iBAKA,iBAAgB;AAAG,WAAO,IAAC;EAAX;;iBAGhB,qBAAoB,SAAC,cAAD;;MAAC,iBAAiB;;WAClC,IAAC,qBAAD,CAAsB,CAAI,IAAC,eAAD,EAA1B,EAA6C,cAA7C;EADgB;;iBAIpB,uBAAsB,SAAC,YAAD,EAAe,cAAf;;MAAe,iBAAiB;;IAClD,IAAC,aAAD,GAAgB;WAChB,IAAC,QAAD,CAAS,eAAT,EAA0B;MAAA,KAAK,IAAC,IAAN;MAAW,gBAAgB,cAA3B;KAA1B;EAFkB;;iBAMtB,QAAO,SAAC,IAAD;IACH,OAAO,IAAI,CAAC;AACZ,WAAO;EAFJ;;iBAKP,gBAAe;IACX,IAAG,IAAC,OAAD,EAAH;aAAkB,GAAlB;KAAA;aAA4B,CAAC,IAAC,IAAD,CAAK,MAAL,CAAD,IAAc,GAAd,GAAgB,CAAC,IAAC,IAAD,CAAK,MAAL,CAAD,EAA5C;;EADW;;iBAKf,OAAM,SAAC,MAAD,EAAS,KAAT,EAAgB,OAAhB;AAIF;IAAA,IAAG,KAAK,CAAC,IAAT;MAKI,SAAS;MACT,IAAC,GAAD,GAAM;MAEN,WAAe;MACf,QAAQ,CAAC,MAAT,CAAgB,MAAhB,EAAwB,KAAK,CAAC,GAAN,CAAU,MAAV,CAAxB;MACA,QAAQ,CAAC,MAAT,CAAgB,MAAhB,EAAwB,KAAK,CAAC,GAAN,CAAU,MAAV,CAAxB;MACA,QAAQ,CAAC,MAAT,CAAgB,kBAAhB,EAAoC,KAAK,CAAC,GAAN,CAAU,kBAAV,CAApC;MACA,IAAqC,IAAC,UAAtC;QAAA,QAAQ,CAAC,MAAT,CAAgB,WAAhB,EAA6B,IAA7B;;MACA,QAAQ,CAAC,MAAT,CAAgB,MAAhB,EAAwB,KAAK,CAAC,IAA9B;MAGA,WAAW,SAAC,CAAD;QACP,KAAK,CAAC,MAAN,GAAe,CAAC,CAAC;eACjB,KAAK,CAAC,OAAN,CAAc,UAAd,EAA0B,CAA1B;MAFO;MAIX,CAAC,CAAC,MAAF,CAAS,OAAT,EACI;QAAA,aAAa,KAAb;QACA,MAAM,QADN;QAGA,KAAK;iBAAA;AACD;YAAA,MAAM,CAAC,CAAC,YAAY,CAAC,GAAf;YACN,IAAG,GAAG,CAAC,MAAP;cACI,GAAG,CAAC,MAAM,CAAC,gBAAX,CAA4B,UAA5B,EAAwC,QAAxC,EAAkD,KAAlD;cACA,KAAC,iBAAD,GAAoB,IAFxB;;mBAGA;UALC;QAAA,QAHL;OADJ,EApBJ;;WA+BA,QAAQ,CAAC,IAAI,CAAC,KAAd,CAAoB,IAApB,EAAuB,SAAvB;EAnCE;;iBAqCN,UAAS;AACL;IAAA,SAAY,GAAG,CAAC,QAAP,GAAqB,KAArB,GAAgC;IAEzC,IAAG,IAAC,SAAD,EAAH;aACI,SAAS,WADb;KAAA,MAEK,IAAG,IAAC,SAAD,EAAH;aACD,SAAS,UADR;KAAA;aAGD,SAAS,SAHR;;EALA;;iBAYT,MAAK,SAAC,QAAD;AACD;;MADE,WAAW;;IACb,MAAM;IACN,MAAS,GAAG,CAAC,QAAP,GAAqB,MAAM,CAAC,QAAQ,CAAC,MAArC,GAAiD;AAEvD,WAAO,MAAM,QAAN,GAAiB;EAJvB;;iBAOL,eAAc,SAAC,GAAD;AACV;IAAA,OAAO,KAAG,GAAG,CAAC,MAAP,GAAe,CAAC,IAAC,QAAD,EAAD,CAAf,GAA6B,IAAC;IACrC,IAAG,IAAC,OAAD,EAAH;MACI,OAAO,mBAAmB,IAAC,IAAD,CAAK,MAAL,CAAnB;MACP,OAAU,IAAD,GAAM,UAAN,GAAgB,KAF7B;;AAGA,WAAO;EALG;;iBASd,YAAW;AACP;IAAA,IAAG,IAAC,SAAD,EAAH;MACI,WAAW,UAAO,CAAC,mBAAmB,IAAC,IAAD,CAAK,MAAL,CAAnB,CAAD;aAClB,IAAC,IAAD,CAAK,QAAL,EAFJ;;EADO;;iBAOX,mBAAkB;AAEd;IAAA,IAAG,IAAC,YAAD,EAAH;aACI,IADJ;KAAA,MAEK,IAAG,IAAC,OAAD,EAAH;MACD,WAAW,aAAU,CAAC,mBAAmB,IAAC,IAAD,CAAK,MAAL,CAAnB,CAAD;aACrB,IAAC,IAAD,CAAK,QAAL,EAFC;;EAJS;;iBASlB,iBAAgB;AACZ;IAAA,IAAG,IAAC,OAAD,EAAH;MACI,WAAW,eAAY,CAAC,mBAAmB,IAAC,IAAD,CAAK,MAAL,CAAnB,CAAD;aACvB,IAAC,IAAD,CAAK,QAAL,EAFJ;KAAA,MAGK,IAAG,IAAC,SAAD,EAAH;aACD,IAAC,UAAD,GADC;;EAJO;;iBAQhB,cAAa;IACT,IAAG,IAAC,WAAU,CAAC,MAAZ,IAAsB,IAAC,WAAU,CAAC,MAAM,CAAC,KAA5C;AACI,aAAO,IAAC,IAAD,CAAK,QAAL,EADX;KAAA;AAGI,aAAO,GAHX;;EADS;;iBAOb,eAAc;IACV,IAAG,IAAC,WAAU,CAAC,MAAZ,IAAsB,IAAC,WAAU,CAAC,MAAM,CAAC,MAA5C;AACI,aAAO,IAAC,IAAD,CAAK,aAAU,CAAC,mBAAmB,IAAC,IAAD,CAAK,MAAL,CAAnB,CAAD,CAAf,EADX;KAAA;AAGI,aAAO,GAHX;;EADU;;iBAYd,cAAa;AACT;IAAA,IAAG,IAAC,SAAD,EAAH;AACI,aAAO,cADX;;IAEA,WAAY,IAAC,IAAD,CAAK,MAAL;IACZ,YAAY,IAAC,YAAY;IACzB,IAAG,sBAAc,mBAAjB;MACI,WAAW,UADf;KAAA;MAGI,WAAW,YAHf;;IAIA,IAAG,IAAC,WAAU,CAAC,MAAZ,IAAsB,IAAC,WAAU,CAAC,MAAM,CAAC,KAA5C;MACI,WAAW,aADf;;AAEA,WAAO;EAXE;;iBAcb,WAAU,SAAC,KAAD;AACN;IAAA,SAAS;IACT,IAAG,CAAI,KAAK,CAAC,IAAV,IAAkB,KAAK,CAAC,IAAN,KAAc,EAAnC;MACI,MAAM,CAAC,IAAP,CACI;QAAA,OAAO,MAAP;QACA,OAAO,qBADP;OADJ,EADJ;;IAKA,IAAG,MAAM,CAAC,MAAP,GAAgB,CAAnB;AACI,aAAO,OADX;;EAPM;;iBAWV,mBAAkB,SAAC,SAAD,EAAY,UAAZ,EAAwB,QAAxB;AACd;IAAA,MAAmB,aAAa,EAAhC,EAAC,qBAAD,EAAU;;MACV,aAAc;eAAA,SAAC,IAAD;iBAAU,KAAC,IAAD,CAAK,IAAI,CAAC,GAAV;QAAV;MAAA;;IACd,IAAC,QAAD,CAAS,SAAT,EAAoB,IAApB,EAAuB,IAAvB,EAA6B,SAA7B;IACA,SAAS,CAAC,OAAV,GAAoB;aAAA,SAAC,IAAD;QAChB,IAAmB,UAAnB;UAAA,WAAW,IAAX;;QACA,KAAC,QAAD,CAAS,MAAT,EAAiB,KAAjB,EAAoB,IAApB,EAA0B,SAA1B;QACA,IAAgB,OAAhB;iBAAA,QAAQ,IAAR;;MAHgB;IAAA;WAIpB,SAAS,CAAC,KAAV,GAAkB;aAAA,SAAC,KAAD;QACd,IAAkB,QAAlB;UAAA,SAAS,KAAT;;QACA,KAAC,QAAD,CAAS,OAAT,EAAkB,KAAlB,EAAqB,KAArB,EAA4B,EAA5B;QACA,IAAe,KAAf;iBAAA,MAAM,KAAN;;MAHc;IAAA;EARJ;;;AAalB;;;;;;iBAKA,eAAc,SAAC,SAAD;AACV;IAAA,IAAC,iBAAD,CAAkB,SAAlB;IAEA,MAAQ,CAAC,IAAC,QAAD,EAAD,IAAY;IACpB,MAAM,MAAM,CAAC,QAAQ,CAAC;IACtB,IAAG,GAAG,CAAC,QAAJ,IAAiB,CAAI,IAAC,SAAD,EAAxB;MACI,MAAM,KAAE,CAAC,IAAC,QAAD,EAAD,CAAF,GAAgB,IAAC,GAAjB,GAAoB,UAApB,GAA8B,IADxC;KAAA,MAEK,IAAG,IAAC,SAAD,EAAH;MACD,OAAO,IADN;;WAGL,MAAM,CAAC,IAAP,CAAY,GAAZ,EAAiB;MAAA,IAAI,IAAC,GAAL;KAAjB,EAA0B;aAAA,SAAC,GAAD,EAAM,IAAN;AACtB;QAAA,IAAG,WAAH;UACI,KAAC,cAAD,CAAe,EAAf;iBACA,UAAU,GAAV,EAFJ;SAAA;UAII,IAAG,oBAAH;YACK,sBAAD,EAAU,uBADd;WAAA;YAII,UAAU;YACV,UAAU,GALd;;UAOA,KAAC,cAAD,CAAe,WAAW,EAA1B;iBACA,UAAU,IAAV,EAAgB,OAAhB,EAAyB,OAAzB,EAZJ;;MADsB;IAAA,QAA1B;EAVU;;iBA2Bd,gBAAe,SAAC,OAAD;IACX,IAAG,IAAC,IAAD,CAAK,MAAL,MAAgB,QAAnB;aACI,IAAC,WAAD,GAAc,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,MAAhB,EAAD,EAA2B,IAAC,OAAD,EAA3B,EADlB;KAAA;MAGI,OAAO,CAAC,OAAR,CAAgB,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,MAAhB,EAAhB;MAEA,KAA8B,IAAC,OAAD,EAA9B;QAAA,OAAO,CAAC,IAAR,CAAa,IAAC,OAAD,EAAb;;aACA,IAAC,WAAD,GAAc,QANlB;;EADW;;iBASf,eAAc;AACV;IAAA,IAAG,GAAG,CAAC,QAAP;AACI,aAAO,KADX;KAAA;MAGI,qBAAqB,IAAC,IAAD,CAAK,oBAAL;MACrB,IAAG,CAAI,kBAAJ,IAA0B,kBAAkB,CAAC,MAAnB,KAA6B,CAA1D;AACI,eAAO,IAAC,IAAD,CAAK,WAAL,EADX;OAAA;AAGI,eAAO,kBAAmB,GAAE,CAAC,UAHjC;OAJJ;;EADU;;;;GA5YkB,QAAQ,CAAC;;;;ACvB7C;EAAA;;;AAAA,MAAM,QAAQ,aAAR;;AACN,OAAO,QAAQ,eAAR;;AACP,iBAAiB,QAAQ,qBAAR;;AACjB,aAAa,QAAQ,gBAAR;;AACb,mBAAmB,QAAQ,uBAAR;;;AAEnB;;;;;AAIA,MAAM,CAAC,OAAP,GAAuB;;;;;;;mBAEnB,aAAY;;mBAEZ,SACI;IAAA,IAAI,MAAJ;IACA,qBAAsB,QADtB;IAEA,iBAAkB,QAFlB;;;mBAIJ,OAAM;AACF;IAAA,SAAS,GAAG,CAAC,IAAI,CAAC,GAAT,CAAa,IAAb;WACT,IAAC,gBAAD,CAAiB,MAAjB;EAFE;;mBAIN,SAAQ,SAAC,EAAD;WAAQ,IAAC,gBAAD,CAAiB,EAAjB;EAAR;;mBAER,SAAQ,SAAC,KAAD;AACJ;IAAA,SAAa,SACT;MAAA,IAAI,KAAJ;MACA,MAAM,QADN;MAEA,MAAQ,CAAC,EAAE,0BAAF,CAAD,IAA+B,IAA/B,GAAmC,KAAnC,GAAyC,GAFjD;KADS;IAKb,IAAsB,uBAAtB;MAAA,IAAC,WAAU,CAAC,IAAZ;;WACA,MAAM,CAAC,YAAP,CAAoB;aAAA,SAAC,GAAD,EAAM,OAAN;AAChB;QAAA,aAAiB,mBAAe,OAAf;QAIjB,IAAG,wBAAH;UACI,KAAC,WAAU,CAAC,IAAZ,CAAiB,KAAjB;iBACA,KAAC,WAAU,CAAC,YAAZ,CAAyB,MAAzB,EAAiC,UAAjC,EAFJ;SAAA;iBAII,KAAC,kBAAD,CAAmB,MAAnB,EAA2B,UAA3B,EAAuC,KAAvC,EAJJ;;MALgB;IAAA,QAApB;EAPI;;mBAmBR,kBAAiB,SAAC,QAAD;IAEb,IAAsB,uBAAtB;MAAA,IAAC,WAAU,CAAC,IAAZ;;WAGA,GAAG,CAAC,cAAc,CAAC,WAAnB,CAA+B,QAA/B,EAAyC;aAAA,SAAC,GAAD,EAAM,MAAN,EAAc,UAAd;AACrC;QAAA,IAAG,WAAH;iBAAa,OAAO,CAAC,GAAR,CAAY,GAAZ,EAAb;SAAA;UAII,OAAO,MAAM,CAAC,aAAP;UACP,IAAI,SAAQ,kBAAR,IAA8B,SAAQ,sBAA1C;YACI,UAAU,CAAC,IAAX,GAAkB;YAClB,UAAU,CAAC,KAAX,GAAmB;YACnB,UAAU,CAAC,IAAX,GAHJ;;iBAIA,KAAC,kBAAD,CAAmB,MAAnB,EAA2B,UAA3B,EATJ;;MADqC;IAAA,QAAzC;EALa;;mBAkBjB,oBAAmB,SAAC,MAAD,EAAS,UAAT,EAAqB,KAArB;;MAAqB,QAAQ;;IAC5C,IAAG,uBAAH;MACI,IAAC,WAAU,CAAC,OAAZ;MAEA,EAAE,MAAF,CAAS,CAAC,MAAV,CAAiB,EAAE,eAAF,CAAjB,EAHJ;;IAMA,IAAC,WAAD,GAAc,IAAC,eAAD,CACV;MAAA,OAAO,MAAP;MACA,YAAY,UADZ;MAEA,gBAAgB,GAAG,CAAC,cAFpB;MAGA,aAAa,GAAG,CAAC,WAHjB;MAIA,aAAa,GAAG,CAAC,WAJjB;MAKA,OAAO,KALP;KADU;WAOd,IAAC,WAAU,CAAC,MAAZ;EAde;;mBAiBnB,iBAAgB,SAAC,MAAD;IACZ,IAAG,GAAG,CAAC,QAAP;AACI,aAAW,qBAAiB,CAAC,CAAC,MAAF,CAAS,MAAT,EAAiB;QAAA,YAAY,GAAG,CAAC,IAAhB;OAAjB,CAAjB,EADf;KAAA;AAGI,aAAW,eAAW,MAAX,EAHf;;EADY;;;;GArEkB,QAAQ,CAAC;;;;ACV/C;EAAA;;AAAA,UAQI;EAAA,OAAO,SAAC,OAAD;AACH;IAAA,MAAM,QAAQ,CAAC,aAAT,CAAuB,KAAvB;IACN,GAAG,CAAC,SAAS,CAAC,GAAd,CAAkB,OAAlB;IACA,GAAG,CAAC,SAAS,CAAC,GAAd,CAAkB,MAAlB;IACA,GAAG,CAAC,SAAJ,GAAgB,6iBAa0B,CAAC,EAAE,oBAAF,CAAD,CAb1B,GAakD;IAMlE,IAAG,OAAO,CAAC,KAAX;MACI,GAAG,CAAC,aAAJ,CAAkB,cAAlB,CAAiC,CAAC,SAAlC,GAA8C,OAAO,CAAC,MAD1D;;IAEA,IAAG,OAAO,CAAC,IAAX;MACI,GAAG,CAAC,aAAJ,CAAkB,aAAlB,CAAgC,CAAC,SAAjC,GAA6C,OAAO,CAAC,KADzD;;IAEA,IAAG,OAAO,CAAC,IAAR,KAAgB,OAAnB;MACI,GAAG,CAAC,aAAJ,CAAkB,eAAlB,CAAkC,CAAC,SAAS,CAAC,GAA7C,CAAiD,UAAjD,EADJ;;IAEA,IAAG,OAAO,CAAC,IAAR,KAAgB,OAAnB;MACI,GAAG,CAAC,aAAJ,CAAkB,eAAlB,CAAkC,CAAC,SAAS,CAAC,GAA7C,CAAiD,UAAjD,EADJ;;IAEA,IAAG,OAAO,CAAC,IAAR,KAAkB,KAArB;MACI,QAAQ,CAAC,IAAI,CAAC,WAAd,CAA0B,GAA1B;MACA,MAAM,CAAC,MAAP,CAAc,GAAd,CAAkB,CAAC,KAAnB,CAAyB,MAAzB,EAFJ;;AAGA,WAAO;EAlCJ,CAAP;EAmCA,UAAU,SAAC,UAAD,EAAa,IAAb;AACN;IAAA,WAAW,UAAU,CAAC,GAAX,CAAe,SAAC,CAAD;aACtB,sBAAsB,CAAtB,GAA0B;IADJ,CAAf,CAEX,CAAC,IAFU,CAEL,GAFK;IAGX,IAAO,YAAP;MACI,OAAO,SADX;;AAGA,WAAO,IAAI,CAAC,gBAAL,CAAsB,QAAtB;EAPD,CAnCV;EA2CA,SAAS,SAAC,IAAD,EAAO,OAAP;AACL;IAAA,IAAG,CAAI,IAAI,CAAC,OAAO,CAAC,UAApB;MACI,IAAI,CAAC,OAAO,CAAC,UAAb,GAA0B;MAC1B,OAAO,QAAQ,CAAC,aAAT,CAAuB,GAAvB;MACP,IAAI,CAAC,SAAS,CAAC,GAAf,CAAmB,cAAnB;MACA,IAAI,CAAC,KAAL,GAAa,MAAM,CAAC,CAAP,CAAS,iBAAT;MACb,IAAI,CAAC,SAAL,GAAiB;MACjB,IAAI,CAAC,gBAAL,CAAsB,OAAtB,EAA+B,OAA/B;MACA,eAAe,IAAI,CAAC,UAAU,CAAC,aAAhB,CAA8B,aAA9B;oCACf,YAAY,CAAE,WAAd,CAA0B,IAA1B,WARJ;;EADK,CA3CT;;;AAsDJ,MAAM,CAAC,OAAP,GAEI;EAAA,MAAM;AACF;IAAA,IAAO,sBAAP;MACI,MAAM,CAAC,OAAP,GAAiB,GADrB;;AAIA;AAAA;;;MACI,IAAC,SAAD,CAAU,UAAV;AADJ;IAGA,MAAM,CAAC,OAAO,CAAC,OAAf,GAAyB;IAEzB,IAAG,oEAAH;MAEI,SACI;QAAA,YAAY,KAAZ;QACA,WAAW,IADX;QAEA,eAAe,KAFf;QAGA,SAAS,IAHT;;MAKJ,aAAa,SAAC,SAAD;AACT;QAAA,YAAY,SAAC,IAAD,EAAO,MAAP;AACR;UAAA,IAAG,IAAI,CAAC,QAAL,KAAmB,IAAI,CAAC,YAA3B;AACI,mBADJ;;AAGA;AAAA;eAAA;;;YACI,IAAG,UAAU,CAAC,MAAd;cACI,IAA+B,WAAU,KAAzC;gBAAA,WAAW,UAAU,CAAC,MAAtB;;cACA,IAAkC,WAAU,QAA5C;gBAAA,WAAW,UAAU,CAAC,SAAtB;;cACA,IAAG,sBACH,QAAQ,CAAC,SAAS,CAAC,IAAnB,CAAwB,UAAxB,EAAoC,IAApC,CADA;6BAEI,QAAQ,CAAC,MAAM,CAAC,IAAhB,CAAqB,UAArB,EAAiC,IAAjC,GAFJ;eAAA;qCAAA;eAHJ;aAAA;mCAAA;;AADJ;;QAJQ;QAYZ,QAAQ,SAAC,QAAD;AAEJ;UAAA,QAAQ,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAtB,CAA2B,QAAQ,CAAC,UAApC;AACR;;YAAA,UAAU,IAAV,EAAgB,KAAhB;AAAA;UAEA,QAAQ,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAtB,CAA2B,QAAQ,CAAC,YAApC;AACR;eAAA;;yBAAA,UAAU,IAAV,EAAgB,KAAhB;AAAA;;QANI;AAQR;aAAA;;uBAAA,MAAM,QAAN;AAAA;;MArBS;MAwBb,WAAe,qBAAiB,UAAjB;aACf,QAAQ,CAAC,OAAT,CAAiB,QAAjB,EAA2B,MAA3B,EAjCJ;KAAA;aAsCI,YAAY;AACR;AAAA;AAAA;aAAA;;;UACI,IAAG,UAAU,CAAC,MAAd;YACI,IAAG,wBAAH;cACI,IAAG,UAAU,CAAC,KAAK,CAAC,SAAjB,CAA2B,QAAQ,CAAC,IAApC,CAAH;6BACI,UAAU,CAAC,KAAK,CAAC,MAAjB,CAAwB,QAAQ,CAAC,IAAjC,GADJ;eAAA;qCAAA;eADJ;aAAA;mCAAA;aADJ;WAAA;iCAAA;;AADJ;;MADQ,CAAZ,EAOE,GAPF,EAtCJ;;EAVE,CAAN;EAyDA,UAAU,SAAC,GAAD;AACN;IAAA,SAAS,MAAM,CAAC,OAAQ;IACxB,OAAS,MAAM,CAAC;IAChB,MAAM,CAAC,MAAP,GAAgB;IAGhB,IAAG,wBAAH;AACI;AAAA;;;QACI,MAAM,CAAC,gBAAP,CAAwB,KAAxB,EAA+B,QAAQ,CAAC,IAAT,CAAc,MAAd,CAA/B;AADJ,OADJ;;IAIA,IAAG,MAAM,CAAC,UAAV;MACI,MAAM,CAAC,UAAP,GADJ;;IAGA,IAAG,YAAH;AACI;AAAA;WAAA;;;QACI,IAAG,eAAc,GAAjB;AACI,mBADJ;;QAEA,IAAG,UAAU,CAAC,IAAX,KAAmB,IAAnB,IAA4B,UAAU,CAAC,MAA1C;uBACI,IAAC,WAAD,CAAY,UAAZ,GADJ;SAAA;+BAAA;;AAHJ;qBADJ;;EAbM,CAzDV;EA6EA,YAAY,SAAC,GAAD;AACR;IAAA,SAAS,MAAM,CAAC,OAAQ;IACxB,MAAM,CAAC,MAAP,GAAgB;IAGhB,IAAG,wBAAH;AACI;AAAA;;;QACI,MAAM,CAAC,mBAAP,CAA2B,KAA3B,EAAkC,QAAlC;AADJ,OADJ;;IAIA,IAAG,MAAM,CAAC,YAAV;aACI,MAAM,CAAC,YAAP,GADJ;;EATQ,CA7EZ;;;;;AChEJ;EAAA;;;AAAA,WAAW,QAAQ,kBAAR;;AAEX,MAAM,CAAC,OAAP,GAAuB;;;;;;;4BAEnB,WAAU,QAAQ,iCAAR;;4BACV,UAAS;;4BAGT,SAAQ;AAGJ;IAAA,IAA2B,IAAC,WAAW,GAAE,CAAC,EAAf,KAAqB,MAAhD;MAAA,IAAC,WAAU,CAAC,KAAZ;;IAEA,UAAa,IAAC,WAAU,CAAC,MAAZ,KAAsB,CAAzB,GAAgC,KAAhC,GAA2C;IACrD,IAAC,IAAG,CAAC,GAAL,CAAS,SAAT,EAAoB,OAApB;IAEA,IAAC,IAAG,CAAC,KAAL;AACA;AAAA;;MACI,IAAC,IAAG,CAAC,MAAL,CAAY,IAAC,SAAD,CAAU;QAAA,OAAO,MAAP;OAAV,CAAZ;AADJ;WAEA;EAXI;;;;GANmC;;;;;ACD/C;;;;;AAAA;;AAMA,mBAAyB;;AACzB,yBAAyB;;AAEzB,MAAM,CAAC,OAAP,GAAuB;EAEN,kBAAC,IAAD;IAGT,IAAC,GAAD,GAAS;IACT,IAAC,IAAD,GAAS,QAAQ,CAAC,aAAT,CAAuB,KAAvB;IACT,IAAC,EAAD,GAAS,QAAQ,CAAC,aAAT,CAAuB,GAAvB;IACT,IAAC,MAAD,GAAS,QAAQ,CAAC,aAAT,CAAuB,KAAvB;IACT,IAAC,GAAE,CAAC,WAAJ,CAAgB,IAAC,EAAjB,CAAmB,CAAC,WAApB,CAAgC,IAAC,IAAjC;IACA,IAAC,GAAE,CAAC,WAAJ,CAAgB,IAAC,MAAjB;IAGA,IAAI,CAAC,gBAAL,CAAsB,YAAtB,EAAoC;aAAA,SAAC,KAAD;QAChC,KAAC,eAAD,GAAkB;eAClB,KAAC,aAAY,CAAC,YAAd;MAFgC;IAAA,QAApC;IAGA,IAAI,CAAC,gBAAL,CAAsB,YAAtB,EAAoC;aAAA,SAAC,KAAD;QAChC,KAAC,eAAD,GAAkB;eAClB,KAAC,aAAY,CAAC,WAAd;MAFgC;IAAA,QAApC;IAGA,IAAC,EAAC,CAAC,gBAAH,CAAoB,OAApB,EAA6B;aAAA,SAAC,KAAD;QAEzB,IAAG,KAAK,CAAC,OAAT;AACI,iBADJ;;QAGA,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,IAAnB,CAAwB,KAAC,eAAc,CAAC,KAAxC;eACA,KAAK,CAAC,cAAN;MANyB;IAAA,QAA7B;IASA,IAAC,uBAAD,GAA0B;IAC1B,IAAC,IAAG,CAAC,MAAL,GAAc;aAAA,SAAC,KAAD;AACV;QAAA,MAAM,KAAC,GAAE,CAAC,qBAAJ;QACN,IAAG,KAAC,uBAAD,KAA2B,GAAG,CAAC,MAAlC;iBACI,KAAC,uBAAD,GAA0B,GAAG,CAAC,OADlC;;MAFU;IAAA;IAOd,IAAC,eAAc,CAAC,IAAhB,CAAqB,IAArB;IAqBA,IAAC,aAAD,GAAgB,YAAY,CAAC,MAAb,CAEZ;MAAA,SAAS,SAAT;MAEA,QAAS;QAEL;UAAE,MAAK,SAAP;UAA4B,IAAG,kBAA/B;UAAoD,MAAK,cAAzD;SAFK,EAGL;UAAE,MAAK,SAAP;UAA4B,IAAG,SAA/B;UAAoD,MAAK,aAAzD;SAHK,EAKL;UAAE,MAAK,kBAAP;UAA4B,IAAG,YAA/B;UAAoD,MAAK,cAAzD;SALK,EAML;UAAE,MAAK,kBAAP;UAA4B,IAAG,SAA/B;UAAoD,MAAK,YAAzD;SANK,EAOL;UAAE,MAAK,kBAAP;UAA4B,IAAG,SAA/B;UAAoD,MAAK,aAAzD;SAPK,EAQL;UAAE,MAAK,kBAAP;UAA4B,IAAG,kBAA/B;UAAoD,MAAK,cAAzD;SARK,EAUL;UAAE,MAAK,YAAP;UAA4B,IAAG,kBAA/B;UAAoD,MAAK,aAAzD;SAVK,EAWL;UAAE,MAAK,YAAP;UAA4B,IAAG,kBAA/B;UAAoD,MAAK,YAAzD;SAXK,EAYL;UAAE,MAAK,YAAP;UAA4B,IAAG,kBAA/B;UAAoD,MAAK,eAAzD;SAZK,EAaL;UAAE,MAAK,YAAP;UAA4B,IAAG,YAA/B;UAAoD,MAAK,cAAzD;SAbK,EAcL;UAAE,MAAK,YAAP;UAA4B,IAAG,YAA/B;UAAoD,MAAK,cAAzD;SAdK,EAeL;UAAE,MAAK,YAAP;UAA4B,IAAG,YAA/B;UAAoD,MAAK,aAAzD;SAfK,EAiBL;UAAE,MAAK,kBAAP;UAA4B,IAAG,YAA/B;UAAoD,MAAK,cAAzD;SAjBK,EAkBL;UAAE,MAAK,kBAAP;UAA4B,IAAG,YAA/B;UAAoD,MAAK,cAAzD;SAlBK,EAmBL;UAAE,MAAK,kBAAP;UAA4B,IAAG,YAA/B;UAAoD,MAAK,aAAzD;SAnBK,EAoBL;UAAE,MAAK,kBAAP;UAA4B,IAAG,SAA/B;UAAoD,MAAK,cAAzD;SApBK,EAqBL;UAAE,MAAK,kBAAP;UAA4B,IAAG,kBAA/B;UAAoD,MAAK,aAAzD;SArBK;OAFT;MA8BA,WAII;QAAA,yBAAyB;iBAAA,SAAC,KAAD,EAAO,IAAP,EAAY,EAAZ;YAErB,IAAG,SAAQ,SAAX;cACI,KAAC,gBAAD;cACA,KAAC,mBAAkB,CAAC,EAAE,CAAC,aAAvB,CAAqC,YAArC,CAAkD,CAAC,KAAK,CAAC,MAAzD,GAAkE;qBAClE,KAAC,eAAc,CAAC,KAAhB,GAHJ;;UAFqB;QAAA,QAAzB;QAOA,yBAAyB;iBAAA,SAAC,KAAD,EAAO,IAAP,EAAY,EAAZ;mBAErB,KAAC,mBAAkB,CAAC,EAAE,CAAC,aAAvB,CAAqC,YAArC,CAAkD,CAAC,KAAK,CAAC,MAAzD,GAAkE;UAF7C;QAAA,QAPzB;QAWA,mBAAmB;iBAAA,SAAC,KAAD,EAAO,IAAP,EAAY,EAAZ;YAEf,IAAG,SAAQ,kBAAX;cACI,KAAC,cAAD;qBACA,KAAC,MAAD,GAFJ;aAAA,MAGK,IAAG,SAAQ,kBAAX;cACD,MAAM,CAAC,YAAP,CAAoB,KAAC,YAArB;cACA,IAAG,KAAC,mBAAD,KAAuB,KAAC,eAA3B;uBACI,KAAC,cAAD,GADJ;eAFC;;UALU;QAAA,QAXnB;QAqBA,yBAAyB;iBAAA,SAAC,KAAD,EAAO,IAAP,EAAY,EAAZ;mBAErB,KAAC,gBAAD;UAFqB;QAAA,QArBzB;QAyBA,gBAAgB;iBAAA,SAAC,KAAD,EAAO,IAAP,EAAY,EAAZ;YAEZ,IAAG,SAAQ,kBAAX;cACI,KAAC,MAAD;qBACA,KAAC,eAAc,CAAC,IAAhB,GAFJ;aAAA,MAGK,IAAG,SAAQ,kBAAX;cACD,MAAM,CAAC,YAAP,CAAoB,KAAC,YAArB;qBACA,KAAC,eAAc,CAAC,IAAhB,GAFC;;UALO;QAAA,QAzBhB;QAoCA,sBAAsB;iBAAA,SAAC,KAAD,EAAO,IAAP,EAAa,EAAb;YAElB,IAAG,KAAC,kBAAD,CAAmB,KAAC,mBAApB,CAAH;cACI,IAAG,UAAQ,EAAR,IAAQ,EAAR,KAAc,YAAd,CAAH;gBACI,KAAC,cAAD,GADJ;;AAEA,qBAAO,KAHX;aAAA;cAKI,IAAG,SAAQ,YAAX;gBACI,KAAC,aAAY,CAAC,aAAd,GADJ;;AAEA,qBAAO,MAPX;;UAFkB;QAAA,QApCtB;QA+CA,qBAAqB;iBAAA,SAAC,KAAD,EAAO,IAAP,EAAa,EAAb;YAEjB,IAAG,CAAC,KAAC,kBAAD,CAAmB,KAAC,mBAApB,CAAJ;AACI,qBAAO,MADX;;UAFiB;QAAA,QA/CrB;QAoDA,oBAAoB;iBAAA,SAAC,KAAD,EAAO,IAAP,EAAa,EAAb;YAIhB,IAAG,KAAC,eAAJ;AACI,qBAAO,MADX;aAAA;AAGI,qBAAO,KAHX;;UAJgB;QAAA,QApDpB;OAlCJ;KAFY;EAvDP;;;AAwJb;;;;qBAGA,gBAAc;AAGV;IAAA,SAAkB,IAAC;IACnB,IAAC,eAAD,GAAkB;IAClB,KAAkB,MAAM,CAAC;IACzB,cAAkB,EAAE,CAAC;IACrB,YAAkB,EAAE,CAAC,YAAY,CAAC;IAClC,eAAkB,EAAE,CAAC,YAAY,CAAC;IAClC,aAAkB,cAAc;IAChC,gBAAkB,aAAa,IAAC;IAChC,IAAG,gBAAgB,YAAnB;MACI,IAAC,GAAE,CAAC,KAAK,CAAC,GAAV,GAAkB,aAAa;MAC/B,IAAC,MAAK,CAAC,KAAK,CAAC,GAAb,GAAmB,mBAAmB,KAF1C;KAAA;MAII,IAAC,GAAE,CAAC,KAAK,CAAC,GAAV,GAAkB,CAAC,eAAe,IAAC,uBAAjB,IAA2C;MAC7D,WAAW,aAAa,YAAb,GAA4B,IAAC,uBAA7B,GAAsD;MACjE,WAAW,IAAI,CAAC,GAAL,CAAS,QAAT,EAAmB,IAAC,uBAAD,GAA0B,EAA7C;MACX,IAAC,MAAK,CAAC,KAAK,CAAC,GAAb,GAAmB,WAAW,KAPlC;;IASA,IAAC,IAAG,CAAC,GAAL,GAAW,MAAM,CAAC,KAAK,CAAC,WAAb;WACX,IAAC,EAAC,CAAC,IAAH,GAAW,MAAM,CAAC,KAAK,CAAC,gBAAb;EArBD;;qBAwBd,QAAO;IAEH,IAAC,GAAE,CAAC,KAAK,CAAC,OAAV,GAAoB;WACpB,IAAC,GAAE,CAAC,SAAS,CAAC,GAAd,CAAkB,MAAlB;EAHG;;qBAMP,QAAO;IAEH,IAAC,GAAE,CAAC,KAAK,CAAC,OAAV,GAAoB;WACpB,IAAC,GAAE,CAAC,SAAS,CAAC,MAAd,CAAqB,MAArB;EAHG;;qBAMP,kBAAiB;WACb,IAAC,YAAD,GAAe,MAAM,CAAC,UAAP,CAAkB;aAAA;eAC7B,KAAC,aAAY,CAAC,YAAd;MAD6B;IAAA,QAAlB,EAEb,GAFa;EADF;;qBAMjB,kBAAiB;WACb,IAAC,YAAD,GAAe,MAAM,CAAC,UAAP,CAAkB;aAAA;eAC7B,KAAC,aAAY,CAAC,YAAd;MAD6B;IAAA,QAAlB,EAEb,GAFa;EADF;;;AAKjB;;;;;;;;qBAOA,oBAAmB,SAAC,UAAD;AACf;IAAA,IAAG,iFAAH;AACI,aAAO,KADX;KAAA;AAGI,aAAO,MAHX;;EADe;;qBAOnB,cAAa,SAAC,UAAD;IAET,IAAC,mBAAD,GACI;MAAA,IAAQ,UAAU,CAAC,EAAnB;MACA,OAAQ,UAAU,CAAC,KADnB;;WAEJ,IAAC,aAAY,CAAC,YAAd;EALS;;qBAQb,aAAY,SAAC,UAAD;IAER,IAAG,IAAC,aAAY,CAAC,OAAd,KAAyB,kBAA5B;aACI,IAAC,aAAY,CAAC,WAAd,GADJ;;EAFQ;;qBAOZ,iBAEI;IAAA,MAAM,SAAC,cAAD;AAEF;MAAA,IAAC,eAAD,GAAkB;MAClB,IAAC,cAAD,GAAiB,cAAc,CAAC,EAAE,CAAC;MACnC,IAAC,oBAAD;MAGA,wBAAwB,CAAC,CAAC,QAAF,CAAW;eAAA;iBAC/B,KAAC,oBAAD;QAD+B;MAAA,QAAX,EAEtB,IAFsB;MAGxB,MAAM,CAAC,gBAAP,CAAwB,QAAxB,EAAkC,qBAAlC,EAAyD,KAAzD;aAIA,IAAC,WAAD,GAAc;eAAA,SAAC,EAAD;AAEV;UAAA,UAAU,KAAI,CAAC,QAAL,GAAgB,EAAE,CAAC;UAC7B,UAAU,WAAY,EAAE,CAAC,KAAH,GAAW,KAAI,CAAC;UACtC,IAAG,KAAI,CAAC,OAAL,KAAgB,OAAnB;YACI,IAAG,OAAH;cACI,KAAI,CAAC,cAAc,CAAC,YAAY,CAAC,WAAjC,GADJ;aAAA;cAGI,KAAI,CAAC,cAAc,CAAC,YAAY,CAAC,UAAjC,GAHJ;;mBAIA,KAAI,CAAC,OAAL,GAAe,QALnB;;QAJU;MAAA;IAdZ,CAAN;IAyBA,qBAAqB;AACjB;MAAA,QAAQ,IAAC,cAAa,CAAC,aAAf,CAA6B,YAA7B;MACR,IAAG,UAAS,IAAZ;AACI,eADJ;;MAEA,aAAa,KAAK,CAAC,qBAAN;MACb,IAAI,CAAC,QAAL,GAAiB,UAAU,CAAC,IAAX,GAAkB;MACnC,IAAI,CAAC,SAAL,GAAiB,IAAI,CAAC,QAAL,GAAgB,UAAU,CAAC,KAA3B,GAAmC;MACpD,iBAAiB,IAAC,cAAa,CAAC,aAAf,CAA6B,kBAA7B;aACjB,IAAC,eAAc,CAAC,EAAE,CAAC,KAAK,CAAC,IAAzB,GAAkC,CAAC,cAAc,CAAC,UAAf,GAA4B,EAA7B,IAAmC;IARpD,CAzBrB;IAmCA,OAAO;MACH,IAAC,cAAa,CAAC,gBAAf,CAAgC,WAAhC,EAA6C,IAAC,WAA9C,EAA0D,KAA1D;aACA,IAAC,QAAD,GAAW;IAFR,CAnCP;IAuCA,MAAO;aACH,IAAC,cAAa,CAAC,mBAAf,CAAmC,WAAnC,EAAgD,IAAC,WAAjD,EAA6D,KAA7D;IADG,CAvCP;;;;;;;;;ACrPR;EAAA;;;;AAAA,WAAiB,QAAQ,kBAAR;;AACjB,YAAiB,QAAQ,SAAR;;AACjB,iBAAiB;;AACjB,WAAiB,QAAQ,iBAAR;;AACjB,cAAiB,QAAQ,wBAAR;;AACjB,SAAiB,QAAQ,eAAR;;AAEjB,MAAM,CAAC,OAAP,GAAuB;;;;;;;;;qBAEnB,WAAe,QAAQ,kBAAR;;qBACf,eAAe,QAAQ,uBAAR;;qBAEf,gBAAe;WACX,CAAC,CAAC,MAAF,CAAS,2CAAT,EACI;MAAA,aAAoB,IAAC,MAAK,CAAC,WAAP,EAApB;MACA,mBAAoB,IAAC,MAAK,CAAC,iBAAP,EADpB;MAEA,UAAoB,IAAC,MAAK,CAAC,QAAP,EAFpB;MAGA,eAAoB,IAAC,MAAK,CAAC,gBAAP,EAHpB;MAIA,aAAoB,IAAC,MAAK,CAAC,cAAP,EAJpB;MAKA,WAAoB,IAAC,MAAK,CAAC,YAAP,EALpB;MAMA,gBAAoB,IAAC,MAAK,CAAC,cAAP,EANpB;KADJ;EADW;;qBAWf,aAAY,SAAC,OAAD;IACR,IAAC,aAAD,GAAgB,OAAO,CAAC;IACxB,IAAC,YAAD,GAAgB,OAAO,CAAC;IAGxB,KAAO,GAAG,CAAC,QAAX;sCACI,kCAAkB,QAAQ,eAAR,EADtB;;EALQ;;qBASZ,eAAc;AAGV;IAAA,IAAG,IAAC,MAAK,CAAC,QAAP,EAAH;MACI,OAAO,IAAC,MAAK,CAAC,aAAP;MACP,oBAAoB,IAAC,YAAW,CAAC,6BAAb,CAA2C,IAA3C;aACpB,IAAC,qBAAD,GAAwB,oBAAoB,EAHhD;KAAA;aAKI,IAAC,qBAAD,GAAwB,MAL5B;;EAHU;;qBAWd,cAAa;IACT,IAAC,GAAE,CAAC,WAAJ,GAAkB;IAClB,IAAC,SAAD,GAAe,IAAC,EAAD,CAAG,aAAH;IACf,IAAC,YAAD,GAAe,IAAC,EAAD,CAAG,gBAAH;IACf,IAAC,YAAD,GAAe,IAAC,YAAW,CAAC,IAAb,CAAkB,YAAlB;IACf,IAAC,MAAD,GAAe,CAAC,IAAC,YAAW,CAAC,IAAb,CAAkB,WAAlB,CAAD,CAAgC;IAC/C,IAAC,YAAD,GAAe,IAAC,EAAD,CAAG,mBAAH;IACf,IAAC,YAAD,GAAe,IAAC,EAAD,CAAG,mBAAH;IACf,IAAC,4BAAD,GAA+B,IAAC,EAAD,CAAG,mBAAH;IAC/B,IAAC,YAAD,GAAe,IAAC,EAAD,CAAG,YAAH;IAEf,IAAC,IAAG,CAAC,IAAL,CAAU,KAAV,EAAiB,IAAC,MAAK,CAAC,GAAxB;IACA,IAAC,IAAG,CAAC,QAAL,CAAc,SAAd;IAIA,IAAG,IAAC,aAAJ;MACI,IAAC,SAAQ,CAAC,IAAV,GADJ;;IAIA,IAAC,KAAD,GAAY,aACR;MAAA,IAAO,IAAC,EAAD,CAAG,OAAH,CAAP;KADQ;IAOZ,IAAoB,IAAC,MAAK,CAAC,KAAP,EAApB;MAAA,IAAC,cAAD;;IACA,IAAoB,IAAC,qBAArB;MAAA,IAAC,YAAD;;WACA,IAAC,WAAD;EA7BS;;qBAgCb,aAAY;AAKR;IAAA,IAAG,IAAC,GAAE,CAAC,WAAJ,KAAmB,MAAtB;MACI,IAAC,OAAD;AACA,aAFJ;;IAIA,IAAC,aAAD;IAGA,aAAa,IAAC,cAAD;IACb,IAAG,IAAC,MAAK,CAAC,QAAP,EAAH;MACI,OAAO,cAAY,UAAU,CAAC,KAAK,CAAC;MACpC,OAAO;MACP,OAAO,SAHX;KAAA;MAKI,IAAG,IAAC,MAAK,CAAC,OAAP,EAAH;QACI,OAAO,UAAU,CAAC,cADtB;OAAA;QAGI,OAAO,UAAU,CAAC,YAHtB;;MAIA,OAAO,UAAU,CAAC,KAAK,CAAC,IAAjB,IAAyB;MAChC,OAAO,SAAS,IAAT,EAAe;QAAA,MAAM,CAAN;OAAf;MACP,OAAO,UAAU,CAAC,KAAK,CAAC,OAAD,EAX3B;;IAcA,IAAG,IAAC,aAAJ;MACI,IAAC,SAAQ,CAAC,IAAV,CAAe,IAAC,MAAK,CAAC,UAAU,CAAC,IAAjC,EADJ;;IAaA,WAAW,IAAC,MAAK,CAAC,WAAP;IACX,IAAC,YAAW,CAAC,IAAb,CAAkB,OAAlB,EAA2B,eAAa,QAAxC;IAGA,IAAG,aAAY,YAAf;MACI,IAAC,MAAK,CAAC,GAAP,GAAa,IAAC,MAAK,CAAC,WAAP,GADjB;;IAIA,IAAG,IAAC,MAAK,CAAC,QAAP,EAAH;MACI,IAAC,YAAW,CAAC,QAAb,CAAsB,QAAtB,EADJ;KAAA;MAGI,IAAC,YAAW,CAAC,WAAb,CAAyB,QAAzB,EAHJ;;IAMA,IAAC,YAAW,CAAC,IAAb,CAAkB,MAAlB,EAA0B,IAA1B;IAGA,IAAC,KAAI,CAAC,OAAN,CAAc,IAAC,MAAf;IAGA,IAAC,YAAW,CAAC,IAAb,CAAkB,UAAU,CAAC,KAAK,CAAC,IAAnC;IACA,IAAC,YAAW,CAAC,IAAb,CAAkB,IAAlB;IACA,IAAC,YAAW,CAAC,IAAb,CAAkB,EAAE,IAAF,CAAlB;IAGA,mBAAmB,UAAU,CAAC,KAAK,CAAC;IACpC,IAAG,gBAAH;MACI,IAAI,OAAO,gBAAP;MACJ,mBAAmB,CAAC,CAAC,QAAF;MACnB,uBAAuB,CAAC,CAAC,MAAF,CAAS,KAAT,EAH3B;KAAA;MAKI,mBAAmB;MACnB,uBAAuB,GAN3B;;IAOA,IAAC,4BAA2B,CAAC,IAA7B,CAAkC,gBAAlC;IACA,IAAC,4BAA2B,CAAC,IAA7B,CAAkC,OAAlC,EAA2C,oBAA3C;IAGA,IAAC,IAAG,CAAC,IAAL,CAAU,KAAV,EAAiB,IAAC,MAAK,CAAC,GAAxB;IAEA,IAAG,IAAC,MAAK,CAAC,WAAP,MAAwB,IAAC,MAAK,CAAC,iBAAP,EAA3B;MACI,IAAC,eAAD;MACA,IAAC,kBAAD;MACA,IAAC,cAAD,GAHJ;KAAA;MAKI,IAAwB,wBAAxB;QAAA,IAAC,kBAAD;;MACA,IAAC,IAAG,CAAC,WAAL,CAAiB,QAAjB,EAA2B,IAAC,MAAK,CAAC,QAAP,EAA3B,EANJ;;IAaA,IAAG,IAAC,MAAK,CAAC,KAAP,EAAH;MACI,IAAC,cAAD,GADJ;;IAIA,IAAC,YAAD;IACA,IAAkB,IAAC,qBAAnB;aAAA,IAAC,YAAD;;EAjGQ;;qBAoGZ,mBAAkB;IACd,IAAG,IAAC,MAAK,CAAC,QAAP,EAAH;MACI,IAAC,qBAAD,GAAwB;aACxB,IAAC,YAAD,GAFJ;;EADc;;qBAMlB,sBAAqB;AACjB;IAAA,IAAG,IAAC,MAAK,CAAC,QAAP,EAAH;MACI,OAAO,IAAC,MAAK,CAAC,aAAP;MAEP,WAAW,IAAC,YAAW,CAAC,6BAAb,CAA2C,IAA3C,IAAmD;MAC9D,IAAG,YAAa,CAAI,IAAC,EAAD,CAAG,aAAH,CAAiB,CAAC,EAAlB,CAAqB,UAArB,CAApB;eACI,IAAC,YAAD,GADJ;OAAA,MAEK,IAAG,CAAI,QAAJ,IAAiB,IAAC,EAAD,CAAG,aAAH,CAAiB,CAAC,EAAlB,CAAqB,UAArB,CAApB;eACD,IAAC,YAAD,GADC;OANT;;EADiB;;qBAWrB,cAAa;IAIT,IAAG,IAAC,MAAK,CAAC,UAAP,MAAuB,CAAC,IAAC,MAAK,CAAC,QAAP,MAAsB,CAAI,IAAC,UAA5B,CAA1B;aACI,IAAC,OAAD,GADJ;;EAJS;;qBAQb,UAAS;AACL;IAAA,UAAU,MAAM,CAAC,IAAP,CAAY,IAAC,MAAK,CAAC,OAAnB;IAEV,IAAG,OAAO,CAAC,MAAR,KAAkB,CAArB;MACI,IAAG,OAAQ,GAAR,KAAc,MAAjB;AACI,eADJ;OADJ;;WAKA,IAAC,OAAD;EARK;;qBAWT,eAAc,SAAC,OAAD;AAEV;IAAA,eAAgB,IAAC,EAAD,CAAG,mBAAH;;MAChB,IAAC,cAAc,EAAE,sBAAF,CAAyB,CAAC,WAA1B,CAAsC,YAAtC;;IAEf,IAAG,YAAa,KAAhB;MACI,IAAC,WAAU,CAAC,IAAZ,CAAiB,OAAjB;MACA,IAAC,WAAU,CAAC,IAAZ;aACA,IAAC,UAAD,GAAa,KAHjB;KAAA;MAKI,IAAC,WAAU,CAAC,IAAZ;aACA,IAAC,UAAD,GAAa,MANjB;;EALU;;qBAcd,eAAc;WACV,IAAC,KAAI,CAAC,SAAN;EADU;;qBAId,kBAAiB;WACT,cAAU,EAAE,oBAAF,CAAV,EAAmC,EAAE,kBAAF,CAAnC,EAA0D,EAAE,iBAAF,CAA1D,EAAgF,EAAE,cAAF,CAAhF,EAAmG;aAAA,SAAC,OAAD;QACnG,IAAG,OAAH;UACI,MAAM,CAAC,iBAAiB,CAAC,QAAzB;iBACA,KAAC,MAAK,CAAC,OAAP,CACI;YAAA,SAAS;qBAAG,MAAM,CAAC,iBAAiB,CAAC,QAAzB;YAAH,CAAT;YACA,OAAO;cACH,MAAM,CAAC,iBAAiB,CAAC,QAAzB;qBACA,SAAS,CAAC,KAAV,CAAgB,EAAE,oBAAF,CAAhB;YAFG,CADP;WADJ,EAFJ;;MADmG;IAAA,QAAnG;EADS;;;AAUjB;;;;qBAGA,gBAAe,SAAC,IAAD;AACX;IAAA,IAAC,GAAE,CAAC,WAAJ,GAAkB;IAClB,IAAC,IAAG,CAAC,QAAL,CAAc,WAAd;IACA,QAAQ,IAAC,EAAD,CAAG,UAAH,CAAc,CAAC,KAAf,KAAyB;IACjC,QAAQ,IAAC,MAAK,CAAC,MAAP;IACR,IAA8B,sBAA9B;MAAA,KAAK,CAAC,OAAD,CAAL,GAAc,SAAd;;IAEA,IAAG,OAAO,IAAP,KAAgB,QAAnB;MACI,KAAK,CAAC,IAAN,GAAa,KADjB;;IAIA,YAAY,IAAC,MAAK,CAAC,YAAP;IACZ,YAAY;IACZ,IAAG,cAAa,QAAb,IAAyB,CAAC,aAAa,SAAS,CAAC,MAAV,GAAmB,CAAjC,CAA5B;MACI,aAAa,UADjB;;IAEA,WAAW,IAAC,MAAK,CAAC,WAAP;IACX,aAAa,MAAM;IACnB,IAAG,aAAY,YAAf;MACI,WAAW,IAAC,MAAK,CAAC,WAAP,GADf;KAAA;MAGI,WAAW,GAHf;;IAKA,IAAC,IAAG,CAAC,IAAL,CAAU,IAAC,aAAD,CACN;MAAA,OAAY,KAAZ;MACA,WAAY,SADZ;MAEA,UAAY,QAFZ;MAGA,WAAY,SAHZ;KADM,CAAV;IAOA,SAAS,IAAC,EAAD,CAAG,iBAAH;IACT,QAAS,MAAO;IAChB,IAAG,SAAQ,EAAX;MACI,KAAK,CAAC,WAAN,GAAoB,EAAE,YAAF,EADxB;;IAEA,MAAM,CAAC,KAAP,CAAa,KAAb;IACA,MAAM,CAAC,KAAP;IACA,MAAM,CAAC,QAAP,CAAgB;aAAA;eACZ,KAAC,cAAD;MADY;IAAA,QAAhB;WAOA,WAAW;AACP;MAAA,iBAAiB,KAAK,CAAC,IAAI,CAAC,WAAX,CAAuB,GAAvB;MACjB,IAAsC,mBAAkB,CAAC,CAAzD;QAAA,iBAAiB,KAAK,CAAC,IAAI,CAAC,OAA5B;;MAEA,IAAG,OAAO,KAAK,CAAC,cAAb,KAAiC,WAApC;QACI,KAAK,CAAC,cAAN,GAAuB;eACvB,KAAK,CAAC,YAAN,GAAqB,eAFzB;OAAA,MAGK,IAAG,QAAQ,CAAC,SAAT,IAAuB,QAAQ,CAAC,SAAS,CAAC,WAA7C;QAED,KAAK,CAAC,MAAN;QACA,QAAQ,QAAQ,CAAC,SAAS,CAAC,WAAnB;QACR,KAAK,CAAC,QAAN,CAAe,IAAf;QACA,KAAK,CAAC,SAAN,CAAgB,WAAhB,EAA6B,CAA7B;QACA,KAAK,CAAC,OAAN,CAAc,WAAd,EAA2B,cAA3B;eACA,KAAK,CAAC,MAAN,GAPC;;IAPE,CAAX;EA1CW;;qBA4Df,iBAAgB;WACR,mBAAe;MAAA,OAAO,IAAC,MAAR;KAAf;EADQ;;qBAIhB,gBAAe;AACX;IAAA,OAAO,IAAC,EAAD,CAAG,iBAAH,CAAqB,CAAC,GAAtB;IAGP,sBAAO,IAAI,CAAE,IAAN;IAGP,IAAG,QAAS,SAAQ,IAAC,MAAK,CAAC,GAAP,CAAW,MAAX,CAApB;aACI,IAAC,gBAAD,GADJ;KAAA,MAIK,IAAG,QAAS,SAAU,EAAtB;MACD,IAAC,IAAG,CAAC,WAAL,CAAiB,WAAjB;MAGA,IAAC,YAAD;MAGA,IAAC,aAAD,CAAc,KAAd;MAGA,IAAC,iBAAD;MAGA,IAAC,EAAD,CAAG,OAAH,CAAW,CAAC,QAAZ,CAAqB,UAArB;MAOA,UAAU;QAAA,4BAA4B,IAA5B;;MACV,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,KAAlB,CAAwB,IAAC,MAAzB,EAAgC,IAAhC,EAAsC,OAAtC;aAEA,IAAC,MAAK,CAAC,IAAP,CAAY;QAAA,MAAM,IAAN;OAAZ,EACI;QAAA,MAAM,IAAN;QACA,SAAS;iBAAA,SAAC,IAAD;YAGL,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,MAAlB,CAAyB,KAAC,MAA1B,EAAiC,IAAjC,EAAuC,OAAvC;YAGA,KAAC,YAAD;YAGA,KAAC,eAAD;mBAIA,KAAC,OAAD;UAbK;QAAA,QADT;QAgBA,OAAO;iBAAA,SAAC,KAAD,EAAQ,GAAR;AAGH;YAAA,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,MAAlB,CAAyB,KAAC,MAA1B,EAAiC,IAAjC,EAAuC,OAAvC;YAGA,KAAC,YAAD;YAGA,KAAC,EAAD,CAAG,OAAH,CAAW,CAAC,WAAZ,CAAwB,UAAxB;YACA,KAAC,eAAD;YAIA,KAAC,EAAD,CAAG,iBAAH,CAAqB,CAAC,KAAtB;YAIA,IAAG,GAAG,CAAC,MAAJ,KAAc,GAAjB;cACI,UAAU,EAAE,oBAAF,EADd;aAAA;cAGI,UAAU,EAAE,oBAAF,EAHd;;mBAKA,KAAC,aAAD,CAAc,OAAd;UAvBG;QAAA,QAhBP;OADJ,EAvBC;KAAA;aAmED,IAAC,aAAD,CAAc,EAAE,wBAAF,CAAd,EAnEC;;EAXM;;qBAiFf,kBAAiB;IACb,IAAC,IAAG,CAAC,WAAL,CAAiB,WAAjB;IAGA,IAAG,IAAC,MAAK,CAAC,KAAP,EAAH;aACI,IAAC,MAAK,CAAC,OAAP,GADJ;KAAA;aAKI,IAAC,OAAD,GALJ;;EAJa;;qBAcjB,wBAAuB;WACnB,IAAC,YAAW,CAAC,KAAb,CAAmB,IAAC,MAApB;EADmB;;qBAKvB,oBAAmB,SAAC,CAAD;AAGf;IAAA,qDAAyB,CAAE,MAAxB,CAA+B,CAA/B,EAAiC,CAAjC,gBAAqC,OAAxC;MAEI,IAAG,CAAC,CAAC,OAAL;AACI,eADJ;;MAEA,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,IAAnB,CAAwB,IAAC,MAAzB;aACA,CAAC,CAAC,cAAF,GALJ;;EAHe;;qBAanB,gBAAe,SAAC,KAAD;AAGX;IAAA,qBAAqB,CACjB,aADiB,EAEjB,OAFiB,EAGjB,eAHiB,EAIjB,kBAJiB,EAKjB,oBALiB,EAMjB,YANiB,EAOjB,mBAPiB;IAUrB,IAAG,IAAC,IAAG,CAAC,QAAL,CAAc,WAAd,CAAH;AACI,aADJ;;IAGA,IAAI,KAAK,CAAC;AACV;;MACI,IAAG,EAAE,CAAF,CAAI,CAAC,OAAL,CAAa,GAAb,CAAiB,CAAC,MAAlB,KAA4B,CAA5B,IAAiC,CAAC,CAAC,OAAF,CAAU,GAAV,CAApC;AACI,eADJ;;AADJ;IAIA,iBAAiB,KAAK,CAAC,QAAN,IAAkB;IACnC,MAAM,CAAC,YAAP,EAAqB,CAAC,eAAtB;WACA,IAAC,MAAK,CAAC,kBAAP,CAA0B,cAA1B;EAvBW;;;AA0Bf;;;;qBAGA,aAAY,SAAC,CAAD;AAER;IAAA,IAAG,CAAC,CAAC,OAAF,KAAa,EAAhB;aACI,IAAC,cAAD,GADJ;KAAA,MAGK,IAAG,CAAC,CAAC,OAAF,KAAa,EAAhB;aACD,IAAC,gBAAD,GADC;KAAA,MAGA,IAAG,CAAC,CAAC,OAAF,KAAa,EAAhB;MACD,OAAO,IAAI,CAAC,GAAG,CAAC,IAAT;MACP,IAAG,IAAI,CAAC,MAAL,KAAe,CAAlB;AACI,eADJ;;MAEA,IAAC,cAAD;aACA,IAAI,CAAC,IAAL,CAAU,aAAV,CAAwB,CAAC,KAAzB,GALC;KAAA,MAOA,IAAG,CAAC,CAAC,OAAF,KAAa,EAAhB;MACD,OAAO,IAAI,CAAC,GAAG,CAAC,IAAT;MACP,IAAG,IAAI,CAAC,MAAL,KAAe,CAAlB;AACI,eADJ;;MAEA,IAAC,cAAD;aACA,IAAI,CAAC,IAAL,CAAU,aAAV,CAAwB,CAAC,KAAzB,GALC;;EAfG;;qBAuBZ,kBAAiB,SAAC,KAAD;AACb;IAAA,iBAAiB,KAAK,CAAC,QAAN,IAAkB;WACnC,IAAC,MAAK,CAAC,kBAAP,CAA0B,cAA1B;EAFa;;qBAKjB,iBAAgB;AACZ;IAAA,iBAAiB,IAAC,MAAK,CAAC,cAAP;IACjB,IAAC,IAAG,CAAC,WAAL,CAAiB,UAAjB,EAA6B,cAA7B;IAEA,IAAG,cAAH;MACI,IAAC,EAAD,CAAG,qBAAH,CAAyB,CAAC,WAA1B,CAAsC,aAAtC;aACA,IAAC,EAAD,CAAG,qBAAH,CAAyB,CAAC,QAA1B,CAAmC,mBAAnC,EAFJ;KAAA;MAII,IAAC,EAAD,CAAG,qBAAH,CAAyB,CAAC,WAA1B,CAAsC,mBAAtC;aACA,IAAC,EAAD,CAAG,qBAAH,CAAyB,CAAC,QAA1B,CAAmC,aAAnC,EALJ;;EAJY;;qBAahB,iBAAgB;IACZ,OAAO,CAAC,GAAR,CAAY,gBAAZ,EAA8B,IAAC,YAA/B;IAEA,IAAwB,wBAAxB;MAAA,IAAC,kBAAD;;IACA,IAAC,IAAG,CAAC,QAAL,CAAc,WAAd;IACA,IAAC,EAAD,CAAG,mBAAH,CAAuB,CAAC,IAAxB;IACA,IAAC,EAAD,CAAG,mBAAH,CAAuB,CAAC,IAAxB;IAEA,IAAC,YAAD,GAAmB,gBAAY;MAAA,OAAO,IAAC,MAAR;KAAZ;IACnB,IAAC,KAAD,GAAQ,EAAE,gEAAF;IACR,IAAC,KAAI,CAAC,MAAN,CAAa,IAAC,YAAW,CAAC,MAAb,EAAqB,CAAC,GAAnC;WACA,IAAC,EAAD,CAAG,mBAAH,CAAuB,CAAC,KAAxB,CAA8B,IAAC,KAA/B;EAXY;;qBAehB,oBAAmB;IACf,OAAO,CAAC,GAAR,CAAY,mBAAZ,EAAiC,IAAC,YAAlC;IACA,IAAC,EAAD,CAAG,mBAAH,CAAuB,CAAC,IAAxB;IACA,IAAC,EAAD,CAAG,mBAAH,CAAuB,CAAC,IAAxB;IACA,IAAC,IAAG,CAAC,WAAL,CAAiB,WAAjB;IACA,IAAG,wBAAH;MACI,IAAC,YAAW,CAAC,OAAb;MACA,IAAC,YAAD,GAAe;MACf,OAAO,CAAC,GAAR,CAAa,YAAb,EAA2B,IAAC,YAA5B,EAHJ;;WAIA,IAAC,KAAI,CAAC,MAAN;EATe;;qBAanB,oBAAmB;WACf,IAAC,EAAD,CAAG,eAAH,CAAmB,CAAC,KAApB,CAA0B,SAAC,KAAD;aAAW,KAAK,CAAC,cAAN;IAAX,CAA1B;EADe;;qBAKnB,gBAAe;WACX,IAAC,EAAD,CAAG,mBAAH,CAAuB,CAAC,KAAxB,CAA8B,SAAC,KAAD;aAAW,KAAK,CAAC,cAAN;IAAX,CAA9B;EADW;;qBAKf,cAAa;IACT,IAAC,EAAD,CAAG,mBAAH,CAAuB,CAAC,QAAxB,CAAiC,QAAjC;WACA,IAAC,EAAD,CAAG,aAAH,CAAiB,CAAC,GAAlB,CAAsB,SAAtB,EAAiC,cAAjC;EAFS;;qBAMb,cAAa;IACT,IAAC,EAAD,CAAG,mBAAH,CAAuB,CAAC,WAAxB,CAAoC,QAApC;WACA,IAAC,EAAD,CAAG,aAAH,CAAiB,CAAC,IAAlB;EAFS;;;;GA9gBuB;;;;ACNxC;EAAA;;;AAAA,WAAW,QAAQ,kBAAR;;AACX,WAAW,QAAQ,aAAR;;AACX,WAAW,QAAQ,uBAAR;;AACX,WAAW,QAAQ,aAAR;;AAEX,MAAM,CAAC,OAAP,GAAuB;;;;;;;sBACnB,WAAU,QAAQ,mBAAR;;sBACV,KAAI;;sBAEJ,WAAU;;sBACV,eAAc;;sBAEd,SACI;IAAA,kBAAiC,eAAjC;IACA,oBAAiC,eADjC;IAEA,mBAAiC,eAFjC;IAGA,qBAAiC,eAHjC;IAIA,kBAAiC,eAJjC;IAKA,oBAAiC,eALjC;IAMA,8BAAiC,eANjC;IAOA,gCAAiC,eAPjC;IAUA,wBAAsC,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,mBAAX,EAAoC,CAApC;IAAP,CAVtC;IAWA,qBAAsC,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,cAAX,EAAoC,CAApC;IAAP,CAXtC;IAYA,uBAAsC,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,iBAAX,EAAoC,CAApC;IAAP,CAZtC;IAaA,sBAAsC,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,gBAAX,EAAoC,CAApC;IAAP,CAbtC;IAcA,qBAAsC,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,eAAX,EAAoC,CAApC;IAAP,CAdtC;IAeA,0BAAsC,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,eAAX,EAAoC,CAApC;IAAP,CAftC;IAgBA,4BAAsC,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,iBAAX,EAAoC,CAApC;IAAP,CAhBtC;IAiBA,qBAAsC,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,eAAX,EAAoC,CAApC;IAAP,CAjBtC;IAkBA,yBAAsC,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,iBAAX,EAAoC,CAApC;IAAP,CAlBtC;IAmBA,gCAAsC,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,YAAX,EAAoC,CAApC;IAAP,CAnBtC;IAoBA,oBAAsC,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,eAAX,EAAoC,CAApC;IAAP,CApBtC;IAqBA,gCAAsC,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,uBAAX,EAAoC,CAApC;IAAP,CArBtC;IAsBA,qCAAsC,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,iBAAX,EAAoC,CAApC;IAAP,CAtBtC;IAuBA,yBAAyB,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,gBAAX,EAAoC,CAApC;IAAP,CAvBzB;IAwBA,yBAAyB,SAAC,CAAD;aAAO,IAAC,UAAD,CAAW,eAAX,EAAoC,CAApC;IAAP,CAxBzB;;;sBA0BJ,aAAY,SAAC,OAAD;IACR,0CAAM,OAAN;IAEA,IAAC,gBAAD,GAAmB;aACf;QAAA,cAAc,OAAO,CAAC,YAAtB;QACA,aAAa,OAAO,CAAC,WADrB;;IADe;IAInB,IAAC,oBAAD,GAAuB,OAAO,CAAC;IAE/B,IAAC,QAAD,GAAW;MAAA,OAAO,IAAC,WAAU,CAAC,KAAnB;MAA0B,MAAM,IAAC,WAAU,CAAC,IAA5C;;IAEX,IAAC,SAAD,CAAU,IAAC,WAAX,EAAuB,KAAvB,EAA8B,IAAC,QAA/B;IACA,IAAC,SAAD,CAAU,IAAC,WAAX,EAAuB,QAAvB,EAAiC,IAAC,WAAlC;IACA,IAAC,SAAD,CAAU,IAAC,WAAX,EAAuB,MAAvB,EAA+B,IAAC,OAAhC;IAGA,IAAC,SAAD,CAAU,IAAC,WAAX,EAAuB,QAAvB,EAAiC,CAAC,CAAC,OAAF,CAAU,IAAC,UAAX,EAAsB,SAAtB,CAAjC;IACA,IAAC,SAAD,CAAU,IAAC,WAAX,EAAuB,YAAvB,EAAqC,CAAC,CAAC,OAAF,CAAU,IAAC,UAAX,EAAsB,aAAtB,CAArC;IACA,IAAC,SAAD,CAAU,IAAC,WAAX,EAAuB,eAAvB,EAAwC,CAAC,CAAC,OAAF,CAAU,IAAC,UAAX,EAAsB,gBAAtB,CAAxC;IACA,IAAC,SAAD,CAAU,IAAC,WAAX,EAAuB,kBAAvB,EAA4C,CAAC,CAAC,OAAF,CAAU,IAAC,UAAX,EAAsB,qBAAtB,CAA5C;WACA,IAAC,SAAD,CAAU,IAAC,WAAX,EAAuB,iBAAvB,EAA2C,CAAC,CAAC,OAAF,CAAU,IAAC,UAAX,EAAsB,kBAAtB,CAA3C;EApBQ;;sBAwBZ,UAAS,SAAC,KAAD,EAAQ,UAAR,EAAoB,OAApB;IACL,IAAC,SAAQ,CAAC,MAAV,CAAiB,UAAU,CAAC,OAAX,CAAmB,KAAnB,CAAjB;WACA,IAAC,cAAD;EAFK;;sBAKT,aAAY,SAAC,KAAD,EAAQ,UAAR,EAAoB,OAApB;IACR,IAAC,SAAQ,CAAC,SAAV,CAAoB,OAAO,CAAC,KAA5B;WACA,IAAC,cAAD;EAFQ;;sBAKZ,gBAAe;WACX,CAAC,CAAC,MAAF,CAAS,4CAAT,EACI;MAAA,qBAAqB,IAAC,oBAAtB;MACA,aAAa,IAAC,WAAU,CAAC,IAAZ,EADb;KADJ;EADW;;sBAMf,eAAc;IACV;WACA,IAAC,WAAD,GAAc,WAAW,CAAC,GAAZ;EAFJ;;sBAKd,cAAa;AACT;IAAA;IACA,IAAC,eAAD,CAAgB,IAAC,QAAO,CAAC,KAAzB,EAAgC,IAAC,QAAO,CAAC,IAAzC;IACA,IAAC,cAAD;IAGA,IAAC,KAAD,GAAQ;IAGR,UAEI;MAAA,iBAAkB,IAAlB;MAGA,YAAkB,EAHlB;MAOA,aAAgB,CAPhB;MAaA,gBAAkB,CAblB;MAgBA,UAAkB,EAhBlB;MAoBA,WAAkB,GApBlB;MAwBA,eAAkB,IAAC,YAAW,CAAC,IAAb,CAAkB,IAAlB,CAxBlB;;IA2BJ,kBAAkB,IAAC,EAAD,CAAG,IAAC,aAAJ,CAAkB;IAGpC,IAAC,SAAD,GAAgB,aAAS,eAAT,EAA0B,OAA1B;IAChB,IAAC,SAAQ,CAAC,QAAV,CAAmB,IAAC,WAAU,CAAC,MAA/B;WAGA,IAAI,CAAC,aAAL,GAAyB,aAAS,IAAC,EAAD,CAAG,YAAH,CAAiB,GAA1B;EA7ChB;;sBAiDb,cAAa,SAAC,cAAD;AAET;AAAA;;MACI,IAAG,GAAG,CAAC,EAAP;QACI,OAAO,GAAG,CAAC;QACX,IAAG,mBAAH;UACI,QAAQ,IAAC,WAAU,CAAC,EAAZ,CAAe,IAAf;UACR,IAAG,KAAH;YACI,KAAK,CAAC,IAAN,GAAa;YACb,OAAO,GAAG,CAAC,EAAE,CAAC;YACd,IAAI,CAAC,KAAL,GAAa;YACb,IAAI,CAAC,UAAL,GAJJ;WAFJ;SAAA;UASI,QAAQ,IAAC,WAAU,CAAC,EAAZ,CAAe,IAAf;UACR,KAAK,CAAC,IAAN,GAAa;UACb,UAAU,CAAC,CAAC,MAAF,CAAS,EAAT,EAAa;YAAC,YAAD;WAAb,EAAsB,IAAC,gBAAD,EAAtB;UACV,OAAW,aAAS,OAAT;UACX,IAAI,CAAC,UAAL,CAAgB,GAAG,CAAC,EAApB;UACA,IAAI,CAAC,MAAL;UAEA,GAAG,CAAC,EAAE,CAAC,IAAP,GAAc;UACd,IAAC,KAAI,CAAC,IAAN,CAAW,IAAX,EAjBJ;SAFJ;;AADJ;AAsBA,WAAO;EAxBE;;sBAgCb,YAAW,SAAC,UAAD,EAAa,MAAb;AAIP;IAAA,IAAG,kBAAH;MACI,MAAM,MAAM,CAAC,IADjB;KAAA;MAGI,MAAM,IAAC,EAAD,CAAG,MAAM,CAAC,MAAV,CAAiB,CAAC,OAAlB,CAA0B,IAA1B,CAA+B,CAAC,IAAhC,CAAqC,KAArC;MAEN,IAAO,WAAP;QACI,MAAM,IAAC,EAAD,CAAG,MAAM,CAAC,aAAV,CAAwB,CAAC,IAAzB,CAA8B,KAA9B,EADV;OALJ;;IASA,OAAO,CAAC,CAAC,IAAF,CAAO,IAAC,KAAR,EAAc,SAAC,IAAD;aAAU,IAAI,CAAC,KAAK,CAAC,GAAX,KAAkB;IAA5B,CAAd;IAIP,IAAG,YAAH;MAEI,OAAO,EAAE,CAAC,MAAM,CAAC,IAAV,CAAe,SAAf,EAA0B,CAA1B;MACP,IAAG,eAAc,gBAAjB;QACI,IAAC,eAAD,CAAgB,IAAhB,EAAsB,IAAtB,EADJ;OAAA,MAGK,IAAG,eAAc,eAAjB;QACD,IAAC,cAAD,CAAe,IAAf,EAAqB,IAArB,EADC;OAAA;QAID,IAAK,YAAW,CAAC,KAAjB,CAAuB,IAAvB,EAA6B,IAA7B,EAJC;OANT;KAAA;AAAA;;EAjBO;;sBAkCX,iBAAgB,SAAC,UAAD,EAAa,KAAb;WACZ,IAAC,cAAa,CAAC,WAAf,CAA2B,UAA3B;EADY;;sBAKhB,gBAAe,SAAC,UAAD,EAAa,KAAb;WACX,IAAC,cAAa,CAAC,UAAf,CAA0B,UAA1B;EADW;;sBAIf,gBAAe;AACX;IAAA,aAAa,IAAC,WAAU,CAAC;IAEzB,IAAG,aAAa,CAAhB;MACI,IAAC,EAAD,CAAG,wBAAH,CAA4B,CAAC,IAA7B,CAAkC,EAAE,SAAF,EAC9B;QAAA,aAAa,UAAb;OAD8B,CAAlC;MAEA,IAAC,EAAD,CAAG,wBAAH,CAA4B,CAAC,IAA7B;aACA,IAAC,EAAD,CAAG,qBAAH,CAAyB,CAAC,IAA1B,GAJJ;KAAA;MAMI,IAAC,EAAD,CAAG,wBAAH,CAA4B,CAAC,IAA7B;aACA,IAAC,EAAD,CAAG,qBAAH,CAAyB,CAAC,IAA1B,GAPJ;;EAHW;;sBAaf,iBAAgB,SAAC,KAAD,EAAQ,IAAR;IAEZ,IAAG,UAAS,KAAZ;MACI,IAAC,EAAD,CAAG,SAAO,IAAV,CAAiB,CAAC,QAAlB,CAA2B,QAA3B;MACA,IAAC,EAAD,CAAG,SAAO,IAAV,CAAiB,CAAC,WAAlB,CAA8B,UAA9B;MACA,IAAC,EAAD,CAAG,SAAO,IAAV,CAAiB,CAAC,IAAlB;MACA,IAAC,EAAD,CAAG,WAAS,IAAZ,CAAmB,CAAC,WAApB,CAAgC,QAAhC;MACA,IAAC,EAAD,CAAG,WAAS,IAAZ,CAAmB,CAAC,QAApB,CAA6B,UAA7B;aACA,IAAC,EAAD,CAAG,WAAS,IAAZ,CAAmB,CAAC,IAApB,GANJ;KAAA;MAQI,IAAC,EAAD,CAAG,WAAS,IAAZ,CAAmB,CAAC,QAApB,CAA6B,QAA7B;MACA,IAAC,EAAD,CAAG,WAAS,IAAZ,CAAmB,CAAC,WAApB,CAAgC,UAAhC;MACA,IAAC,EAAD,CAAG,WAAS,IAAZ,CAAmB,CAAC,IAApB;MACA,IAAC,EAAD,CAAG,SAAO,IAAV,CAAiB,CAAC,WAAlB,CAA8B,QAA9B;MACA,IAAC,EAAD,CAAG,SAAO,IAAV,CAAiB,CAAC,QAAlB,CAA2B,UAA3B;aACA,IAAC,EAAD,CAAG,SAAO,IAAV,CAAiB,CAAC,IAAlB,GAbJ;;EAFY;;sBAmBhB,gBAAe,SAAC,KAAD;AACX;IAAA,MAAgB,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,KAAhB,CAAsB,GAAtB,CAAhB,EAAC,cAAD,EAAQ;IAER,QAAW,UAAS,IAAZ,GAAsB,MAAtB,GAAkC;IAE1C,IAAC,QAAD,GAAW;MAAA,OAAO,KAAP;MAAc,MAAM,IAApB;;IACX,IAAC,WAAU,CAAC,KAAZ,GAAoB;IACpB,IAAC,WAAU,CAAC,IAAZ,GAAmB;WACnB,IAAC,WAAU,CAAC,IAAZ;EARW;;sBAYf,2BAA0B,SAAC,SAAD;AACtB;IAAA,IAAG,uBAAe,SAAS,CAAC,MAAV,GAAmB,CAAlC,IAAwC,gCAA3C;AACI;AAAA;WAAA;;qBACI,IAAI,CAAC,GAAL,CAAS,oBAAT,EAA+B,SAA/B;AADJ;qBADJ;;EADsB;;sBAK1B,UAAS;IACL,IAAC,cAAD,CAAe,IAAC,WAAhB;WACA;EAFK;;;;GA5P4B;;;;ACNzC;EAAA;;;;AAAA,WAAmB,QAAQ,kBAAR;;AACnB,YAAmB,QAAQ,SAAR;;AACnB,kBAAmB,QAAQ,eAAR;;AACnB,mBAAmB,QAAQ,iBAAR;;AACnB,QAAmB,QAAQ,SAAR;;AACnB,gBAAmB,QAAQ,mBAAR;;AACnB,gBAAmB,QAAQ,kBAAR;;AACnB,iBAAmB;;AAEnB,OAAmB,QAAQ,gBAAR;;AAEnB,gBAAgB;;;AAEhB;;;;;AAIA,MAAM,CAAC,OAAP,GAAuB;;;;;;;;uBAEnB,KAAI;;uBAEJ,WAAU,QAAQ,oBAAR;;uBAEV,SAAQ;WACJ;MAAA,4BAA4B,oBAA5B;MACA,4BAA4B,gBAD5B;MAEA,0BAA0B,cAF1B;MAGA,sBAAsB,gBAHtB;MAIA,wBAAwB,wBAJxB;MAKA,oBAAoB,iBALpB;MAMA,2BAA2B,qBAN3B;MAQA,qBAAqB,oBARrB;MASA,oBAAoB,eATpB;MAWA,+BAA+B,cAX/B;MAYA,6BAA6B,YAZ7B;MAaA,2BAA2B,UAb3B;MAeA,oBAAoB,aAfpB;MAgBA,oBAAoB,aAhBpB;MAiBA,mBAAmB,aAjBnB;MAkBA,oBAAoB,aAlBpB;MAmBA,eAAe,QAnBf;MAqBA,0BAA0B,kBArB1B;;EADI;;uBAwBR,aAAY,SAAC,OAAD;IACR,2CAAM,OAAN;IACA,IAAC,eAAD,GAAkB,OAAO,CAAC;IAC1B,IAAC,YAAD,GAAe,OAAO,CAAC;IAGvB,IAAC,MAAD,GAAS,OAAO,CAAC;IAGjB,KAAO,GAAG,CAAC,QAAX;;QACI,iBAAkB,QAAQ,eAAR;OADtB;;IAIA,IAAC,SAAD,CAAU,IAAC,eAAX,EAA2B,eAA3B,EAA4C,IAAC,oBAA7C;IACA,IAAC,SAAD,CAAU,IAAC,WAAX,EAAuB,QAAvB,EAAiC,IAAC,oBAAlC;IAGA,IAAC,SAAD,CAAU,IAAC,MAAX,EAAkB,MAAlB,EAA0B,IAAC,aAA3B;IAIA,IAAC,cAAD,GAAiB,KAAK,CAAC,KAAN,CAAY,IAAC,gBAAe,CAAC,IAAjB,CAAsB,IAAtB,CAAZ,EAAsC,CAAtC;IACjB,IAAC,yBAAD,GAA4B;IAG5B,IAAC,cAAa,CAAC,KAAf,GAAuB;aAAA;eAAG,KAAC,yBAAD,GAA4B;MAA/B;IAAA;IAIvB,IAAC,SAAD,CAAU,IAAC,YAAX,EAAwB,UAAxB,EAAoC,IAAC,cAAa,CAAC,IAAnD;IACA,IAAC,SAAD,CAAU,IAAC,YAAX,EAAwB,aAAxB,EAAuC,IAAC,iBAAxC;IACA,IAAC,SAAD,CAAU,IAAC,YAAX,EAAwB,qBAAxB,EAA+C,IAAC,sBAAhD;AAEA,WAAO;EAjCC;;uBAmCZ,kBAAiB,SAAC,KAAD,EAAQ,IAAR;IAIb,IAAG,qCAAH;MACI,KAAK,CAAC,aAAN,CAAoB,IAAC,yBAArB;aACA,OAFJ;KAAA;aAKQ,kBAAc,KAAd,EAAqB;eAAA,SAAC,MAAD,EAAS,cAAT;UAGrB,IAAG,sBAAH;YACI,KAAC,yBAAD,GAA4B,eADhC;;UAGA,KAAK,CAAC,aAAN,CAAoB,MAApB;iBAEA;QARqB;MAAA,QAArB,EALR;;EAJa;;uBAmBjB,UAAS;IAEL,IAAC,WAAU,CAAC,OAAZ,CAAoB,SAAC,OAAD;aAAa,OAAO,CAAC,UAAR,GAAqB;IAAlC,CAApB;IAGA,IAAC,gBAAe,CAAC,OAAjB;IACA,IAAC,gBAAD,GAAmB;IACnB,IAAC,UAAS,CAAC,OAAX;IACA,IAAC,UAAD,GAAa;IAGb,IAAC,cAAa,CAAC,IAAf;IACA,IAAC,cAAD,GAAiB;WAEjB;EAdK;;uBAgBT,gBAAe;WACX;MAAA,yBAAyB,IAAC,0BAAD,EAAzB;MACA,OAAO,IAAC,MAAK,CAAC,MAAP,EADP;MAEA,WAAW,IAAC,MAAK,CAAC,YAAP,EAFX;MAGA,OAAO,IAAC,MAHR;MAIA,QAAQ,IAAC,MAAK,CAAC,SAAP,EAJR;;EADW;;uBAQf,cAAa;IACT,IAAC,aAAD,GAAgB,IAAC,EAAD,CAAG,yBAAH;IAGhB,IAAC,iBAAD;IAGA,IAAC,eAAD;IAGA,IAAC,mBAAD;IAKA,IAAG,IAAC,MAAK,CAAC,sBAAP,EAAH;MACI,IAAC,YAAD;aACA,IAAC,EAAD,CAAG,oBAAH,CAAwB,CAAC,IAAzB,GAFJ;KAAA;MAII,IAAC,MAAK,CAAC,iBAAP,GAA2B;aAC3B,IAAC,EAAD,CAAG,oBAAH,CAAwB,CAAC,IAAzB,GALJ;;EAfS;;uBAsBb,mBAAkB;IACd,IAAC,EAAD,CAAG,SAAH,CAAa,CAAC,KAAd;IACA,IAAC,gBAAD,GAAuB,oBACnB;MAAA,YAAY,IAAC,MAAK,CAAC,UAAnB;MACA,OAAO,IAAC,MADR;KADmB;WAGvB,IAAC,EAAD,CAAG,SAAH,CAAa,CAAC,MAAd,CAAqB,IAAC,gBAAe,CAAC,MAAjB,EAAyB,CAAC,GAA/C;EALc;;uBAOlB,iBAAgB;IAEZ,IAAC,UAAD,GAAiB,cACb;MAAA,OAAO,IAAC,MAAR;MACA,YAAY,IAAC,WADb;MAEA,aAAa,IAAC,YAFd;MAGA,qBAAqB,IAAC,oBAAD,EAAsB,CAAC,MAH5C;MAIA,cAAc,IAAC,MAAK,CAAC,GAAP,CAAW,MAAX,MAAsB,QAJpC;KADa;WAOjB,IAAC,UAAS,CAAC,MAAX;EATY;;uBAWhB,qBAAoB;IAChB,IAAC,aAAD,GAAoB,qBAChB;MAAA,YAAY,IAAC,YAAW,CAAC,gBAAzB;MACA,aAAa,IAAC,YADd;KADgB;WAIpB,IAAC,aAAY,CAAC,MAAd,EAAsB,CAAC,GAAG,CAAC,QAA3B,CAAoC,IAAC,EAAD,CAAG,0BAAH,CAApC;EALgB;;uBAOpB,OAAM,SAAC,KAAD;;MAAC,QAAM;;IACT,IAAG,KAAH;aACI,IAAC,EAAD,CAAG,oBAAH,CAAwB,CAAC,IAAzB,GADJ;KAAA;aAGI,IAAC,EAAD,CAAG,oBAAH,CAAwB,CAAC,IAAzB,GAHJ;;EADE;;uBAON,cAAa;IACT,IAAC,KAAD;WACA,IAAC,eAAc,CAAC,gBAAhB,CAAiC,IAAC,MAAlC,EAAyC;aAAA;QACrC,KAAC,KAAD,CAAM,KAAN;eAIA,KAAC,aAAD;MALqC;IAAA,QAAzC;EAFS;;;AASb;;;;uBAIA,qBAAoB;AAGhB;IAAA,IAAG,IAAC,UAAJ;MAEI,OAAO,CAAC,CAAC,IAAF,CAAO,IAAC,UAAS,CAAC,IAAlB,EAAwB;eAAA,SAAC,IAAD;AAC3B,iBAAO,IAAI,CAAC,KAAK,CAAC,GAAX,KAAkB,KAAC,UAAS,CAAC;QADT;MAAA,QAAxB;aAEP,IAAI,CAAC,CAAL,CAAO,iBAAP,CAAyB,CAAC,KAA1B,GAJJ;KAAA;;QAMI,IAAC,aAAiB,SACd;UAAA,MAAM,EAAN;UACA,MAAM,QADN;UAEA,MAAM,IAAC,MAAK,CAAC,aAAP,EAFN;UAGA,MAAM,EAAE,CAAC,MAAH,CAAU,IAAC,MAAK,CAAC,GAAP,CAAW,MAAX,CAAV,CAHN;SADc;;MAOlB,IAAC,eAAc,CAAC,GAAhB,CAAoB,IAAC,UAArB,EAAgC;QAAA,IAAI,CAAJ;OAAhC;MAGA,OAAO,CAAC,CAAC,IAAF,CAAO,IAAC,UAAS,CAAC,IAAlB,EAAwB;eAAA,SAAC,IAAD;AAC3B,iBAAO,IAAI,CAAC,KAAK,CAAC,GAAX,KAAkB,KAAC,UAAS,CAAC;QADT;MAAA,QAAxB;MAEP,IAAI,CAAC,aAAL,CAAmB,EAAnB;aAEA,IAAC,UAAS,CAAC,IAAX,CAAgB,cAAhB,EAAgC;eAAA;iBAAG,KAAC,UAAD,GAAa;QAAhB;MAAA,QAAhC,EApBJ;;EAHgB;;uBAyBpB,iBAAgB;WACR,mBACA;MAAA,OAAO,IAAC,MAAR;KADA;EADQ;;;AAIhB;;;;uBAGA,cAAa,SAAC,KAAD;IACT,KAAK,CAAC,cAAN;WACA,KAAK,CAAC,eAAN;EAFS;;uBAIb,cAAa,SAAC,KAAD;IACT,KAAK,CAAC,cAAN;IACA,KAAK,CAAC,eAAN;IACA,IAAG,CAAI,IAAC,SAAL,IAAiB,IAAC,UAArB;MACI,IAAC,aAAY,CAAC,QAAd,CAAuB,mBAAvB;aACA,IAAC,EAAD,CAAG,kBAAH,CAAsB,CAAC,IAAvB,GAFJ;;EAHS;;uBAOb,cAAa,SAAC,KAAD;IACT,KAAK,CAAC,cAAN;IACA,KAAK,CAAC,eAAN;IACA,IAAG,CAAI,IAAC,SAAL,IAAiB,IAAC,UAArB;MACI,IAAC,aAAY,CAAC,WAAd,CAA0B,mBAA1B;aACA,IAAC,EAAD,CAAG,kBAAH,CAAsB,CAAC,IAAvB,GAFJ;;EAHS;;uBAOb,SAAQ,SAAC,KAAD;IACJ,KAAK,CAAC,cAAN;IACA,KAAK,CAAC,eAAN;IACA,IAAgB,IAAC,SAAD,IAAc,CAAI,IAAC,UAAnC;AAAA,aAAO,MAAP;;IAGA,IAAG,gCAAH;MACI,IAAC,wBAAD,CAAyB,KAAzB,EADJ;KAAA;MAGI,IAAC,gBAAD,CAAiB,KAAjB,EAHJ;;IAKA,IAAC,aAAY,CAAC,WAAd,CAA0B,mBAA1B;WACA,IAAC,EAAD,CAAG,kBAAH,CAAsB,CAAC,IAAvB;EAZI;;uBAcR,sBAAqB,SAAC,KAAD;AACjB;IAAA,QAAQ,IAAC,EAAD,CAAG,kBAAH;IACR,QAAQ,KAAM,GAAE,CAAC;IACjB,KAAc,KAAK,CAAC,MAApB;AAAA;;IACA,IAAC,YAAW,CAAC,cAAb,CAA4B,KAA5B,EAAmC,IAAC,MAApC;WAEA,KAAK,CAAC,WAAN,CAAkB,KAAK,CAAC,KAAN,CAAY,IAAZ,CAAlB;EANiB;;uBAQrB,kBAAiB,SAAC,KAAD;AACb;IAAA,iDAA0B,CAAE,eAApB,IAA6B,KAAK,CAAC,MAAM,CAAC;IAElD,IAAG,KAAK,CAAC,MAAT;aACI,IAAC,YAAW,CAAC,QAAb,CAAsB,KAAtB,EAA6B,IAAC,MAA9B,EADJ;;EAHa;;uBAOjB,0BAAyB,SAAC,CAAD;AACrB;IAAA,QAAQ,CAAC,CAAC,YAAY,CAAC;IACvB,KAAc,KAAK,CAAC,MAApB;AAAA;;IAEA,QAAQ;IACR,SAAS;IAGT,gBAAgB;aAAA;AAEZ;QAAA,gBAAgB;iBACZ,KAAC,YAAW,CAAC,cAAb,CAA4B,KAA5B,EAAmC,KAAC,MAApC;QADY;QAGhB,IAAG,MAAM,CAAC,MAAP,GAAgB,CAAnB;UACI,kBAAkB,MACd,CAAC,GADa,CACT,SAAC,IAAD;mBAAU,OAAK,IAAL,GAAU;UAApB,CADS,CAEd,CAAC,IAFa,CAER,IAFQ;UAGlB,gBACI;YAAA,OAAO,eAAP;YACA,aAAa,MAAM,CAAC,MADpB;;iBAGA,UAAM,EAAE,6BAAF,CAAN,EACA,EAAE,+BAAF,EAAmC,aAAnC,CADA,EAEA,EAAE,qBAAF,CAFA,EAE0B,IAF1B,EAEgC,SAAC,OAAD;mBAAa;UAAb,CAFhC,EARR;SAAA;iBAYI,gBAZJ;;MALY;IAAA;IAqBhB,0BAA0B;aAAA,SAAC,KAAD,EAAQ,IAAR,EAAc,IAAd;AACtB;QAAA,OAAO,QAAQ;QACf,IAAqB,IAAI,CAAC,MAAL,GAAc,CAAnC;UAAA,OAAU,IAAD,GAAM,IAAf;;QAIA,IAAG,KAAK,CAAC,MAAT;iBACI,KAAK,CAAC,IAAN,CAAW,SAAC,IAAD;YACP,IAAI,CAAC,YAAL,GAAoB,KAAG,IAAH,GAAU,IAAI,CAAC;YACnC,KAAK,CAAC,IAAN,CAAW,IAAX;mBACA;UAHO,CAAX,EAIE,SAAC,KAAD;YACE,MAAM,CAAC,IAAP,CAAY,KAAK,CAAC,IAAlB;mBACA;UAFF,CAJF,EADJ;SAAA,MAWK,IAAG,KAAK,CAAC,WAAT;UACD,SAAS,KAAK,CAAC,YAAN;iBAIN,iBAAgB;mBACf,MAAM,CAAC,WAAP,CAAmB,SAAC,OAAD;cACf,IAAG,OAAO,CAAC,MAAR,KAAkB,CAArB;uBACI,OADJ;eAAA;uBAGI,KAAK,CAAC,UAAN,CAAiB,OAAjB,EAA0B,SAAC,QAAD,EAAW,IAAX;yBACtB,wBAAwB,QAAxB,EAAkC,KAAG,IAAH,GAAU,KAAK,CAAC,IAAlD,EAA0D,IAA1D;gBADsB,CAA1B,EAEE,aAFF,EAHJ;;YADe,CAAnB;UADe,CAAhB,CAAH,GALC;;MAjBiB;IAAA;WAgC1B,KAAK,CAAC,UAAN,CAAiB,KAAjB,EAAwB,SAAC,IAAD,EAAO,IAAP;AACpB;MAAA,QAAQ,IAAI,CAAC,gBAAL;aACR,wBAAwB,KAAxB,EAA+B,IAA/B,EAAqC,IAArC;IAFoB,CAAxB,EAGE,aAHF;EA7DqB;;;AAmEzB;;;;uBAGA,mBAAkB,SAAC,CAAD;AACd;IAAA,IAAG,IAAC,UAAD,KAAgB,IAAnB;MACI,YAAY;aACZ,WAAW;eAAA;AACP;UAAA,QAAQ,KAAC,EAAD,CAAG,kBAAH,CAAsB,CAAC,GAAvB,EAA4B,CAAC,IAA7B;UAER,IAAG,UAAW,EAAd;YACI,QAAQ,aAAW,MADvB;WAAA,MAIK,IAAG,CAAC,CAAC,OAAF,KAAa,aAAhB;YACD,QAAQ,GADP;WAAA;YAKD,QAAQ,KALP;;UAOL,IAA0C,aAA1C;YAAA,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,QAAlB,CAA2B,KAA3B,EAAkC,IAAlC;;iBACA,YAAY;QAfL;MAAA,QAAX,EAgBE,IAhBF,EAFJ;;EADc;;uBAwBlB,eAAc,SAAC,KAAD,EAAQ,UAAR;IACV,IAAC,cAAD,CAAe,IAAC,MAAhB;IACA,IAAC,cAAD,CAAe,IAAC,WAAhB;IACA,IAAC,MAAD,GAAS;IACT,IAAC,WAAD,GAAc;IAEd,EAAE,iBAAF,CAAoB,CAAC,IAArB;IAGA,IAAG,sBAAH;MACI,IAAC,UAAS,CAAC,OAAX;MAEA,IAAC,EAAD,CAAG,oBAAH,CAAwB,CAAC,KAAzB,CAA+B,EAAE,wBAAF,CAA/B,EAHJ;;IAIA,IAAC,iBAAD;WACA,IAAC,eAAD;EAdU;;;AAiBd;;;;uBAGA,qBAAoB,SAAC,KAAD;AAChB;IAAA,YAAY,IAAC,oBAAD,EAAsB,CAAC,MAAvB,KAAiC,IAAC,WAAU,CAAC,IAAZ;WAC7C,IAAC,WAAU,CAAC,OAAZ,CAAoB,SAAC,KAAD;aAChB,KAAK,CAAC,oBAAN,CAA2B,CAAI,SAA/B;IADgB,CAApB;EAFgB;;uBAMpB,gBAAe,SAAC,KAAD;IACX,IAAG,KAAK,CAAC,MAAM,CAAC,EAAb,KAAmB,OAAtB;aACI,IAAC,WAAU,CAAC,OAAZ,CAAoB,SAAC,KAAD;eAChB,KAAK,CAAC,oBAAN,CAA2B,KAA3B;MADgB,CAApB,EADJ;;EADW;;uBAOf,sBAAqB;AACjB,WAAO,IAAC,WAAU,CAAC,MAAZ,CAAmB,SAAC,KAAD;AAAW,aAAO,KAAK,CAAC,cAAN;IAAlB,CAAnB;EADU;;uBAKrB,sBAAqB,SAAC,KAAD;AACjB;IAAC,iBAAkB,MAAlB;IAED,mBAAmB,IAAC,oBAAD;IAInB,IAAG,cAAH;MACI,IAAC,sBAAD,GADJ;;IAGA,IAAG,gBAAgB,CAAC,MAAjB,GAA0B,CAA7B;MACI,IAAC,EAAD,CAAG,cAAH,CAAkB,CAAC,IAAnB;MACA,IAAC,EAAD,CAAG,yBAAH,CAA6B,CAAC,IAA9B;MACA,IAAC,EAAD,CAAG,uBAAH,CAA2B,CAAC,IAA5B;MACA,IAAC,EAAD,CAAG,oBAAH,CAAwB,CAAC,IAAzB;MACA,IAAC,EAAD,CAAG,gBAAH,CAAoB,CAAC,IAArB;MACA,IAAC,EAAD,CAAG,wBAAH,CAA4B,CAAC,QAA7B,CAAsC,SAAtC;MAEA,IAAG,GAAG,CAAC,QAAP;QACI,IAAC,EAAD,CAAG,wBAAH,CAA4B,CAAC,IAA7B;QACA,IAAC,EAAD,CAAG,uBAAH,CAA2B,CAAC,IAA5B,GAFJ;OARJ;KAAA;MAaI,IAAG,GAAG,CAAC,QAAP;QACI,IAAC,EAAD,CAAG,gBAAH,CAAoB,CAAC,IAArB;QACA,2DAAmC;QACnC,IAAG,EAAE,MAAF,CAAS,CAAC,QAAV,CAAmB,YAAnB,CAAH;UACI,IAAC,EAAD,CAAG,yBAAH,CAA6B,CAAC,IAA9B;UACA,IAAC,EAAD,CAAG,uBAAH,CAA2B,CAAC,IAA5B;UACA,IAAC,EAAD,CAAG,oBAAH,CAAwB,CAAC,IAAzB,GAHJ;;QAIA,IAAC,EAAD,CAAG,wBAAH,CAA4B,CAAC,IAA7B;QACA,IAAC,EAAD,CAAG,uBAAH,CAA2B,CAAC,IAA5B,GARJ;OAAA;QAUI,IAAC,EAAD,CAAG,cAAH,CAAkB,CAAC,IAAnB;QACA,IAAC,EAAD,CAAG,yBAAH,CAA6B,CAAC,IAA9B;QACA,IAAC,EAAD,CAAG,uBAAH,CAA2B,CAAC,IAA5B;QACA,IAAC,EAAD,CAAG,oBAAH,CAAwB,CAAC,IAAzB;QACA,IAAC,EAAD,CAAG,wBAAH,CAA4B,CAAC,WAA7B,CAAyC,SAAzC,EAdJ;OAbJ;;IAiCA,IAAG,gBAAgB,CAAC,MAAjB,KAA2B,CAA3B,IAAgC,IAAC,WAAU,CAAC,IAAZ,OAAsB,CAAzD;MACI,IAAC,EAAD,CAAG,eAAH,CAAmB,CAAC,WAApB,CAAgC,mBAAhC;MACA,IAAC,EAAD,CAAG,eAAH,CAAmB,CAAC,WAApB,CAAgC,mBAAhC;aACA,IAAC,EAAD,CAAG,eAAH,CAAmB,CAAC,QAApB,CAA6B,aAA7B,EAHJ;KAAA,MAIK,IAAG,gBAAgB,CAAC,MAAjB,KAA2B,IAAC,WAAU,CAAC,IAAZ,EAA9B;MACD,IAAC,EAAD,CAAG,eAAH,CAAmB,CAAC,WAApB,CAAgC,aAAhC;MACA,IAAC,EAAD,CAAG,eAAH,CAAmB,CAAC,WAApB,CAAgC,mBAAhC;aACA,IAAC,EAAD,CAAG,eAAH,CAAmB,CAAC,QAApB,CAA6B,mBAA7B,EAHC;KAAA;MAKD,IAAC,EAAD,CAAG,eAAH,CAAmB,CAAC,WAApB,CAAgC,aAAhC;MACA,IAAC,EAAD,CAAG,eAAH,CAAmB,CAAC,WAApB,CAAgC,mBAAhC;aACA,IAAC,EAAD,CAAG,eAAH,CAAmB,CAAC,QAApB,CAA6B,mBAA7B,EAPC;;EA/CY;;uBA0DrB,wBAAuB;AACnB;IAAA,mBAAmB,IAAC,oBAAD;IAInB,IAAG,gBAAgB,CAAC,MAAjB,IAA2B,CAA9B;MAGI,gBAAgB,gBAAiB;MACjC,eAAe,gBAAiB,iBAAgB,CAAC,MAAjB,GAA0B,CAA1B;MAChC,qBAAqB,IAAC,WAAU,CAAC,OAAZ,CAAoB,aAApB;MACrB,oBAAoB,IAAC,WAAU,CAAC,OAAZ,CAAoB,YAApB;aAEpB,IAAC,WAEG,CAAC,MAFL,CAEY,SAAC,KAAD,EAAQ,KAAR;AACJ,eAAO,sBAAqB,KAArB,IAAqB,KAArB,GAA6B,iBAA7B,KACA,CAAI,KAAK,CAAC,cAAN;MAFP,CAFZ,CAOI,CAAC,OAPL,CAOa,SAAC,KAAD;eAAW,KAAK,CAAC,kBAAN;MAAX,CAPb,EARJ;;EALmB;;;AAuBvB;;;;uBAGA,aAAY;WACJ,UAAM,EAAE,oBAAF,CAAN,EAA+B,EAAE,kBAAF,CAA/B,EACM,EAAE,iBAAF,CADN,EAC4B,EAAE,cAAF,CAD5B,EAC+C;aAAA,SAAC,OAAD;AAC/C;QAAA,IAAG,OAAH;UAGI,mBAAmB,KAAC,oBAAD;UACnB,MAAM,CAAC,iBAAiB,CAAC,QAAzB,IAAqC,gBAAgB,CAAC;AAKtD;;YACI,KAAC,eAAc,CAAC,MAAhB,CAAuB,KAAvB;AADJ;iBAKA,KAAK,CAAC,MAAN,CAAa,gBAAb,EAA+B,SAAC,KAAD,EAAQ,IAAR;mBAC3B,KAAK,CAAC,OAAN,CACI;cAAA,SAAS;gBACL,MAAM,CAAC,iBAAiB,CAAC,QAAzB;uBACA,KAAK,KAAL;cAFK,CAAT;cAGA,OAAO;gBACH,MAAM,CAAC,iBAAiB,CAAC,QAAzB;uBAGA,KAAK,IAAL;cAJG,CAHP;cASA,QAAQ,KATR;cAUA,MAAM,IAVN;aADJ;UAD2B,CAA/B,EAcE,SAAC,eAAD;AAGE;YAAA,IAAG,eAAe,CAAC,MAAhB,GAAyB,CAA5B;cACI,iBAAiB;gBAAA,aAAa,eAAe,CAAC,MAA7B;;cACjB,KAAK,CAAC,KAAN,CAAY,EAAE,oBAAF,EAAwB,cAAxB,CAAZ;cACA,sBAAsB,CAAC,CAAC,MAAF,CAClB,eADkB,EAEhB,SAAC,KAAD;AAAW,uBAAO,KAAK,CAAC;cAAxB,CAFgB;AAItB;mBAAA;;6BACI,KAAC,eAAc,CAAC,GAAhB,CAAoB,KAApB;AADJ;6BAPJ;;UAHF,CAdF,EAdJ;;MAD+C;IAAA,QAD/C;EADI;;uBA6CZ,WAAU;WACF,kBACA;MAAA,YAAY,IAAC,oBAAD,EAAZ;MACA,YAAY,IAAC,MAAK,CAAC,aAAP,EADZ;KADA;EADE;;uBAKV,eAAc;AACV;IAAA,mBAAmB,IAAC,oBAAD;IACnB,IAAG,gBAAgB,CAAC,MAAjB,GAA0B,CAA7B;MACI,gBAAgB,gBAAgB,CAAC,GAAjB,CAAqB,SAAC,OAAD;QACjC,IAAG,OAAO,CAAC,QAAR,EAAH;AACI,iBAAS,CAAC,OAAO,CAAC,aAAR,EAAD,IAAyB,IADtC;SAAA;AAGI,iBAAO,KAAE,CAAC,OAAO,CAAC,aAAR,EAAD,EAHb;;MADiC,CAArB;MAKhB,MAAM,IAAC,MAAK,CAAC,SAAP;MAEN,sBAAsB,aAAa,CAAC,IAAd,CAAmB,GAAnB;MAItB,aAAa,aACJ,mBADI,GACgB;MAE7B,OAAO,6CACgC,GADhC,GACoC,yEADpC,GAEyC,UAFzC,GAEoD;MAG3D,EAAE,MAAF,CAAS,CAAC,MAAV,CAAiB,IAAjB;MACA,EAAE,oBAAF,CAAuB,CAAC,MAAxB;aACA,EAAE,oBAAF,CAAuB,CAAC,MAAxB,GAtBJ;KAAA;MA0BI,IAAI,QAAQ,CAAC,aAAT,CAAuB,GAAvB;MACJ,CAAC,CAAC,IAAF,GAAS,gBAAiB,GAAE,CAAC,cAApB;aACT,CAAC,CAAC,aAAF,CAAoB,UAAM,CAAC,UAAP,CAAkB,OAAlB,EAA2B;QAAA,QAAQ,MAAR;QAAgB,WAAW,IAA3B;QAAiC,cAAc,IAA/C;OAA3B,CAApB,EA5BJ;;EAFU;;;AAiCd;;;;uBAGA,4BAA2B;AACvB;IAAA,QAAQ,EAAE,qBAAF,CAAyB;IACjC,0BAA0B,6BACA,4BADA,IAEA,+BAFA,IAGA;AAC1B,WAAO;EANgB;;uBAS3B,yBAAwB,SAAC,KAAD;IACpB,IAAG,IAAC,WAAU,CAAC,MAAZ,KAAsB,CAAzB;MACI,KAAK,CAAC,cAAN;aACA,KAAK,CAAC,KAAN,CAAY,EAAE,8BAAF,CAAZ,EAFJ;;EADoB;;uBAMxB,eAAc;AACV;IAAA,YAAY,IAAC,MAAK,CAAC,YAAP;IACZ,IAAG,cAAa,QAAhB;MACI,oBAAoB,+DAEI,CAAC,EAAE,QAAF,CAAD,CAFJ,GAEgB,UAHxC;KAAA,MAKK,IAAG,uBAAe,SAAS,CAAC,MAAV,GAAmB,CAArC;MACD,oBAAoB,+DAEI,CAAC,EAAE,QAAF,CAAD,CAFJ,GAEgB,kBAFhB,GAGP,SAAS,CAAC,MAHH,GAGU,WAJ7B;KAAA;MAOD,oBAAoB,GAPnB;;IASL,IAAC,EAAD,CAAG,eAAH,CAAmB,CAAC,IAApB,CAAyB,iBAAzB;WACA,IAAC,UAAS,CAAC,wBAAX,CAAoC;MAAC;QAAA,WAAW,SAAX;OAAD;KAApC;EAjBU;;uBAoBd,mBAAkB;WACd,KAAK,CAAC,KAAN,CAAY,EAAE,qCAAF,CAAZ;EADc;;uBAKlB,wBAAuB,SAAC,KAAD;WACnB,KAAK,CAAC,KAAN,CAAY,EAAE,6BAAF,EAAiC;MAAA,MAAM,KAAK,CAAC,GAAN,CAAU,MAAV,CAAN;KAAjC,CAAZ;EADmB;;;;GAplBe;;;;;AChB1C;;;;AAAA;;AAIA,MAAM,CAAC,OAAP,GAAuB;;;;AAEnB;;;;;oBAIA,OAAM,SAAC,YAAD;AAGF;IAAA,MAAM,QAAQ,CAAC,cAAT,CAAwB,SAAxB;IACN,IAAG,QAAO,IAAV;MACI,MAAM,QAAQ,CAAC,aAAT,CAAuB,KAAvB;MACN,GAAG,CAAC,EAAJ,GAAS;MACT,GAAG,CAAC,KAAK,CAAC,OAAV,GAAoB;MACpB,QAAQ,CAAC,IAAI,CAAC,WAAd,CAA0B,GAA1B,EAJJ;KAAA;MAMI,GAAG,CAAC,SAAJ,GAAgB,GANpB;;IASA,oBAAoB;IACpB,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,UAAU,CAAC,UAAU,CAAC,OAAxC,CAAgD;aAAA,SAAC,KAAD;AAC5C;QAAA,IAAG,CAAC,KAAK,CAAC,OAAN,EAAJ;AACI,iBADJ;;QAEA,IAAS,QAAQ,CAAC,aAAT,CAAuB,GAAvB;QACT,CAAC,CAAC,IAAF,GAAS,KAAK,CAAC,YAAN;QACT,GAAG,CAAC,WAAJ,CAAgB,CAAhB;QACA,IAAG,UAAS,YAAZ;iBACI,oBAAoB,EADxB;;MAN4C;IAAA,QAAhD;IAUA,MAAM,CAAC,WAAW,CAAC,GAAnB,CAAuB,UAAvB,EACI;MAAA,UAAY,IAAZ;MACA,SAAY,MADZ;MAEA,OAAY,KAFZ;MAGA,SAAY,CAHZ;MAIA,WAAY,SAJZ;KADJ;IASA,QAAQ,QAAQ,CAAC,WAAT,CAAqB,YAArB;IACR,KAAK,CAAC,cAAN,CAAqB,OAArB,EAA8B,IAA9B,EAAoC,IAApC,EAA0C,MAA1C,EAAkD,CAAlD,EAAqD,CAArD,EAAwD,CAAxD,EAA2D,CAA3D,EAA8D,CAA9D,EAAiE,KAAjE,EAAwE,KAAxE,EAA+E,KAA/E,EAAsF,KAAtF,EAA6F,CAA7F,EAAgG,IAAhG;IACA,KAAK,CAAC,cAAN;IACA,iBAAiB,CAAC,aAAlB,CAAgC,KAAhC;EApCE;;;;;;;;ACXV;EAAA;;;AAAA,WAAW,QAAQ,kBAAR;;AAEX,MAAM,CAAC,OAAP,GAAuB;;;sBAEnB,KAAI;;sBACJ,YAAW;;sBACX,aACI;IAAA,aAAa,CAAC,CAAd;;;sBACJ,WAAU,QAAQ,mBAAR;;sBACV,QAAO;;sBAEP,SAAQ;WACJ;MAAA,0BAA4B,MAA5B;MACA,2BAA4B,OAD5B;;EADI;;EAIK,mBAAC,KAAD,EAAS,GAAT,EAAe,GAAf,EAAqB,EAArB,EAA0B,GAA1B,EAA+B,SAA/B;IAAC,IAAC,SAAD;IAAQ,IAAC,OAAD;IAAM,IAAC,OAAD;IAAM,IAAC,MAAD;IAAK,IAAC,MAAD;IAAK,IAAC,iCAAD,YAAW;IACnD;EADS;;sBAGb,aAAY;IACR,IAAC,IAAG,CAAC,EAAL,CAAQ,iBAAR,EAA2B,IAAC,MAAK,CAAC,IAAP,CAAY,IAAZ,CAA3B;IAEA,IAAC,OAAD;WACA,IAAC,KAAD;EAJQ;;sBAMZ,QAAO;IACH,IAAY,IAAC,GAAb;MAAA,IAAC,GAAD,CAAI,IAAJ;;WACA,IAAC,KAAD;EAFG;;sBAIP,OAAM;IACF,IAAa,IAAC,GAAd;MAAA,IAAC,GAAD,CAAI,KAAJ;;IACA,IAAW,IAAC,UAAZ;aAAA,IAAC,KAAD;;EAFE;;sBAIN,SAAQ;;sBAER,QAAO;WACH,WAAW,IAAC,QAAO,CAAC,IAAT,CAAc,IAAd,CAAX,EAA6B,GAA7B;EADG;;sBAGP,OAAM;IACF,IAAC,IAAG,CAAC,KAAL,CAAW,MAAX;WACA,IAAC,IAAG,CAAC,OAAL,CAAa,MAAb;EAFE;;sBAIN,OAAM;IACF,IAAC,IAAG,CAAC,KAAL,CAAW,MAAX;WACA,IAAC,IAAG,CAAC,OAAL,CAAa,MAAb;EAFE;;sBAIN,SAAQ;IACJ,IAAC,IAAG,CAAC,MAAL,CAAY,IAAC,SAAD,CAAU;MAAA,OAAO,IAAC,MAAR;MAAe,KAAK,IAAC,IAArB;MAA0B,KAAK,IAAC,IAAhC;MAAqC,IAAI,IAAC,GAA1C;KAAV,CAAZ;IACA,EAAE,MAAF,CAAS,CAAC,MAAV,CAAiB,IAAC,IAAlB;IACA,IAAC,YAAD;WACA;EAJI;;;;GA3C6B;;AAiDzC,MAAM,CAAC,OAAO,CAAC,KAAf,GAAuB,SAAC,IAAD,EAAO,EAAP;SACf,cAAU,EAAE,aAAF,CAAV,EAA4B,IAA5B,EAAkC,EAAE,UAAF,CAAlC,EAAiD,KAAjD,EAAwD,EAAxD;AADe;;;;ACnDvB;EAAA;;;AAAA,QAAQ,QAAQ,SAAR;;AACR,SAAS,QAAQ,eAAR;;AAET,MAAM,CAAC,OAAP,GAAuB;;;8BAEnB,eAAc;WAAG,yCAED,CAAC,EAAE,kBAAF,CAAD,CAFC,GAEqB;EAFxB;;8BAOd,gBAAe,SAAC,IAAD;WACX,qCAEO,CAAE,EAAE,gCAAF,CAAF,CAFP,GAE4C,KAF5C,GAEiD,IAFjD,GAEsD,iEAFtD,GAIK,CAAC,EAAE,QAAF,CAAD,CAJL,GAIiB;EALN;;8BAUf,iBAAgB,SAAC,IAAD;WAAU,qBACL,IADK,GACA,KADA,GACI,IADJ,GACS;EADnB;;EAIH,2BAAC,OAAD;IAET,mDAAM,EAAE,0BAAF,CAAN,EAAqC,EAArC,EAAyC,EAAE,MAAF,CAAzC,EAAoD,EAAE,OAAF,CAApD;IAGA,IAAC,WAAD,GAAc,OAAO,CAAC;IACtB,IAAC,WAAD,GAAc,OAAO,CAAC;EANb;;8BAQb,cAAa;WAET,MAAM,CAAC,GAAP,CAAW,cAAX,EAA2B;aAAA,SAAC,GAAD,EAAM,KAAN;AACvB;QAAA,IAAG,WAAH;iBACI,KAAK,CAAC,KAAN,CAAY,GAAZ,EADJ;SAAA;UAII,IAAkB,KAAC,WAAD,KAAkB,EAApC;YAAA,KAAK,CAAC,IAAN,CAAW,GAAX;;UAIA,iBAAiB,KAAC,WACd,CAAC,MADY,CACL,SAAC,OAAD;mBAAa,OAAO,CAAC,QAAR;UAAb,CADK,CAEb,CAAC,GAFY,CAER,SAAC,OAAD;mBAAa,OAAO,CAAC,aAAR;UAAb,CAFQ;UAIjB,eAAe,CAAC,CAAC,MAAF,CAAS,KAAT,EAAgB,SAAC,IAAD;AAG3B;YAAA,aAAa,OAAO;YAIpB,YAAY,CAAI,CAAC,CAAC,IAAF,CAAO,cAAP,EAAuB,SAAC,aAAD;qBACnC,UAAU,CAAC,OAAX,CAAmB,aAAnB,MAAqC;YADF,CAAvB;AAGhB,mBAAO,aAAc,SAAU,KAAC;UAVL,CAAhB;UAaf,KAAC,SAAD,GAAY,EAAE,KAAC,aAAD,EAAF;AACZ;;YACI,KAAC,SAAQ,CAAC,IAAV,CAAe,QAAf,CAAwB,CAAC,MAAzB,CAAgC,KAAC,eAAD,CAAgB,IAAhB,CAAhC;AADJ;iBAGA,KAAC,IAAG,CAAC,IAAL,CAAU,aAAV,CAAwB,CAAC,MAAzB,CAAgC,KAAC,SAAjC,EA7BJ;;MADuB;IAAA,QAA3B;EAFS;;8BAkCb,QAAO;AAEH;IAAA,IAAC,EAAD,CAAG,mBAAH,CAAuB,CAAC,IAAxB,CAA6B,EAAE,WAAF,CAA7B;IAGA,UAAU,EAAE,cAAF,CAAiB,CAAC,GAAlB,EAAuB,CAAC,SAAxB,CAAkC,CAAlC;IACV,eAAe,IAAC;WAEhB,IAAC,WAAD,CAAY,OAAZ,EAAqB;aAAA,SAAC,GAAD;AAEjB;QAAA,KAAC,EAAD,CAAG,mBAAH,CAAuB,CAAC,IAAxB;QAEA,IAAG,WAAH;iBAEI,KAAK,CAAC,KAAN,CAAY,EAAE,yBAAF,CAAZ,EAFJ;SAAA;UAKI,KAAC,SAAQ,CAAC,OAAV,CAAkB;mBAAG,KAAC,SAAQ,CAAC,MAAV;UAAH,CAAlB;UACA,aAAa,EAAE,KAAC,cAAD,CAAe,OAAf,CAAF;UAGb,eAAgB,UAAU,CAAC,IAAX,CAAgB,kBAAhB;UAChB,YAAY,CAAC,KAAb,CAAmB;mBACf,KAAC,WAAD,CAAY,YAAZ,EAA0B,SAAC,GAAD;cACtB,IAAG,WAAH;uBACI,KAAK,CAAC,KAAN,CAAY,EAAE,8BAAF,CAAZ,EADJ;eAAA;uBAGI,KAAC,KAAD,GAHJ;;YADsB,CAA1B;UADe,CAAnB;iBAOA,KAAC,IAAG,CAAC,IAAL,CAAU,aAAV,CAAwB,CAAC,MAAzB,CAAgC,UAAhC,EAjBJ;;MAJiB;IAAA,QAArB;EARG;;8BAgCP,aAAY,SAAC,OAAD,EAAU,QAAV;IACR,MAAM,CAAC,iBAAiB,CAAC,IAAzB;WAEA,KAAK,CAAC,UAAN,CAAiB,IAAC,WAAlB,EAA8B,SAAC,KAAD,EAAQ,EAAR;AAC1B;MAAA,KAAK,KAAK,CAAC,GAAN,CAAU,IAAV;MACL,OAAO,KAAK,CAAC,GAAN,CAAU,MAAV;aACP,MAAM,CAAC,GAAP,CAAc,IAAD,GAAM,IAAN,GAAU,EAAvB,EAA6B;QAAA,MAAM,OAAN;OAA7B,EAA4C,EAA5C;IAH0B,CAA9B,EAIE,SAAC,GAAD;MACE,MAAM,CAAC,iBAAiB,CAAC,IAAzB;aACA,SAAS,GAAT;IAFF,CAJF;EAHQ;;;;GAjGiC;;;;ACHjD;EAAA;;;AAAA,QAAQ,QAAQ,SAAR;;AACR,SAAS,QAAQ,eAAR;;AAET,MAAM,CAAC,OAAP,GAAuB;;;8BAEnB,mBAAkB;AACd;IAAA,gBAAgB,EAAE,gCAAF;AAChB,WAAO,qCAEC,CAAC,EAAE,yBAAF,EAA6B;MAAA,UAAU,IAAC,MAAK,CAAC,GAAP,CAAW,MAAX,CAAV;KAA7B,CAAD,CAFD,GAE2D,+CAF3D,GAI+B,aAJ/B,GAI6C;EANtC;;EAYL,2BAAC,KAAD,EAAS,QAAT;IAAC,IAAC,SAAD;IAAQ,IAAC,YAAD;IAClB,mDAAM,EAAE,uBAAF,CAAN,EAAkC,EAAlC,EACM,EAAE,4BAAF,CADN,EAEM,EAAE,2BAAF,CAFN,EAGM,IAAC,gBAHP;EADS;;8BAMb,kBAAiB,SAAC,OAAD;AACb;IAAA,iBAAiB,IAAC,EAAD,CAAG,iBAAH,CAAqB,CAAC,IAAtB,CAA2B,SAA3B;IACjB,IAA8B,cAA9B;MAAA,mBAAmB,QAAnB;;WACA,IAAC,SAAD,CAAU,OAAV,EAAmB,gBAAnB;EAHa;;8BAKjB,cAAa;IACT,IAAC,aAAD,GAAgB,EAAE,IAAC,iBAAD,EAAF;WAChB,IAAC,IAAG,CAAC,IAAL,CAAU,aAAV,CAAwB,CAAC,MAAzB,CAAgC,IAAC,aAAjC;EAFS;;;;GAzBgC;;;;ACHjD;EAAA;;;;;AAAA,WAAW,QAAQ,kBAAR;;AACX,QAAQ,QAAQ,SAAR;;AACR,SAAS,QAAQ,eAAR;;AACT,qBAAqB,QAAQ,iCAAR;;AAGrB,MAAM,CAAC,OAAP,GAAuB;;;;;;;;2BAGnB,SAAQ;WAAG,CAAC,CAAC,MAAF,CAAS,sDAAT,EACP;MAAA,oCAAoC;eAAA;UAChC,KAAC,EAAD,CAAG,uBAAH,CAA2B,CAAC,IAA5B;iBACA,KAAC,EAAD,CAAG,0BAAH,CAA8B,CAAC,IAA/B;QAFgC;MAAA,QAApC;KADO;EAAH;;2BAMR,aAAY,SAAC,OAAD;IACR,IAAC,KAAD,GAAQ,IAAC,MAAK,CAAC,GAAP,CAAW,MAAX;IACR;IACA,IAAC,cAAD,GAAiB;WACjB,MAAM,CAAC,GAAP,CAAW,eAAa,IAAC,MAAK,CAAC,EAA/B,EAAqC;aAAA,SAAC,GAAD,EAAM,IAAN;QACjC,IAAG,GAAH;iBACI,KAAK,CAAC,KAAN,CAAY,sBAAZ,EAAoC;mBAAG,KAAC,IAAG,CAAC,KAAL,CAAW,MAAX;UAAH,CAApC,EADJ;SAAA;UAGI,KAAC,UAAD,GAAa,IAAI,CAAC;UAElB,KAAC,aAAD,GAAgB,KAAC,UAAS,CAAC,MAAX,GAAoB;UAEpC,IAAiB,KAAC,mBAAD,EAAjB;YAAA,KAAC,WAAD;;iBAGA,KAAC,QAAD,GAVJ;;MADiC;IAAA,QAArC;EAJQ;;2BAkBZ,cAAa;IACT,IAAG,IAAC,KAAD,KAAS,QAAZ;aACI;QAAA,KAAK,eAAL;QACA,MAAM,gBADN;QADJ;KAAA;aAII;QAAA,KAAK,EAAE,aAAF,CAAL;QAJJ;;EADS;;2BAQb,kBAAiB,SAAC,IAAD;AACb;IAAA,QAAQ,IAAI,CAAC,QAAL,EAAe,CAAC,KAAhB,CAAsB,GAAtB,CAA2B;WACnC,mEAAU,aAAa,IAAC,cAAd;EAFG;;2BAKjB,gBAAe;AACX;IAAA,MAAM;IACN,IAAG,IAAC,aAAJ;MACI,IAAG,sBAAH;QACI,IAAG,IAAC,UAAU,GAAE,CAAC,SAAd,KAA2B,QAA9B;UACI,GAAG,CAAC,SAAJ,GAAgB,SADpB;SAAA;UAGI,SAAS;AACT;AAAA;;AACI;AAAA;;cAAA,MAAM,CAAC,IAAP,CAAY,KAAZ;AAAA;AADJ;UAEA,GAAG,CAAC,SAAJ,GAAgB,IAAC,yBAAD,CAA0B,MAA1B,EANpB;SADJ;OADJ;;AASA,WAAO;EAXI;;2BAcf,cAAa;IACT,IAAU,IAAC,aAAX;AAAA;;WACA;EAFS;;2BAKb,cAAa;AACT;IAAA;IAEA,IAAG,IAAC,aAAJ;MACI,IAAC,EAAD,CAAG,eAAH,CAAmB,CAAC,QAApB,CAA6B,SAA7B;MACA,IAAC,EAAD,CAAG,sBAAH,CAA0B,CAAC,IAA3B;MAEA,IAAG,IAAC,UAAU,GAAE,CAAC,SAAd,KAA2B,QAA9B;QACI,OAAO,EAAE,eAAF;QACP,IAAC,EAAD,CAAG,sBAAH,CAA0B,CAAC,KAA3B,CAAiC,EAAE,KAAF,CAAQ,CAAC,IAAT,CAAc,IAAd,CAAjC;QACA,EAAE,cAAF,CAAiB,CAAC,IAAlB;QACA,EAAE,cAAF,CAAiB,CAAC,IAAlB;QACA,EAAE,cAAF,CAAiB,CAAC,IAAlB,CAAuB,GAAvB,CAA2B,CAAC,IAA5B;QACA,EAAE,aAAF,CAAgB,CAAC,WAAjB,CAA6B,UAA7B;QACA,WAAW;iBACP,EAAE,aAAF,CAAgB,CAAC,KAAjB,EAAwB,CAAC,MAAzB;QADO,CAAX,EAEE,GAFF,EAPJ;OAAA;QAWI,OAAO,EAAE,eAAF;QACP,IAAC,EAAD,CAAG,sBAAH,CAA0B,CAAC,KAA3B,CAAiC,EAAE,KAAF,CAAQ,CAAC,IAAT,CAAc,IAAd,CAAjC;QACA,EAAE,cAAF,CAAiB,CAAC,IAAlB;QACA,EAAE,cAAF,CAAiB,CAAC,IAAlB;QACA,EAAE,cAAF,CAAiB,CAAC,IAAlB,CAAuB,GAAvB,CAA2B,CAAC,IAA5B;QACA,EAAE,cAAF,CAAiB,CAAC,IAAlB,CAAuB,GAAvB,CAA2B,CAAC,IAA5B,CAAiC,GAAjC,CAAqC,CAAC,IAAtC;QACA,EAAE,aAAF,CAAgB,CAAC,IAAjB,CAAsB,GAAtB,CAA0B,CAAC,IAA3B;QACA,EAAE,aAAF,CAAgB,CAAC,IAAjB,CAAsB,GAAtB,CAA0B,CAAC,IAA3B,CAAgC,GAAhC,CAAoC,CAAC,IAArC;QACA,EAAE,aAAF,CAAgB,CAAC,IAAjB;QACA,EAAE,SAAF,CAAY,CAAC,IAAb;QACA,EAAE,aAAF,CAAgB,CAAC,IAAjB,CAAsB,UAAtB,EAAkC,IAAlC,EArBJ;;MAuBA,EAAE,kBAAF,CAAqB,CAAC,IAAtB;MACA,EAAE,mBAAF,CAAsB,CAAC,IAAvB,CAA4B,EAAE,IAAF,CAA5B,EA5BJ;KAAA;MA+BI,YAAY;MACZ,UAAU;AAEV;AAAA;;cAA8B,MAAM,CAAC,SAAS,CAAC,MAAjB,KAA6B;;;QACvD,OAAO,EAAE,gBAAF,IAAsB,MAAM,CAAC;QACpC,SAAS,CAAC,IAAV,CAAe,EAAE,MAAF,CAAS,CAAC,QAAV,CAAmB,QAAnB,CAA4B,CAAC,IAA7B,CAAkC,IAAlC,CAAf;AACA;AAAA;;eAAkC,MAAM,CAAC;;;UACrC,OAAO,CAAC,IAAR,CAAa,IAAI,CAAC,KAAlB;UACA,SAAS,CAAC,IAAV,CAAe,EAAE,MAAF,CAAS,CAAC,IAAV,CAAe,IAAI,CAAC,KAApB,CAAf;AAFJ;AAHJ;MAOA,IAAG,OAAO,CAAC,MAAR,KAAoB,CAAvB;QACI,IAAC,cAAD,GAAiB;QACjB,OAAO,EAAE,kBAAF,IAAwB,IAAxB,GAA+B,OAAO,CAAC,IAAR,CAAa,IAAb,CAA/B,GAAoD;QAC3D,UAAU,EAAE,oCAAF,CAAuC,CAAC,IAAxC,CAA6C,IAA7C;QACV,OAAO,CAAC,MAAR,CAAe,EAAE,KAAF,CAAQ,CAAC,IAAT,CAAc,EAAE,SAAF,CAAd,CAAf;QACA,OAAO,EAAE,gCAAF,CAAmC,CAAC,IAApC;AACP;;UAAA,IAAI,CAAC,MAAL,CAAY,IAAZ;AAAA;QACA,IAAC,EAAD,CAAG,aAAH,CAAiB,CAAC,KAAlB,CAAwB,OAAxB,EAAiC,IAAjC,EAPJ;OAzCJ;;IAmDA,gBAAgB,CAAC,CAAC,SAAF,CAAY,IAAC,MAAK,CAAC,GAAP,CAAW,WAAX,CAAZ,EAAqC;MAAA,MAAM,IAAN;KAArC;IAChB,IAAG,aAAH;MACI,WAAW,EAAE,qCAAF;MACX,QAAQ,CAAC,IAAT,CAAc,SAAd,EAAyB,IAAC,MAAK,CAAC,GAAP,CAAW,oBAAX,CAAzB;MACA,OAAO,EAAE,cAAF;MACP,OAAO;MACP,QAAQ,EAAE,IAAF,CAAO,CAAC,MAAR,CAAe,QAAf,EAAyB,IAAzB;aACR,IAAC,EAAD,CAAG,aAAH,CAAiB,CAAC,KAAlB,CAAwB,KAAxB,EANJ;;EAvDS;;2BAiEb,WAAU;AACN;IAAA,qBAAqB,IAAC,EAAD,CAAG,SAAH,CAAa,CAAC,IAAd,CAAmB,SAAnB,KAAiC;WACtD,CAAC,CAAC,MAAF,CAAS,wDAAT,EAAgB;MAAA,oBAAoB,kBAApB;KAAhB;EAFM;;2BAIV,QAAO;IACH,IAAG,IAAC,aAAJ;aACI,IAAC,MAAD,GADJ;KAAA;aAGI,0CAHJ;;EADG;;2BAMP,OAAM;IACF,IAAG,IAAC,aAAJ;aACI,IAAC,MAAD,GADJ;KAAA;aAGI,yCAHJ;;EADE;;;;GAtIoC;;;;ACN9C;EAAA;;;AAAA,aAAa,QAAQ,UAAR;;AACb,SAAS,QAAQ,eAAR;;AAET,MAAM,CAAC,OAAP,GAAuB;;;;;;;6BAEnB,SAAQ;WAAG,CAAC,CAAC,MAAF,CAAS,wDAAT,EACP;MAAA,wBAAwB,6BAAxB;KADO;EAAH;;6BAIR,aAAY,SAAC,OAAD;IACR,iDAAM,OAAN;WACA,IAAC,WAAD,GAAc,OAAO,CAAC;EAFd;;6BAIZ,cAAa;AACT;IAAA;IAGA,UAAU;IACV,IAA4B,IAAC,WAAU,CAAC,SAAxC;MAAA,WAAW,cAAX;;WACA,IAAC,IAAG,CAAC,QAAL,CAAc,OAAd;EANS;;6BAQb,gBAAe;WACX,CAAC,CAAC,MAAF,CAAS,mDAAT,EACI;MAAA,UAAU,IAAV;MACA,yBAAyB,IAAC,WAAU,CAAC,0BADrC;MAEA,cAAc,IAAC,WAAU,CAAC,SAAS,CAAC,MAAtB,GAA+B,CAF7C;KADJ;EADW;;6BAOf,8BAA6B;AAGzB;IAAA,MAAM,MAAM,CAAC,QAAQ,CAAC;IACtB,MAAM,KAAE,CAAC,IAAC,MAAK,CAAC,OAAP,EAAD,CAAF,GAAsB,IAAC,WAAU,CAAC,EAAlC,GAAqC,gBAArC,GAAqD;IAG3D,IAAG,IAAC,WAAU,CAAC,0BAAf;MACI,IAAC,WAAU,CAAC,0BAAZ,GAAyC;MACzC,IAAC,EAAD,CAAG,gBAAH,CAAoB,CAAC,IAArB,CAA0B,QAA1B;MACA,IAAC,EAAD,CAAG,gBAAH,CAAoB,CAAC,IAArB,CAA0B,MAA1B;aACA,MAAM,CAAC,GAAP,CAAW,GAAX,EAAgB;QAAA,oBAAoB,KAApB;OAAhB,EAA2C;eAAA,SAAC,GAAD;UACvC,KAAC,EAAD,CAAG,gBAAH,CAAoB,CAAC,IAArB,CAA0B,KAA1B;UACA,IAAO,WAAP;YACI,KAAC,EAAD,CAAG,gBAAH,CAAoB,CAAC,IAArB,CAA0B,EAAE,wBAAF,CAA1B;mBACA,KAAC,EAAD,CAAG,gBAAH,CAAoB,CAAC,WAArB,CAAiC,SAAjC,EAFJ;;QAFuC;MAAA,QAA3C,EAJJ;KAAA;MAUI,IAAC,WAAU,CAAC,0BAAZ,GAAyC;MACzC,IAAC,EAAD,CAAG,gBAAH,CAAoB,CAAC,IAArB,CAA0B,QAA1B;MACA,IAAC,EAAD,CAAG,gBAAH,CAAoB,CAAC,IAArB,CAA0B,MAA1B;aACA,MAAM,CAAC,GAAP,CAAW,GAAX,EAAgB;QAAA,oBAAoB,IAApB;OAAhB,EAA0C;eAAA,SAAC,GAAD;UACtC,KAAC,EAAD,CAAG,gBAAH,CAAoB,CAAC,IAArB,CAA0B,KAA1B;UACA,IAAO,WAAP;YACI,KAAC,EAAD,CAAG,gBAAH,CAAoB,CAAC,IAArB,CAA0B,EAAE,uBAAF,CAA1B;mBACA,KAAC,EAAD,CAAG,gBAAH,CAAoB,CAAC,QAArB,CAA8B,SAA9B,EAFJ;;QAFsC;MAAA,QAA1C,EAbJ;;EAPyB;;;;GAzBe;;;CCHhD;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7BA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjEA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;AAAA;;ACAA;EAAA;;;AAAA,WAAW,QAAQ,kBAAR;;AACX,OAAO,QAAQ,gBAAR;;AACP,cAAc,QAAQ,wBAAR;;AAEd,MAAM,CAAC,OAAP,GAAuB;;;;;;;6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","file":"public/javascripts/app.js","sourcesContent":["FileCollection = require './collections/files'\nUploadQueue    = require './collections/upload_queue'\nFile           = require './models/file'\nSocketListener = require '../lib/socket'\nGallery        = require './views/gallery'\n\n###\nInitialize the model and start the actual code\n###\nmodule.exports =\n\n    initialize: ->\n\n        # if the application is browsed by a guest or not\n        # we use that in various places of the application (as few as possible)\n        @isPublic = window.location.pathname.indexOf('/public/') is 0\n\n        # the base collection holds all the files and folders of the application\n        # this collection is a local cache : the content of already visited\n        # folders will remain in this collection.\n        @baseCollection = new FileCollection()\n\n        # queue to allow new uploads while uploading\n        @uploadQueue = new UploadQueue @baseCollection\n\n        @socket = new SocketListener()\n        @socket.watch @baseCollection\n\n        Router = require 'router'\n        @router = new Router()\n\n        # Generate the root folder\n        # In shared area there are more properties because the root is an\n        # actual folder\n        if window.rootFolder?\n            @root = new File window.rootFolder\n            @root.canUpload = window.canUpload or false\n            @root.publicNotificationsEnabled = window.publicNofications or false\n            @root.publicKey = window.publicKey or \"\"\n        else\n            # Fake folder to describe the root\n            @root = new File\n                id: \"root\"\n                path: \"\"\n                name: t 'root folder name'\n                type: \"folder\"\n        @baseCollection.add @root\n        # for easy debugging in browser (and dirty tricks)\n        window.app = @\n\n        Backbone.history.start()\n\n        # prepare the photo gallery\n        window.app.gallery = new Gallery()\n\n        # Makes this object immuable.\n        Object.freeze this if typeof Object.freeze is 'function'\n\n        document.body.addEventListener 'click', (event) =>\n            if event.target.tagName is 'BODY'\n                @baseCollection.forEach (model) ->\n                    model.setSelectedViewState false\n\n","File = require '../models/file'\n\n###\nRepresents a collection of files\nIt acts as the cache when instantiate as the baseCollection\nThe base collection holds ALL the files and folders of the application\nIt creates projections (subcollection) that will be consumed by folder views.\nThose projections represents one folder.\n###\nmodule.exports = class FileCollection extends Backbone.Collection\n\n    # Model that will be contained inside the collection.\n    model: File\n\n    # This is where ajax requests the backend.\n    url: 'files'\n\n    cachedPaths: []\n\n    isPathCached: (path) -> @cachedPaths.indexOf(path) isnt -1\n\n    ###\n        Retrieves folder's information (meta data)\n        * from memory if it's cached\n        * otherwise, from server\n    ###\n    getFolderInfo: (folderID, callback) ->\n        folder = @get folderID\n        unless folder?\n            #console.log \"fetch folder info\"\n            folder = new File id: folderID, type: \"folder\"\n            folder.fetch\n                success: =>\n                    @add folder\n                    callback null, folder\n                error: (xhr, resp) ->\n                    callback status: resp.status, msg: resp.statusText\n        else\n            #console.log \"[cache] fetch folder info\"\n            callback null, folder\n\n    # Retrieves folder's content (files and folders in it)\n    getFolderContent: (folder, callback = ->) ->\n        path = folder.getRepository()\n        folder.fetchContent (err, content, parents) =>\n            if err?\n                callback err\n            else\n                @set content, remove: false, sort: false\n\n                # we handle deletion manually because\n                # they must be based on  projection, not baseCollection\n                contentIDs = _.pluck content, 'id'\n                path = folder.getRepository()\n                itemsToRemove = @getSubCollection(path).filter (item) ->\n                    return item.get('id') not in contentIDs\n                @remove itemsToRemove\n\n                # we mark as cached the folder if it's the first time we load\n                # its content\n                @cachedPaths.push path unless @isPathCached path\n\n                callback()\n\n    ###\n        Global method to retrieve folder's info and content\n        and create a subcollection (projection) based on the current collection\n    ###\n    getByFolder: (folderID, callback) ->\n        @getFolderInfo folderID, (err, folder) =>\n            if err? then callback err\n            else\n                path = folder.getRepository()\n                filter = (file) ->\n                    file.get('path') is path and not file.isRoot()\n\n                collection = new BackboneProjections.Filtered @,\n                                    filter: filter\n                                    comparator: @comparator\n\n                if @isPathCached path\n                    #console.log \"[cache] fetch folder content\"\n                    callback null, folder, collection\n                else\n                    # we retrieve at the same time the folder's content\n                    # and the folder's breadcrumb\n                    @getFolderContent folder, ->\n                        callback null, folder, collection\n\n    existingPaths: ->\n        return @map (model) -> model.getRepository()\n\n\n    # Creates a sub collection (projection) based on the current collection\n    getSubCollection: (path) ->\n        filter = (file) ->\n            return file.get('path') is path and not file.isRoot()\n        return new BackboneProjections.Filtered @,\n                            filter: filter\n                            comparator: @comparator\n\n\n    comparator: (f1, f2) ->\n        # default values\n        @type = 'name' unless @type?\n        @order = 'asc' unless @order?\n\n        t1 = f1.get 'type'\n        t2 = f2.get 'type'\n\n        # new folders should be at the topmost\n        if f1.isFolder() and not f2.isFolder() and f1.isNew() then return -1\n        if f2.isFolder() and not f1.isFolder() and f2.isNew() then return 1\n\n        if @type is 'name'\n            n1 = f1.get('name').toLocaleLowerCase()\n            n2 = f2.get('name').toLocaleLowerCase()\n        else if @type is \"lastModification\"\n            n1 = new Date(f1.get 'lastModification').getTime()\n            n2 = new Date(f2.get 'lastModification').getTime()\n        else\n            n1 = f1.get @type\n            n2 = f2.get @type\n\n        sort = if @order is 'asc' then -1 else 1\n\n        if t1 is t2\n            if @type is 'class' and n1 is n2\n\n                # Sort by name if the class is the same\n                n1 = f1.get('name').toLocaleLowerCase()\n                n2 = f2.get('name').toLocaleLowerCase()\n\n                # Get both file extensions\n                e1 = n1.split('.').pop()\n                e2 = n2.split('.').pop()\n\n                if e1 isnt e2\n                    # Sort by file extension if they are different\n                    if e1 > e2 then return -sort\n                    if e1 < e2 then return sort\n                    return 0\n\n            # Sort normally\n            if n1 > n2 then return -sort\n            else if n1 < n2 then return sort\n            else return 0\n\n        else if t1 is 'file' and t2 is 'folder'\n            return 1\n        else # t1 is 'folder' and t2 is 'file'\n            return -1\n\n\n    # Returns an existing model if a file with a similar id or a similar\n    # location (path + name) is already in the queue.\n    isFileStored: (model) ->\n\n        # first check by id\n        existingFile = @get model.get('id')\n        unless existingFile?\n\n            # then check by full path\n            path = model.getRepository()\n            models = @filter (currentModel) ->\n                return currentModel.getRepository() is path\n\n            existingFile = models[0] if models.length > 0\n\n        return existingFile or null\n\n","File    = require '../models/file'\nHelpers = require '../lib/folder_helpers'\n\n# the uploadQueue is a mix of async.queue & BackoneCollection\n# blobs are added to the queue & to the collection\n# on upload success, File Models are marked as loaded\n# on\n\nmodule.exports = class UploadQueue\n\n    # number of files actually loaded\n    loaded: 0\n\n    # list of paths where files are being uploaded\n    uploadingPaths: {}\n\n\n    constructor: (@baseCollection) ->\n\n        # Create a collection for elements to be processed by the queue. This\n        # information is not based on the base collection for performance\n        # reasons (it doesn't have to be updated each time a big folder is\n        # loaded.)\n        @uploadCollection = new Backbone.Collection()\n\n\n        # Backbone.Events is a mixin, not a \"class\" you can extend.\n        _.extend @, Backbone.Events\n\n        @asyncQueue = async.queue @uploadWorker, 5\n        @listenTo @uploadCollection, 'sync error', @onSyncError\n        @listenTo @uploadCollection, 'progress', _.throttle =>\n            @trigger 'upload-progress', @computeProgress()\n        , 100\n\n        @asyncQueue.drain = @completeUpload.bind @\n\n\n    reset: ->\n        # sets the progress to 0% so next upload initial progress is 0% instead\n        # of 100%\n        @progress =\n            loadedBytes: 0\n            totalBytes: @sumProp 'total'\n\n        window.pendingOperations.upload = 0\n\n        @completed = false\n        @uploadingPaths = {}\n\n        # Copy the collection because resetStatus triggers `change` events which\n        # updates the uploadCollection, resulting in elements not being\n        # processed by the loop (the iterator breaks).\n        collection = @uploadCollection.toArray()\n        collection.forEach (model) =>\n            @uploadCollection.remove model\n            model.resetStatus()\n\n        @trigger 'reset'\n\n    # Handle request's abort\n    abort: (model) =>\n        model.uploadXhrRequest.abort()\n        @remove model\n        if model.isNew() then model.destroy()\n\n\n    # Remove a model from the upload queue\n    remove: (model) ->\n        model.resetStatus()\n        window.pendingOperations.upload--\n\n\n    # Add a model to the upload queue\n    add: (model) ->\n\n        window.pendingOperations.upload++\n\n        # don't override conflict status\n        model.markAsUploading() unless model.isConflict()\n\n        # Add the model to the base collection so it can be added in the list.\n        @baseCollection.add model\n\n        # Add the model to the upload queue so it can be processed.\n        @uploadCollection.add model\n\n        # Files at the end, folders at the beginning\n        if model.get('type') is 'file'\n\n            # we add the conflictual models at the end so the upload\n            # can start without waiting for user input.\n            if model.isConflict()\n                @asyncQueue.push model\n            else\n                @asyncQueue.unshift model\n\n        else if model.get('type') is 'folder'\n            @asyncQueue.unshift model\n        else\n            throw new Error('adding wrong typed model to upload queue')\n\n\n    # Reset variables and trigger completion events.\n    completeUpload: =>\n        window.pendingOperations.upload = 0\n        @completed = true\n        @trigger 'upload-complete'\n\n\n    # When an upload completes or fails, we keep counts.\n    onSyncError: (model) =>\n        path = model.get('path') + '/'\n        @uploadingPaths[path]--\n\n\n    # Process each element from the queue\n    uploadWorker: (model, next) =>\n        # Skip if there is an error.\n        if model.error\n            setTimeout next, 10\n\n        # If there is a conflict, the queue waits for the user to\n        # make a decision.\n        else if model.isConflict()\n            # Wait for user input through conflict resolution modal if it's not\n            # already done.\n            unless model.overwrite?\n                # The bind() method creates a new function that, when called,\n                # has its 'this' keyword set to the provided value\n                # (first argument), with a given sequence of arguments\n                # preceeding any provided when the new function is called.\n                model.processOverwrite = @_decideOn.bind @, model, next\n\n            # Or process the item if the user has made a choice.\n            else\n                @_decideOn model, next, model.overwrite\n\n        # Otherwise, the upload starts directly.\n        else\n            @_processSave model, next\n\n\n    # In case of conflict, change the queue based on user choice.\n    _decideOn: (model, done, choice) ->\n        # Mark the model as being overwritten (or not) so it knows during upload\n        # if it must tell the server to overwrite (or not).\n        model.overwrite = choice\n        if choice\n            model.markAsUploading()\n            @_processSave model, done\n        else\n            model.resetStatus()\n            @remove model\n            done()\n\n\n    # Perform the actual persistence by saving the model and changing\n    # uploadStatus based on response. If there is an unexpected error, it tries\n    # again 3 times before failing.\n    _processSave: (model, done) ->\n\n        # double check that we don't try to upload something we know will fail\n        if not model.isConflict() and not model.isErrored()\n            model.save null,\n                success: (model) =>\n                    model.file = null\n                    # To make sure progress is uniform, we force it at 100%.\n                    model.loaded = model.total\n                    model.markAsUploaded()\n\n                    # Update the upload paths so folders now when they don't\n                    # have upload inside them anymore.\n                    @unmarkPathAsUploading model\n\n                    done null\n                error: (_, err) =>\n                    model.file = null\n                    body = try JSON.parse(err.responseText)\n                    catch e then msg: null\n\n                    # This case may occur when two clients upload a file\n                    # with the same name at the same time in the same\n                    # folder. It can also accur when uploading an existing\n                    # folder.\n                    if err.status is 400 and body.code is 'EEXISTS'\n                        model.markAsErrored body\n\n                    else if err.status is 400 and body.code is 'ESTORAGE'\n                        model.markAsErrored body\n\n                    else if err.status is 0 and err.statusText is 'error'\n                        # abort by user, don't try again\n\n                    # Retry if an unexpected error occurs\n                    else\n                        model.tries = 1 + (model.tries or 0)\n                        if model.tries > 3\n                            defaultMessage = \"modal error file upload\"\n                            model.error = t err.msg or defaultMessage\n                            errorKey = err.msg or defaultMessage\n                            error = t errorKey\n                            model.markAsErrored error\n                        else\n                            # let's try again\n                            @asyncQueue.push model\n\n                    done()\n        else\n            done()\n\n\n    addBlobs: (blobs, folder) ->\n        @reset() if @completed\n\n        i = 0\n        existingPaths = app.baseCollection.existingPaths()\n        # we do a non blocking loop, handling one file every 2ms so the\n        # UI don't get stuck\n        do nonBlockingLoop = =>\n            return unless blob = blobs[i++]\n\n            path = folder.getRepository() or ''\n            relPath = blob.relativePath or\n                blob.mozRelativePath or\n                blob.webkitRelativePath or\n                blob.msRelativePath\n\n            # Adds sub folder in the path if it's uploaded by a parent folder\n            if relPath and (subDir = Helpers.dirName relPath).length > 0\n                path += \"/#{subDir}\"\n\n            model = new File\n                type: 'file'\n                class: 'document'\n                size: blob.size\n                name: blob.name\n                path: path\n                lastModification: blob.lastModifiedDate\n\n            model.file = blob\n            model.loaded = 0\n            model.total = blob.size\n\n            # In Firefox, folders are empty files without mime type, so an error\n            # is triggered to the user.\n            # In all browsers, empty files without a mime type are unfortunately\n            # caught by this condition, resulting in an error. See #209.\n            if blob.size is 0 and blob.type.length is 0\n\n                # The element should not be added to the queue\n                model = null\n\n                # Let the view know something went wrong.\n                @trigger 'folderError'\n\n            # mark as in conflict with existing file\n            else if (existingModel = @isFileStored(model))?\n\n                # if the model is currently in the upload process (except if\n                # it's been successfully uploaded), it's not added.\n                if not existingModel.inUploadCycle() or existingModel.isUploaded()\n                    # update data\n                    existingModel.set\n                        size: blob.size\n                        lastModification: blob.lastModifiedDate\n\n                    existingModel.file = blob\n                    existingModel.loaded = 0\n                    existingModel.total = blob.size\n\n                    model = existingModel\n\n                    model.markAsConflict()\n                    @trigger 'conflict', model\n                else\n                    # Prevent the file from being added to the queue.\n                    model = null\n\n\n            if model?\n                @add model\n                @markPathAsUploading model\n\n            setTimeout nonBlockingLoop, 2\n\n\n    addFolderBlobs: (blobs, parent) ->\n        @reset() if @completed\n\n        dirs = Helpers.nestedDirs blobs\n        i = 0\n        isConflict = false\n        do nonBlockingLoop = =>\n\n            # if no more folders to add, leave the loop\n            dir = dirs[i++]\n            unless dir\n\n                # Only add the files if there are no conflict.\n                unless isConflict\n                    # Folders will be created, files can safely be added at the\n                    # end of the queue.\n                    blobs = _.filter blobs, (blob) ->\n                        return blob.name not in ['.', '..']\n                    @addBlobs blobs, parent\n\n            else\n                prefix = parent.getRepository()\n                parts = Helpers.getFolderPathParts dir\n                name = parts[parts.length - 1]\n                path = [prefix].concat(parts[...-1]).join '/'\n\n                folder = new File\n                    type: \"folder\"\n                    name: name\n                    path: path\n\n                folder.loaded = 0\n                folder.total = 250 # ~ size of the query\n\n                # If the folder already exists, nothing is done because\n                # the overwrite management is not good in that case.\n                if (existingModel = @isFileStored(folder))?\n                    # This will end the nonBlockingLoop.\n                    i = dirs.length\n                    isConflict = true\n                    @trigger 'existingFolderError', existingModel\n                else\n                    # Add folder to be saved to the queue.\n                    @add folder\n                    @markPathAsUploading folder\n\n                setTimeout nonBlockingLoop, 2\n\n\n    # Export usable stats about the upload\n    getResults: ->\n        errorList = []\n        existingList = []\n        success = 0\n\n        @uploadCollection.each (model) ->\n            if model.isErrored()\n                error = model.error\n                if error?.code is 'EEXISTS'\n                    existingList.push model\n                else\n                    errorList.push model\n\n                console.log \"Upload Error\", model.getRepository(), error\n            else\n                success++\n\n        status = if errorList.length then 'error'\n        else if existingList.length then 'warning'\n        else 'success'\n\n        return {status, errorList, existingList, success}\n\n\n    # Keep track of models being uploaded by path.\n    markPathAsUploading: (model) ->\n        # Appending a / prevents conflict with elements\n        # having the same prefix in their names.\n        path = \"#{model.get 'path'}/\"\n        unless @uploadingPaths[path]?\n            @uploadingPaths[path] = 0\n\n        @uploadingPaths[path]++\n\n\n    # Remove the mark on the folder.\n    unmarkPathAsUploading: (model) ->\n        # Appending a / prevents conflict with elements\n        # having the same prefix in their names.\n        path = \"#{model.get 'path'}/\"\n\n        @uploadingPaths[path]--\n\n\n    # Return the number of children elements being uploading for a given path\n    getNumUploadingElementsByPath: (path) ->\n        # appending a / prevents conflict with elements\n        # having the same prefix in their names\n        path = \"#{path}/\"\n\n        return _.reduce @uploadingPaths, (memo, value, index) ->\n            if index.indexOf(path) isnt -1 or path is ''\n                return memo + value\n            else\n                return memo\n        , 0\n\n\n    # Recalculate progress\n    computeProgress: =>\n        return @progress =\n            loadedBytes: @sumProp 'loaded'\n            totalBytes: @sumProp 'total'\n\n\n    # Add all values for a given property.\n    sumProp: (prop) =>\n        iter = (sum, model) -> return sum + model[prop]\n        return @uploadCollection.reduce iter, 0\n\n\n    # Returns an existing model if a file with a similar id or a similar\n    # location (path + name) is already in the queue.\n    isFileStored: (model) ->\n        return @baseCollection.isFileStored model\n","app = require 'application'\n\n$ ->\n    jQuery.event.props.push 'dataTransfer'\n\n    if window.domain is \"false\"\n        app.domain = \"#{window.location.origin}/public/files/\"\n    else\n        app.domain = window.domain\n\n    locale = window.locale or \"en\" # default locale\n    moment.lang locale\n\n    locales = {}\n    try\n        locales = require \"locales/#{locale}\"\n    catch err\n        locales = require \"locales/en\"\n\n    polyglot = new Polyglot()\n\n    # we give polyglot the data\n    polyglot.extend locales\n\n    # handy shortcut\n    window.t = polyglot.t.bind polyglot\n\n    # init plugins\n    require(\"./utils/plugin_utils\").init()\n\n    # keeps count of operations in progress\n    window.pendingOperations =\n        upload: 0\n        move: 0\n        deletion: 0\n\n    # launch the app\n    app.initialize()\n\n# Asks the user if he tries to reload the page while an operation is in progress\nwindow.onbeforeunload = ->\n\n    values = _.values window.pendingOperations\n    sum = (a, b) -> a + b\n    pendingOperationsNum = _.reduce values, sum, 0\n    if pendingOperationsNum > 0\n        return t 'confirmation reload'\n\n","module.exports = class BaseView extends Backbone.View\n\n    template: ->\n\n    initialize: ->\n\n    getRenderData: ->\n        model: @model?.toJSON()\n\n    render: ->\n        @beforeRender()\n        @$el.html @template @getRenderData()\n        @afterRender()\n        return @\n\n    beforeRender: ->\n\n    afterRender: ->\n\n    destroy: -> @remove()\n","# Make ajax request more easy to do.\nexports.request = (type, url, data, callback) ->\n    $.ajax\n        type: type\n        url: url\n        data: if data? then JSON.stringify data else null\n        contentType: \"application/json\"\n        dataType: \"json\"\n        success: (data) ->\n            callback null, data if callback?\n        error: (data) ->\n            if data.status in [200, 201, 204, 304]\n                callback null, data if callback?\n            else if data? and data.msg? and callback?\n                callback new Error data.msg\n            else if callback?\n                callback new Error \"Server error occured\"\n\n# Sends a get request with data as body\n# Expected callbacks: success and error\nexports.get = (url, callbacks) ->\n    exports.request \"GET\", url, null, callbacks\n\n# Sends a post request with data as body\n# Expected callbacks: success and error\nexports.post = (url, data, callbacks) ->\n    exports.request \"POST\", url, data, callbacks\n\n# Sends a put request with data as body\n# Expected callbacks: success and error\nexports.put = (url, data, callbacks) ->\n    exports.request \"PUT\", url, data, callbacks\n\n# Sends a delete request with data as body\n# Expected callbacks: success and error\nexports.del = (url, callbacks) ->\n    exports.request \"DELETE\", url, null, callbacks\n","module.exports =\n\nremoveTralingSlash: (path) ->\n    if path.slice(-1) is '/'\n        return path.slice(0, -1)\n    return path\n\ndirName: (path) ->\n    return path.split('/')[...-1].join('/')\n\n\ngetFolderPathParts: (path) ->\n    return path.split('/').filter (x) -> x # remove empty last part\n\nnestedDirs: (fileList) ->\n\n    # list of folders to create\n    dirs = []\n\n    # cache the key of folders to prevent useless loops\n    addedPath = []\n\n    # make an object with keys paths, values nest level\n    # from each files we build the tree to recreate it\n    for file in fileList\n        relPath = file.relativePath or file.mozRelativePath or file.webkitRelativePath\n        parents = relPath.slice(0, relPath.lastIndexOf(file.name))\n\n        # get an array of the folders making the file path\n        foldersOfPath = parents.split('/')[...-1]\n        while foldersOfPath.length > 0\n            parent = foldersOfPath.join '/'\n            if not (parent in addedPath)\n                dirs.push path: parent, depth: foldersOfPath.length\n                addedPath.push parent\n                foldersOfPath.pop()\n            else\n                break\n\n    # put them in a list, sorted by nest level\n    dirs.sort (a, b) ->\n        return a.depth - b.depth\n\n    return (dir.path for dir in dirs)\n","################################################################################\n# -- USAGE --\n#\n#   # creation :\n#\n#\n#       viewportElement = $('.longListViewport')[0] # the viewport element\n#\n#       options =\n#           # unit used for the dimensions (px,em or rem)\n#           DIMENSIONS_UNIT   : 'em'\n#\n#           # Height reserved for each row (unit defined by DIMENSIONS_UNIT)\n#           ROW_HEIGHT        : 2\n#\n#           # number of \"screens\" before and after the viewport in the buffer.\n#           # (ex : 1.5 => 1+2*1.5=4 screens always ready)\n#           BUFFER_COEF       : 3\n#\n#           # number of \"screens\" before and after the viewport corresponding to\n#           # the safe zone. The Safe Zone is the rows where viewport can go\n#           # without trigering the movement of the buffer.\n#           # Must be smaller than BUFFER_COEF\n#           SAFE_ZONE_COEF    : 2\n#\n#           # minimum duration between two refresh after scroll (ms)\n#           THROTTLE          : 450\n#\n#           # max number of viewport height by seconds : beyond this speed the\n#           # refresh is delayed to the next throttle\n#           MAX_SPEED         : 1.5\n#\n#           # call back when a row of the buffer is moved and must be completly\n#           # redecorated\n#           onRowsMovedCB     : (rowsToDecorate)->\n#               # rowsToDecorate  : [ {rank:Integer, el:Element} , ... ]\n#               # Array of objects giving the rank and a reference to the\n#               # element of the moved row.\n#               # The array is sorted in order to optimize refresh (the most\n#               # usefull to refresh is the first one)\n#\n#           # [optional] call back when a row of the buffer is created (the\n#           first decoration might differ from others). If not provided,\n#           onRowsMovedCB will be called instead.\n#           onRowsCreatedCB   : (rowsToDecorate)->\n#               # rowsToDecorate  : [ {rank:Integer, el:Element} , ... ]\n#               # Array of objects giving the rank and a reference to the\n#               # element of the moved row.\n#               # The array is sorted in order to optimize refresh (the most\n#               # usefull to refresh is the first one)\n#\n#\n#\n#       longList = new LongListRows(viewportElement, options)\n#       doActions() ...\n#\n#\n#   # if the the viewportElement is not initialy attached in the DOM, then call\n#   resizeHandler when the viewportElement is attached :\n#       longList.resizeHandler()\n#\n#   # to add initial new rows\n#   # if some are already in, they will be removed\n#       longList.initRows(nToAdd)\n#\n#   # when the height of the viewportElement changes :\n#       longList.resizeHandler()\n#\n#   # to add a row\n#       longList.addRow(fromRank)\n#\n#   # to remove a block of rows\n#       longList.removeRows(rankOrElement, nToRemove)\n#\n#   # to remove one row\n#       longList.removeRow(rankOrElement)\n#\n#   # to remove all rows\n#       longList.removeAllRows()\n#\n#   # to get the element corresponding to a rank (null if the rank is not in the\n#   # DOM)\n#       longList.getRowElementAt(rank)\n#\n#   # To get elements of rows of the buffer after a certain rank.\n#   # Returns an empty array if the rank is after the buffer.\n#       getRowsAfter(rank)\n\n\nmodule.exports = class LongListRows\n\n################################################################################\n## PUBLIC SECTION ##\n#\n\n    constructor: (@externalViewport$, @options ) ->\n        @options.MAX_SPEED = @options.MAX_SPEED  * @options.THROTTLE / 1000\n        @onRowsMovedCB     = @options.onRowsMovedCB\n        if @options.onRowsCreatedCB\n            @onRowsCreatedCB   = @options.onRowsCreatedCB\n        else\n            @onRowsCreatedCB   = @options.onRowsMovedCB\n        ####\n        # get elements (name ends with '$')\n        @viewport$ = document.createElement('div')\n        @viewport$.classList.add('viewport')\n        @externalViewport$.appendChild(@viewport$)\n        @rows$ = document.createElement('div')\n        @rows$.classList.add('rows')\n        @rows$.style.cssText = \"padding-top: 0px; box-sizing: border-box;\"\n        @viewport$.appendChild(@rows$)\n        ####\n        # set viewport style\n        @externalViewport$.style.display = 'flex'\n        @viewport$.style.cssText = \"flex: 1 1 0%;\n            position: relative;\n            overflow-x: hidden;\n            overflow-y: auto;\"\n        ####\n        # adapt buffer to the initial geometry\n        @_DOM_controlerInit()\n\n\n    # if some are already in, they will be removed. Will call onRowsMovedCB.\n    # ! note : your data describing rows state must be updated before calling\n    # this method, because onRowsMovedCB might be called => the data must be\n    # up to date when redecoration will occur.\n    initRows: (nToAdd) ->\n        ##\n        # remove all rows of the buffer\n        @_initBuffer()\n        # the buffer is empty, initialise it\n        @_firstPopulateBuffer(nToAdd)\n\n\n    # To add new rows. Might call onRowsMovedCB.\n    # ! note : your data describing rows state must be updated before calling\n    # this method, because onRowsMovedCB might be called => the data must be\n    # up to date when redecoration will occur.\n    # addRows: (fromRank, nToAdd) ->\n    #     @_addRows(fromRank, nToAdd)\n\n\n    # to add a new row. Might call onRowsMovedCB.\n    # ! note : your data describing rows state must be updated before calling\n    # this method, because onRowsMovedCB might be called => the data must be\n    # up to date when redecoration will occur.\n    addRow: (fromRank) ->\n        @_addRow(fromRank)\n\n\n    # to remove one row. Might call onRowsMovedCB.\n    # rankOrElement can be an integer or the element of the row to delete.\n    # ! note : your data describing rows state must be updated before calling\n    # this method, because onRowsMovedCB might be called => the data must be\n    # up to date when redecoration will occur.\n    removeRow: (rankOrElement) ->\n        @_removeRows(rankOrElement, 1)\n\n\n    # to remove some lines. Might call onRowsMovedCB.\n    # rankOrElement can be an integer or the element of the first row to delete.\n    # ! note : your data describing rows state must be updated before calling\n    # this method, because onRowsMovedCB might be called => the data must be\n    # up to date when redecoration will occur.\n    removeRows: (rankOrElement, nToRemove) ->\n        @_removeRows(rankOrElement, nToRemove)\n\n    # to remove all lines. Might call onRowsMovedCB.\n    # ! note : your data describing rows state must be updated before calling\n    # this method, because onRowsMovedCB might be called => the data must be\n    # up to date when redecoration will occur.\n    removeAllRows: () ->\n        ##\n        # remove all rows of the buffer\n        @_initBuffer()\n\n    # retuns the element corresponding to the row of the given rank or undefined\n    # if this row is outside the buffer.\n    getRowElementAt: (rank) ->\n        row = @_getRowAt(rank)\n        if row\n            return row.el\n        else\n            return undefined\n\n    ###*\n         * return the current number of rows\n     * @return {Number} Number of rows\n    ###\n    getLength: () ->\n\n\n    ###*\n     * get elements of rows of the buffer after a certain rank. Returns an empty\n     * array if the rank is after the buffer.\n     * @return {Array} [{rank:Integer, el:Element}, ...]\n    ###\n    getRowsAfter: () ->\n\n\n\n    ###*\n     * Methodes for tests, are defined in _DOM_controlerInit\n    ###\n    _test:\n        goDownHalfBuffer:null\n        goUpHalfBuffer:null\n        getState:null\n        getInternals:null\n        unActivateScrollListener:null\n        activateScrollListener:null\n\n\n\n################################################################################\n## PRIVATE SECTION ##\n\n\n\n\n    ###*\n     * This is the main procedure. Its scope contains all the functions used to\n     * update the buffer and the shared variables between those functions. This\n     * approach has been chosen for performance reasons (acces to scope\n     * variables faster than to nested properties of objects). It's not an\n     * obvious choice.\n    ###\n    _DOM_controlerInit: () ->\n        #######################\n        # global variables\n        buffer                = null\n        noScrollScheduled     = true\n        previousHeight        = null\n        rowHeight             = null\n        nMaxRowsInBufr        = null # theorical, buffer.nRows is the actual\n        nRowsInBufrMargin     = null\n        nRowsInSafeZoneMargin = null\n        nRowsInSafeZone       = null\n        nRowsInViewport       = null\n        VP_firstRk            = null\n        VP_lastRk             = null\n        isDynamic             = false # true if more rows than elemts in buffer\n        viewportHeight        = null\n        lastOnScroll_Y        = null\n        current_scrollTop     = null\n        nRows                 = 0    # number of rows of the long list\n        safeZone =\n            startY         : null\n            endY           : null\n            firstVisibleRk : null\n        # unit used for the dimensions (px,em or rem)\n        DIMENSIONS_UNIT = @options.DIMENSIONS_UNIT\n        # Height reserved for each row (unit defined by DIMENSIONS_UNIT)\n        ROW_HEIGHT     = @options.ROW_HEIGHT\n        # number of \"screens\" before and after the viewport in the buffer.\n        # (ex: 1.5 => 1+2*1.5=4 screens always ready)\n        BUFFER_COEF   = @options.BUFFER_COEF\n        # number of \"screens\" before and after the viewport corresponding to\n        # the safe zone. The Safe Zone is the lines where viewport can go\n        # without trigering the movement of the buffer.\n        # Must be smaller than BUFFER_COEF\n        SAFE_ZONE_COEF  = @options.SAFE_ZONE_COEF\n        # minimum duration between two refresh after scroll (ms)\n        THROTTLE        = @options.THROTTLE\n        # n = max number of viewport height by seconds : beyond this speed the\n        # refresh is delayed to the nex throttle\n        MAX_SPEED       = @options.MAX_SPEED\n\n\n\n        _scrollHandler = (e) =>\n            if noScrollScheduled and isDynamic\n                lastOnScroll_Y = @viewport$.scrollTop\n                setTimeout(_moveBuffer,THROTTLE)\n                noScrollScheduled = false\n\n\n\n        @_scrollHandler = _scrollHandler\n\n\n\n        ###*\n         * returns the font-size in px of a given element (context) or of the\n         * root element of the document if no context is provided.\n         * @param  {element} context Optionnal: an elemment to get the font-size\n         * @return {integer} the font-size\n        ###\n        _getElementFontSize = ( context )->\n            # Returns a number of the computed font-size, so in px\n            # for the given context\n            # or the root <html> element\n            return parseFloat(\n                getComputedStyle( context or document.documentElement ).fontSize\n            )\n\n\n        _remToPixels=(value)->\n            return _emToPixels(value)\n\n\n\n        _emToPixels=(value, context)->\n            return Math.round(value * _getElementFontSize(context))\n\n\n\n        _getDimInPixels = (value)=>\n            switch DIMENSIONS_UNIT\n                when 'px'\n                    return value\n                when 'em'\n                    return _emToPixels(value, @viewport$)\n                when 'rem'\n                    return _remToPixels(value)\n\n\n\n        ###*\n         * called once for all during _DOM_controlerInit\n         * computes the static parameters of the geometry\n        ###\n        _getStaticDimensions = () =>\n            rowHeight         = _getDimInPixels(ROW_HEIGHT)\n\n\n\n        ###*\n         * Compute all the geometry after a resize or when the list in inserted\n         * in the DOM.\n         * _moveBuffer will be executed at the end except if the viewport has\n         * no height (if not inserted in the dom for instance) or there is no\n         * row\n        ###\n        _resizeHandler= ()=>\n            # get dimensions.\n            viewportHeight = @viewport$.clientHeight\n\n            # the viewport has no height : geometry can not be computed\n            # except if some initial width and height has been given\n            if viewportHeight <= 0\n                if @initialHeight\n                    viewportHeight = @initialHeight\n                else\n                    return false\n\n            # if the height of viewport has not change, we can directly adapt\n            # buffer\n            if viewportHeight == previousHeight and nRows != 0\n                _moveBuffer()\n                return\n            previousHeight  = viewportHeight\n\n            # compute the theorical buffer (theorical because there might not\n            # need of such a buffer if there is not many rows added)\n            nRowsInViewport   = Math.ceil(viewportHeight/rowHeight)\n            nRowsInBufrMargin = Math.round(BUFFER_COEF * nRowsInViewport)\n            nMaxRowsInBufr       = nRowsInViewport + nRowsInBufrMargin*2\n\n            # compute the safe zone\n            nRowsInSafeZoneMargin = Math.round(SAFE_ZONE_COEF * nRowsInViewport)\n            nRowsInSafeZone       = nRowsInViewport + nRowsInSafeZoneMargin*2\n\n            # check there are enough rows to fill the buffer\n            if nRows <= nMaxRowsInBufr\n                isDynamic = false\n            else\n                isDynamic = true\n\n            # check if there are some rows of the buffer to create or delete\n            if buffer\n                deltaRows = Math.min(nRows,nMaxRowsInBufr) - buffer.nRows\n                if deltaRows < 0\n                    # delete deltaRows (arbitrary at the bottom of the buffer)\n                    _deleteBufferRows(-deltaRows)\n                else if deltaRows > 0\n                    # create deltaRows (arbitrary at the bottom of the buffer)\n                    _addBufferRows(deltaRows)\n\n            if nRows != 0\n                _moveBuffer()\n\n        @resizeHandler = _resizeHandler\n\n\n        _deleteBufferRows = (nToDelete)=>\n            currentRow = buffer.last\n            index = nToDelete - 1\n            nDeleted = 1\n            loop\n                console.log nDeleted\n                @rows$.removeChild(currentRow.el)\n                nDeleted++\n                currentRow = currentRow.next\n                break unless index--\n            buffer.last       = currentRow\n            buffer.lastRk    -= nToDelete\n            buffer.first.next =   currentRow\n            currentRow.prev   = buffer.first\n            buffer.nRows     -= nToDelete\n\n        ###*\n         * @param {Integer} add nToAdd rows at the bottom of the buffer\n         *     {Row}:\n         *          prev : {Row}\n         *          next : {Row}\n         *          el   : {Element}\n         *          rank : {Integer}\n        ###\n        _addBufferRows = (nToAdd)=>\n            rowsToDecorate = []\n            startRk = buffer.lastRk\n            prevCreatedRow = buffer.last\n            for n in [1..nToAdd] by 1\n                row$ = document.createElement('li')\n                row$.setAttribute('class', 'long-list-row')\n                row$.dataset.rank = startRk + n\n                row$.style.height = rowHeight + 'px'\n                @rows$.appendChild(row$)\n                row =\n                    prev : null\n                    next : prevCreatedRow\n                    el   : row$\n                    rank : startRk + n\n                prevCreatedRow.prev = row\n                prevCreatedRow = row\n                rowsToDecorate.push({rank:startRk+n; el:row$})\n            # set the buffer\n            buffer.last       = row\n            buffer.first.next = row\n            buffer.last.prev  = buffer.first\n            buffer.lastRk     = row.rank\n            buffer.nRows     += nToAdd\n            # decorate the created rows\n            @onRowsMovedCB(rowsToDecorate)\n\n\n        ###*\n         * Adapt the buffer when the viewport has moved out of the safe zone.\n         * Launched by initRows and _scrollHandler\n        ###\n        _moveBuffer = (force) =>\n            noScrollScheduled  = true\n\n            ##\n            # 1/ test speed, if too high, relaunch a _scrollHandler\n            current_scrollTop = @viewport$.scrollTop\n            speed = Math.abs(current_scrollTop - lastOnScroll_Y) / viewportHeight\n            if speed > MAX_SPEED and not force\n                # console.log \"SPEED TO HIGH :-)\"\n                _scrollHandler()\n                return\n\n            ##\n            # 2/ compute safeZone\n            bufr = buffer\n            VP_firstY  = current_scrollTop\n            VP_firstRk = Math.floor(VP_firstY / rowHeight)\n            VP_lastY   = current_scrollTop + viewportHeight\n            VP_lastRk  = Math.floor(VP_lastY / rowHeight)\n            SZ_firstRk = Math.max(VP_firstRk - nRowsInSafeZoneMargin , 0)\n            SZ_lastRk  = SZ_firstRk + nRowsInSafeZone - 1\n            # if nRows <= SZ_lastRk\n            #     SZ_lastRk = nRows - 1\n            #     SZ_firstRk = SZ_lastRk - nRowsInSafeZone + 1 # can not be lower\n            #     # than 0, because that would meand there are less rows than in\n            #     # the buffer, and in this case the scroll handler don't call\n            #     # _moveBuffer\n\n            ##\n            # 3/ detect how the viewport is moving and how to adapt the buffer\n            # console.log '\\n======_moveBuffer, nRows=', nRows\n            # console.log 'viewport firstRk', VP_firstRk, 'lastRk:', VP_lastRk\n            # console.log 'safeZone firstRk', SZ_firstRk, 'lastRk:', SZ_lastRk\n            # console.log 'initial buffer   firstRk', bufr.firstRk, 'lastRk:', bufr.lastRk\n\n            nToMove = 0\n\n            if bufr.lastRk < SZ_lastRk\n                ##\n                # 3.1/ the viewport is going down and its last line is bellow\n                # the last line of the safeZone.\n                # => compute new buffer\n\n                newBfr_firstRk = Math.max(VP_firstRk - nRowsInBufrMargin, 0)\n                newBfr_lastRk  = newBfr_firstRk + nMaxRowsInBufr - 1\n                if nRows <= newBfr_lastRk\n                    newBfr_lastRk = nRows - 1\n                    newBfr_firstRk = newBfr_lastRk - nMaxRowsInBufr + 1 # can not be\n                    # lower than 0, because that would meand there are less rows\n                    # than in the buffer, and in this case the scroll handler\n                    # don't call _moveBuffer\n\n                # nToMove = number of rows to move by reusing rows from the top\n                # of the buffer in order to fill its bottom\n                nToMove = Math.min(newBfr_lastRk - bufr.lastRk, nMaxRowsInBufr)\n                targetRk  = Math.max(bufr.lastRk + 1, newBfr_firstRk)\n\n                # console.log 'direction: DOWN',         \\\n                #             'nToMove:'   + nToMove,    \\\n                #             'targetRk:'  + targetRk\n                # console.log 'new buffer firstRk', newBfr_firstRk, \\\n                #             'lastRk', newBfr_lastRk\n\n                if nToMove > 0\n                    # console.log \"there are nToMove=\", nToMove,\n                    #             \"rows to move down after targetRk=\", targetRk\n                    elemtsToDecorate = _moveBufferToBottom(nToMove, targetRk)\n                    @rows$.style.paddingTop = (bufr.firstRk*rowHeight)+'px'\n                    @onRowsMovedCB(elemtsToDecorate)\n                # else\n                #     console.log \"viewport goind DOWN but remain in =\", nToMove,\n                #                 \"rows to move down after targetRk=\", targetRk\n\n\n            else if SZ_firstRk < bufr.firstRk\n                ##\n                # 3.2/ the viewport is going up and its last line is bellow\n                # the last line of the safeZone.\n                # => compute new buffer\n\n                newBfr_firstRk = Math.max(VP_firstRk - nRowsInBufrMargin, 0)\n                newBfr_lastRk  = newBfr_firstRk + nMaxRowsInBufr - 1\n\n                # nToMove = number of rows to move by reusing rows from the\n                # bottom of the buffer in order to fill its top\n                nToMove  = Math.min(bufr.firstRk - newBfr_firstRk, nMaxRowsInBufr)\n                targetRk = Math.min(bufr.firstRk - 1, newBfr_lastRk)\n\n                # console.log 'direction: UO',           \\\n                #             'nToMove:'   + nToMove,    \\\n                #             'targetRk:'  + targetRk\n                # console.log 'new buffer firstRk', newBfr_firstRk, \\\n                #             'lastRk', newBfr_lastRk\n\n                if nToMove > 0\n                    # console.log \"there are nToMove=\", nToMove,\n                    #             \"rows to move UP before targetRk=\", targetRk\n                    elemtsToDecorate = _moveBufferToTop(nToMove, targetRk)\n                    @rows$.style.paddingTop = (bufr.firstRk*rowHeight)+'px'\n                    @onRowsMovedCB(elemtsToDecorate)\n                # else\n                #     console.log \"viewport goind DOWN but remain in =\", nToMove,\n                #                 \"rows to move down after targetRk=\", targetRk\n\n\n            # console.log 'moved rows', nToMove\n            # console.log 'final buffer   firstRk', bufr.firstRk, 'lastRk:', bufr.lastRk\n\n        @_moveBuffer = _moveBuffer\n\n\n        ###*\n         * The buffer has been initialized, now we will create its rows elements\n         * The buffer lists all the created rows, keep a reference on the first\n         * (top most) and the last (bottom most) row.\n         * The buffer is a closed double linked chain.\n         * Each element of the chain is a \"row\" with a previous (prev) and next\n           (next) element.\n         * \"closed\" means that buffer.last.prev == buffer.first\n         * Buffer data structure :\n             first   : {row}    # top most row\n             firstRk : {integer} # y of the first row of the buffer\n             last    : {row}    # bottom most row\n             lastRk  : {integer} # y of the last row of the buffer\n             nRows   : {integer} # number of rows in the buffer\n        ###\n        _firstPopulateBuffer  = (nToAdd) =>\n            # set nRows and init the height of the rows element\n            nRows = nToAdd\n            @rows$.style.height = nRows*rowHeight + 'px'\n            @viewport$.scrollTop = 0\n            # create the rows elements of the buffer\n            bufr = buffer\n            nToCreate = Math.min(nRows, nMaxRowsInBufr)\n            firstCreatedRow = {}\n            prevCreatedRow  = firstCreatedRow\n            rowsToDecorate = []\n            for n in [1..nToCreate] by 1\n                row$ = document.createElement('li')\n                row$.setAttribute('class', 'long-list-row')\n                row$.dataset.rank = n-1\n                row$.style.height = rowHeight + 'px'\n                @rows$.appendChild(row$)\n                row =\n                    prev : null\n                    next : prevCreatedRow\n                    el   : row$\n                    rank : n - 1\n                prevCreatedRow.prev = row\n                prevCreatedRow = row\n                rowsToDecorate.push({rank:n-1;el:row$})\n            # set the buffer\n            if nToAdd == 0\n                bufr.first   = null\n                bufr.firstRk = -1\n                bufr.last    = null\n                bufr.lastRk  = -1\n                bufr.nRows   = null\n            else\n                bufr.first   = firstCreatedRow.prev\n                bufr.firstRk = 0\n                bufr.last    = row\n                bufr.first.next = bufr.last\n                bufr.last.prev  = bufr.first\n                bufr.lastRk  = row.rank\n                bufr.nRows   = nToCreate\n            # check if the long list is dynamic\n            if nMaxRowsInBufr < nRows\n                isDynamic = true\n            else\n                isDynamic = false\n\n\n            @onRowsCreatedCB(rowsToDecorate)\n\n        @_firstPopulateBuffer = _firstPopulateBuffer\n\n\n        ###*\n         * Add a new row in the current long list.\n         * If the insertion is before the buffer or into the buffer, the\n         * impacted rows are modified (their rank is increased by nToAdd)\n         * If some rows are inserted\n         * @param {integer} fromRank first rank where a row will be added\n        ###\n        _addRow = (fromRank)->\n            # console.log 'LongList._addRow', fromRank\n            if nRows == 0\n                @_firstPopulateBuffer(1)\n                return\n            ##\n            # update nRows\n            nRows++\n            if nRows <= nMaxRowsInBufr\n                isDynamic = false\n            else\n                isDynamic = true\n            ##\n            # Case A: After the insertion there will be at most the\n            # maximum nomber of rows in the buffer (nRows <= nMaxRowsInBufr)\n            # We will just add a row in the buffer and create an element\n            if nRows <= nMaxRowsInBufr\n\n                ##\n                # Case A.1: the insertion is at rank 0\n                if fromRank == 0\n                    row$ = document.createElement('li')\n                    row$.setAttribute('class', 'long-list-row')\n                    row$.style.height = rowHeight + 'px'\n                    @rows$.insertBefore(row$, @rows$.firstChild)\n                    row =\n                        prev : buffer.first\n                        next : buffer.last\n                        el   : row$\n                        rank : 0\n                    # set the buffer\n                    buffer.first.next = row\n                    buffer.last.prev  = row\n                    buffer.first      = row\n                    buffer.lastRk++\n                    buffer.nRows++\n                    # adapt ranks of the rows of the buffer\n                    last = buffer.last\n                    row  = buffer.first\n                    currentRk = 0\n                    loop\n                        row.rank = currentRk\n                        row.el.dataset.rank = currentRk\n                        break if row == last\n                        row = row.prev\n                        currentRk += 1\n                    # redecorate created row\n                    @rows$.style.height = nRows*rowHeight + 'px'\n                    @onRowsCreatedCB([{el:row$,rank:0}])\n                    return\n\n                ##\n                # Case A.2: the insertion is in the middle of the buffer,\n                # including potentially the last row of the buffer\n                else if fromRank <= buffer.lastRk\n                    row$ = document.createElement('li')\n                    row$.setAttribute('class', 'long-list-row')\n                    row$.style.height = rowHeight + 'px'\n                    rowOfInsertion = buffer.getRow(fromRank)\n                    @rows$.insertBefore(row$, rowOfInsertion.el)\n                    next = rowOfInsertion.next\n                    row =\n                        prev : rowOfInsertion\n                        next : next\n                        el   : row$\n                        rank : fromRank\n                    next.prev = row\n                    rowOfInsertion.next = row\n                    # set the buffer\n                    buffer.lastRk++\n                    buffer.nRows++\n                    # adapt ranks of the rows of the buffer\n                    last = buffer.last\n                    row  = row\n                    currentRk = fromRank\n                    loop\n                        row.rank = currentRk\n                        row.el.dataset.rank = currentRk\n                        break if row == last\n                        row = row.prev\n                        currentRk += 1\n                    # redecorate created row\n                    @rows$.style.height = nRows*rowHeight + 'px'\n                    @onRowsCreatedCB([{el:row$,rank:fromRank}])\n                    return\n\n                ##\n                # Case A.3: insertion of a new row after the last row of the\n                # buffer\n                else if fromRank == buffer.lastRk + 1\n                    row$ = document.createElement('li')\n                    row$.setAttribute('class', 'long-list-row')\n                    row$.style.height = rowHeight + 'px'\n                    row$.dataset.rank = fromRank\n                    @rows$.appendChild(row$)\n                    row =\n                        prev : buffer.first\n                        next : buffer.last\n                        el   : row$\n                        rank : fromRank\n                    # set the buffer\n                    buffer.first.next = row\n                    buffer.last.prev  = row\n                    buffer.last       = row\n                    buffer.lastRk++\n                    buffer.nRows++\n                    # redecorate created row\n                    @rows$.style.height = nRows*rowHeight + 'px'\n                    @onRowsCreatedCB([{el:row$,rank:fromRank}])\n                    return\n\n                ##\n                # fromRank is higher than buffer.lastRank + 1 : error\n                else\n                    return undefined\n\n            ##\n            # Case B: After the insertion there will at least one more row than\n            # the maximum in the buffer (nRows == nMaxRowsInBufr + 1)\n\n            ##\n            # case B.1 : The insertion is before the buffer, first row included,\n            # then just shift down the buffer of one row\n            if fromRank <= buffer.firstRk\n                scrollTop = @viewport$.scrollTop\n                @rows$.style.height = nRows*rowHeight + 'px'\n                # adapt viewport position only if it is not the target row is\n                # not the first visible one (in this case the user will prefer\n                # to see the shift of the rows)\n                viewport_startRk = Math.floor(scrollTop / rowHeight)\n                if fromRank != viewport_startRk\n                    @viewport$.scrollTop = scrollTop + rowHeight\n\n                # adapt ranks of the rows of the buffer\n                last = buffer.last\n                row   = buffer.first\n                currentRk = row.rank + 1\n                loop\n                    row.rank = currentRk\n                    row.el.dataset.rank = currentRk\n                    break if row == last\n                    row = row.prev\n                    currentRk += 1\n                # adapt first & last rank of the buffer\n                buffer.firstRk += 1\n                buffer.lastRk  += 1\n                # adapt the buffer position\n                @rows$.style.paddingTop = (buffer.firstRk*rowHeight)+'px'\n\n                # we have to adapt buffer if the insertion rank is the first row\n                # of the viewport (since viewport has not been moved earlier)\n                if fromRank == viewport_startRk\n                    _moveBuffer(true)\n\n\n            ##\n            # case B.2 : The insertion is into the buffer\n            else if fromRank <= buffer.lastRk\n                scrollTop = @viewport$.scrollTop\n                viewport_startRk = Math.floor(scrollTop / rowHeight)\n                # increase rows$ height\n                @rows$.style.height = nRows*rowHeight + 'px'\n\n                ##\n                # case B.2.1 : insertion is into the buffer but before the\n                # viewport\n                # => we will shift up the top of the buffer and reuse the first\n                # row\n                if fromRank < viewport_startRk\n                    # => reuse the top row element\n                    @_insertTopToRank(fromRank)\n                    # move viewport and adjust buffer top\n                    @viewport$.scrollTop = scrollTop + rowHeight\n                    @rows$.style.paddingTop = (buffer.firstRk*rowHeight)+'px'\n                    return\n\n                ##\n                # case B.2.2 : insertion is into the buffer but after the\n                # first row of the viewport\n                # => we will reuse rows from the bottom of the buffer\n                else\n                    # fromRank is not the first row of the buffer\n                    # reuse the bottom row element\n                    @_insertBottomToRank(fromRank)\n                    return\n\n            ##\n            # case B.3 : The insertion is after the buffer\n            else if buffer.lastRk < fromRank\n                @rows$.style.height = nRows*rowHeight + 'px'\n                return\n\n        @_addRow = _addRow\n\n\n        ###*\n         * Move the first row of buffer to fromRank\n         * fromRank must be after buffer.firstRk and before buffer.lastRk\n         * @param  {Integer} fromRank the rank where first row will go\n        ###\n        @_insertTopToRank = (fromRank) ->\n            rowOfInsertion = buffer.getRow(fromRank)\n            elToMove = buffer.first.el\n            @rows$.insertBefore(elToMove, rowOfInsertion.el)\n            buffer.firstRk += 1\n            rowToReUse = buffer.first\n            if fromRank == buffer.firstRk\n                # no need to move the row, already at its destination\n            else\n                # move the first row to the rank fromRank\n                buffer.first = rowToReUse.prev\n                buffer.first.next = buffer.last\n                buffer.last.prev  = buffer.first\n                next = rowOfInsertion.next\n                next.prev = rowToReUse\n                rowOfInsertion.next = rowToReUse\n                rowToReUse.next = next\n                rowToReUse.prev = rowOfInsertion\n            # increase the rank of the rows in buffer after the fromRank\n            # row (included)\n            row = rowToReUse\n            last = buffer.last\n            rk = fromRank\n            loop\n                row.rank = rk\n                row.el.dataset.rank = rk\n                rk++\n                break if row == last\n                row = row.prev\n            buffer.lastRk = rk - 1\n            # redecorate moved row\n            @onRowsMovedCB([{el:rowToReUse.el,rank:rowToReUse.rank}])\n\n\n\n        @_insertBottomToRank = (fromRank) ->\n            rowOfInsertion = buffer.getRow(fromRank)\n            elToMove = buffer.last.el\n            @rows$.insertBefore(elToMove, rowOfInsertion.el)\n            rowToReUse = buffer.last\n            if rowOfInsertion != buffer.last\n                # move the last row to the rank fromRank\n                rowToReUse = buffer.last\n                buffer.last = rowToReUse.next\n                buffer.last.prev = buffer.first\n                buffer.first.next = buffer.last\n                next = rowOfInsertion.next\n                next.prev = rowToReUse\n                rowOfInsertion.next = rowToReUse\n                rowToReUse.next = next\n                rowToReUse.prev = rowOfInsertion\n                # increase the rank of the rows in buffer after the fromRank\n                # row (included)\n                row = rowToReUse\n                last = buffer.last\n                rk = fromRank\n                loop\n                    row.rank = rk\n                    row.el.dataset.rank = rk\n                    rk++\n                    break if row == last\n                    row = row.prev\n            # redecorate moved row\n            @onRowsMovedCB([{el:rowToReUse.el,rank:rowToReUse.rank}])\n\n\n\n        ###*\n         * Remove rows\n         * @param  {Integer|Element} fromRank  Rank  of the first row to delete,\n         *                           or reference to the element of the row.\n         * @param  {Integer} nToRemove Number of rows to delete from fromRank\n        ###\n        _removeRows = (rankOrElement, nToRemove) ->\n            # if fromRank is an element, get its rank\n            if typeof rankOrElement == \"number\"\n                fromRank = rankOrElement\n            else\n                fromRank = parseInt(fromRank.dataset.rank)\n            # limit toRank to the highest rank\n            toRank = fromRank + nToRemove - 1\n            if toRank > nRows - 1\n                toRank = nRows -1\n                nToRemove = toRank - fromRank + 1\n            # compute the new number of rows, delete all rows if nRows == 0\n            nRows -= nToRemove\n            if nRows < 1\n                @removeAllRows()\n            # check there are enough rows to fill the buffer\n            if nRows <= nMaxRowsInBufr\n                isDynamic = false\n            else\n                isDynamic = true\n            # delete rows one by one\n            scrollTopDelta = 0\n            for rk in [fromRank..toRank] by 1\n                # notice that we always delete the row of the same rank rank...\n                scrollTopDelta += _removeRow(fromRank)\n            @viewport$.scrollTop += scrollTopDelta\n\n\n        ###*\n         * Prerequisites :\n         *    - nRows and isDynamic must have been updated before _removeRow is\n         *    called\n         *    - must NOT be called to remove the last row (dealt by _removeRows)\n         * @return  {number} scrollTopDelta : delta in px that the scrollTop of\n         *                   the viewport should vary.\n        ###\n        _removeRow = (fromRank) =>\n            ##\n            # case 1 : The deletion is before the buffer\n            if fromRank < buffer.firstRk\n                @rows$.style.height = nRows*rowHeight + 'px'\n                # adapt ranks of the rows of the buffer\n                first     = buffer.first\n                row       = first\n                currentRk = first.rank - 1\n                buffer.firstRk = currentRk\n                loop\n                    row.rank = currentRk\n                    row.el.dataset.rank = currentRk\n                    row = row.prev\n                    currentRk += 1\n                    break if row == first\n                # adapt last rank of the buffer\n                buffer.lastRk  = currentRk - 1\n                @rows$.style.paddingTop = (buffer.firstRk*rowHeight)+'px'\n                # return the scrollTopDelta\n                return - rowHeight\n\n            ##\n            # case 2 : The deletion is into the buffer\n            else if fromRank <= buffer.lastRk\n                scrollTop = @viewport$.scrollTop\n                viewport_startRk = Math.floor(scrollTop / rowHeight)\n                viewport_endRk = viewport_startRk + nRowsInViewport - 1\n\n                ##\n                # deletion is into the buffer but before the viewport\n                # => adjust scrollTop in order not to move visible rows\n                if fromRank < viewport_startRk\n                    scrollTopDelta = - rowHeight\n                # => otherwise don't change the scrollTop\n                else\n                    scrollTopDelta = 0\n\n                # get row element\n                row = _getRowAt(fromRank)\n                # decrease rows$ height\n                @rows$.style.height = nRows*rowHeight + 'px'\n\n                ##\n                # case 2.1\n                # test if the row element can be reused on top of the buffer (ie\n                # if there are rows above the buffer)\n                # If yes, the element will be moved on top of the buffer and\n                # redecorated\n                if 0 < buffer.firstRk\n                    first = buffer.first\n                    last  = buffer.last\n                    if row == last\n                        buffer.first = last\n                        buffer.last = last.next\n                        @rows$.insertBefore(row.el, first.el)\n                    else if row != first\n                        prev         = row.prev\n                        next         = row.next\n                        prev.next    = next\n                        next.prev    = prev\n                        row.prev     = first\n                        row.next     = last\n                        first.next   = row\n                        last.prev    = row\n                        buffer.first = row\n                        @rows$.insertBefore(row.el, first.el)\n                    # adapt ranks of the rows of the buffer\n                    first      = row\n                    currentRow = row\n                    currentRk  = buffer.firstRk - 1\n                    buffer.firstRk = currentRk\n                    loop\n                        currentRow.rank = currentRk\n                        currentRow.el.dataset.rank = currentRk\n                        currentRow = currentRow.prev\n                        currentRk += 1\n                        break if currentRow == first\n                    # adapt last rank of the buffer\n                    buffer.lastRk  = currentRk - 1\n                    @rows$.style.paddingTop = (buffer.firstRk*rowHeight)+'px'\n                    # redecorate the only element really modified\n                    @onRowsMovedCB([{el:row.el,rank:row.rank}])\n                    return scrollTopDelta\n\n                ##\n                # case 2.2\n                # the row element can be reused on the bottom of the\n                # buffer (ie there are rows under the buffer)\n                # The element will be moved at the bottom of the buffer and\n                # redecorated\n                else if buffer.lastRk < nRows\n                    first = buffer.first\n                    last  = buffer.last\n                    if row == first\n                        buffer.last  = first\n                        buffer.first = first.prev\n                        @rows$.appendChild(row.el)\n                        firstImpactedRow = buffer.first\n                    else if row != last\n                        prev        = row.prev\n                        next        = row.next\n                        prev.next   = next\n                        next.prev   = prev\n                        row.prev    = first\n                        row.next    = last\n                        first.next  = row\n                        last.prev   = row\n                        buffer.last = row\n                        @rows$.appendChild(row.el)\n                        firstImpactedRow = prev\n                    else # row == buffer.last\n                        firstImpactedRow = row\n                    # adapt ranks of the rows of the buffer\n                    first      = buffer.first\n                    currentRow = firstImpactedRow\n                    currentRk  = fromRank\n                    loop\n                        currentRow.rank = currentRk\n                        currentRow.el.dataset.rank = currentRk\n                        currentRow = currentRow.prev\n                        currentRk += 1\n                        break if currentRow == first\n                    # redecorate the only element really modified\n                    @onRowsMovedCB([{el:row.el,rank:row.rank}])\n                    return scrollTopDelta\n\n                ##\n                # case 2.3\n                # There are no rows nor above nor under the buffer,\n                # just destroy the row from the buffer.\n                else\n                    # the buffer is now smaller than the number of rows\n                    isDynamic  = false\n                    first = buffer.first\n                    last  = buffer.last\n                    if row == first\n                        last.prev  = row.prev\n                        buffer.first = row.prev\n                        buffer.first.next = last\n                        @rows$.removeChild(row.el)\n                        firstImpactedRow = buffer.first\n                    else if row != last\n                        prev        = row.prev\n                        next        = row.next\n                        prev.next   = next\n                        next.prev   = prev\n                        @rows$.removeChild(row.el)\n                        firstImpactedRow = prev\n                    else # row == buffer.last ie it is the last row\n                        buffer.last = last.next\n                        buffer.last.prev = first\n                        first.next = buffer.last\n                        @rows$.removeChild(row.el)\n                        firstImpactedRow = null\n                    # adapt ranks of the rows of the buffer\n                    if firstImpactedRow\n                        first      = buffer.first\n                        currentRow = firstImpactedRow\n                        currentRk  = fromRank\n                        loop\n                            currentRow.rank = currentRk\n                            currentRow.el.dataset.rank = currentRk\n                            currentRow = currentRow.prev\n                            currentRk += 1\n                            break if currentRow == first\n                    buffer.lastRk -= 1\n                    buffer.nRows  -= 1\n                    return scrollTopDelta\n\n\n            ##\n            # case 3 : The insertion is after the buffer\n            else if buffer.lastRk < fromRank\n                @rows$.style.height = nRows*rowHeight + 'px'\n                return 0\n\n        @_removeRows = _removeRows\n\n\n        ###*\n         * move `nToMove` rows from top of the buffer to its bottom and will\n         * have their rank starting at `newRk`\n         * @param  {Integer} nToMove Nomber of rows to move\n         * @param  {Integer} newRk rank of insertion of the first element at the\n         *                         bottom of the buffer\n        ###\n        _moveBufferToBottom= (nToMove, newRk)=>\n            bufr = buffer\n            # TODO : enhancement : fill elemtsToDecorate in order of interest\n            # of decoration (decorate first the row visible in the viewport,\n            # usefull for images that will take time to download after\n            # decoration)\n            # idea :\n            # rowsToDecorateLast = []\n            # if bufr.lastRk < VP_firstRk\n            #     rowsToDecorateLast\n            # ...\n            # elemtsToDecorate = rowsToDecorateLast.join(elementsToDecorate1st)\n            elemtsToDecorate = []\n            row  = bufr.first\n            for rk in [newRk..newRk+nToMove-1] by 1\n                row.rank = rk\n                row.el.dataset.rank = rk\n                @rows$.appendChild(row.el)\n                elemtsToDecorate.push({el:row.el,rank:rk})\n                row = row.prev\n            bufr.first   = row\n            bufr.last    = row.next\n            bufr.firstRk = bufr.first.rank\n            bufr.lastRk  = rk - 1\n            return elemtsToDecorate\n\n\n        ###*\n         * move `nToMove` rows from bottom of the buffer to its top and will\n         * have their rank starting at `newRk`\n         * @param  {Integer} nToMove Nomber of rows to move\n         * @param  {Integer} newRk rank of insertion of the first element at the\n         *                         top of the buffer\n        ###\n        _moveBufferToTop = (nToMove, newRk)=>\n            bufr = buffer\n            elemtsToDecorate = []\n            row  = bufr.last\n            firstEl = bufr.first.el\n            for rk in [newRk..newRk-nToMove+1] by -1\n                row.rank = rk\n                row.el.dataset.rank = rk\n                @rows$.appendChild(row.el)\n                @rows$.insertBefore(row.el, firstEl)\n                elemtsToDecorate.push({el:row.el,rank:rk})\n                firstEl = row.el\n                row     = row.next\n            bufr.last    = row\n            bufr.first   = row.prev\n            bufr.lastRk  = bufr.last.rank\n            bufr.firstRk = rk + 1\n            return elemtsToDecorate\n\n\n\n        ###*\n         * Construct the buffer. It will be empty at the end, only ready to be\n         * used.\n         * The buffer :\n         *     * lists all the created rows, eg rows represented in the\n         *       DOM by an element.\n         *     * keeps a reference on the first row (top most) and the last\n         *      (bottom most) row.\n         *     * is a closed double linked chain.\n         * Each element of the chain is a {row} with a previous (prev) and next\n           (next) element.\n         * \"closed\" means that buffer.last.prev == buffer.first\n         * data structure :\n\n           {buffer} :\n             first   : {row}      # top most row\n             firstRk : {integer}  # y of the first row of the buffer\n             last    : {row}      # bottom most row\n             lastRk  : {integer}  # y of the last row of the buffer\n             nRows   : {integer}  # number of rows in the buffer\n             getRow  : {function} # (rank)-> returns the row if the\n                 rank is in the buffer, null otherwise.\n                 If the buffer is not empty, all elements are removed.\n\n           {Row}:\n                prev : {Row}\n                next : {Row}\n                el   : {Element}\n                rank : {Integer}\n        ###\n        _initBuffer = () ->\n            # if the buffer is not empty, remove all elements of rows$\n            if buffer\n                @rows$.innerHTML = ''\n                @rows$.style.height = '0px'\n                @rows$.style.paddingTop = '0px'\n\n            buffer =\n                first   : null   # top most row\n                firstRk : -1     # rank of the first row of the buffer\n                last    : null   # bottom most row\n                lastRk  : -1     # rank of the last row of the buffer\n                nRows   : null   # actual number of rows in the buffer\n                getRow  : (rank)->\n                    first = this.first\n                    row   = first\n                    loop\n                        if rank == row.rank\n                            return row\n                        row = row.prev\n                        break if row == first\n                    return null\n            nRows     = 0\n            isDynamic = false\n        @_initBuffer = _initBuffer\n\n\n        ####\n        # Get the dimensions (rowHeight)\n        _getStaticDimensions()\n        ####\n        # compute the geometry\n        _resizeHandler()\n        ####\n        # bind events\n        @viewport$.addEventListener( 'scroll', _scrollHandler)\n\n        ###*\n         * retuns the element corresponding to the row of the given rank or null\n         * if this row is outside the buffer.\n        ###\n        _getRowAt = (rank)->\n            if rank < buffer.firstRk\n                return null\n            else if rank <= buffer.lastRk\n                row = buffer.first\n                i   = rank - buffer.firstRk\n                while i--\n                    row = row.prev\n                return row\n            else\n                return null\n        @_getRowAt = _getRowAt\n\n\n        @getLength = () ->\n            return nRows\n\n        ###*\n         * get an array of the rows elements in the buffer after rank (included)\n         * @param  {Integer} rank Rank of the first row\n         * @return {Array}      [{rank:Integer, el:Element}, ...], [] if the\n         *                      rank is not in the buffer.\n        ###\n        _getRowsAfter = (rank)->\n            res = []\n            # the row is after the buffer, return empty array.\n            if rank > buffer.lastRk\n                return res\n            # get the row\n            first = buffer.first\n            row = _getRowAt(rank)\n            # the row is above the buffer : return all buffer\n            if row == null\n                row = buffer.first\n            # fetch all the rows after and return\n            loop\n                res.push({el:row.el, rank:row.rank})\n                row = row.prev\n                break if row == first\n            return res\n\n        @getRowsAfter = _getRowsAfter\n\n\n\n\n################################################################################\n## FUNCTIONS FOR TESTS AND DEBUG ##\n#\n\n        _goDownHalfBuffer = (ratio) =>\n            if typeof(ratio) != 'number'\n                ratio = 0.5\n            scrollTop = @viewport$.scrollTop\n            bufferHeight = buffer.nRows * rowHeight\n            @viewport$.scrollTop = scrollTop + Math.round(bufferHeight*ratio)\n            # force _moveBuffer in order to remain sync (otherwise you have to\n            # wait for the scroll event so that the buffer gets adapted)\n            _moveBuffer(true)\n        @_test.goDownHalfBuffer = _goDownHalfBuffer\n\n\n        _goUpHalfBuffer = (ratio) =>\n            if typeof(ratio) != 'number'\n                ratio = 0.5\n            scrollTop = @viewport$.scrollTop\n            bufferHeight = buffer.nRows * rowHeight\n            @viewport$.scrollTop = scrollTop - Math.round(bufferHeight*ratio)\n        @_test.goUpHalfBuffer = _goUpHalfBuffer\n\n\n        _getState = () =>\n            current_scrollTop = @viewport$.scrollTop\n            bufr = buffer\n            VP_firstY  = current_scrollTop\n            VP_firstRk = Math.floor(VP_firstY / rowHeight)\n            VP_lastY   = current_scrollTop + viewportHeight\n            VP_lastRk  = Math.floor(VP_lastY / rowHeight)\n            SZ_firstRk = Math.max(VP_firstRk - nRowsInSafeZoneMargin , 0)\n            SZ_lastRk  = SZ_firstRk + nRowsInSafeZone - 1\n            state =\n                buffer :\n                    firstRk : buffer.firstRk\n                    lastRk  : buffer.lastRk\n                    nRows   : buffer.nRows\n                viewport :\n                    firstRk : VP_firstRk\n                    lastRk  : VP_lastRk\n                safeZone :\n                    firstRk : SZ_firstRk\n                    lastRk  : SZ_lastRk\n                nRows          : nRows\n                rowHeight      : rowHeight\n                height         : parseInt(@rows$.style.height)\n                nMaxRowsInBufr : nMaxRowsInBufr\n                isDynamic      : isDynamic\n            return state\n        @_test.getState = _getState\n\n\n        _getInternals = () =>\n            return {buffer, @rows$, @viewport$}\n        @_test.getInternals = _getInternals\n\n\n        @_test.unActivateScrollListener = () =>\n            @viewport$.removeEventListener( 'scroll', _scrollHandler )\n\n\n        @_test.activateScrollListener = () =>\n            @viewport$.addEventListener( 'scroll', _scrollHandler )\n\n\n","File = require '../models/file'\ncontactCollection = require 'cozy-clearance/contact_collection'\n\n\n# Manage events coming from the Data System: remote operations on files.\nmodule.exports = class SocketListener extends CozySocketListener\n\n    models:\n        'file'   : File\n        'folder' : File\n\n    events: [\n        'file.create'\n        'file.update'\n        'file.delete'\n        'folder.create'\n        'folder.update'\n        'folder.delete'\n        'contact.create'\n        'contact.update'\n        'contact.delete'\n    ]\n\n\n    # Check if the model is located in the currently displayed path\n    isInCachedFolder: (model) ->\n        path = model.get 'path'\n        return @collection.isPathCached path\n\n\n    # When file is remotely created, add the file only if it's not already\n    # there or if the file is not uploading.\n    onRemoteCreate: (model) ->\n        inCache = @isInCachedFolder model\n        alreadyInFolder = @collection.isFileStored model\n\n        # Prevent the create if the model is locally uploading because it loses\n        # its mind otherwise.\n        if inCache and not alreadyInFolder and not model.isUploading()\n            @collection.add model, merge: true\n\n\n    # When a remote deletion occurs, remote it from the current file list.\n    onRemoteDelete: (model) ->\n        if @isInCachedFolder model\n            @collection.remove model\n\n\n    # WHen an remote update occurs, it update the model if it's listed in the\n    # current file list and if it's not uploading.\n    onRemoteUpdate: (model, collection) ->\n        inCache = @isInCachedFolder model\n        alreadyInFolder = @collection.isFileStored model\n\n        # Prevent the update if the model is locally uploading because it loses\n        # its mind otherwise.\n        if inCache and not alreadyInFolder and not model.isUploading()\n            @collection.add model, merge: true\n\n\n    # Apply remote operation to current list. Current list contains cache of\n    # all loaded files. Full data are fetched before applying any modification.\n    #\n    # Update can lead to a creation when the upload flag is changed from\n    # true to false. We don't apply creation until the upload is finished\n    # (file metadata are created remotely before the upload starts).\n    process: (event) ->\n        {doctype, operation, id} = event\n\n        if doctype is 'contact'\n            contactCollection.handleRealtimeContactEvent event\n\n        else switch operation\n            when 'create'\n                model = new @models[doctype](id: id, type: doctype)\n                model.fetch\n                    success: (fetched) =>\n                        # set as a folder or a file\n                        fetched.set type: doctype\n                        @onRemoteCreate fetched\n\n            when 'update'\n                @collections.forEach (collection) =>\n                    model = collection.get id\n\n                    if model? and not model.isUploading()\n                        model.fetch\n                            success: (fetched) =>\n                                if fetched.changedAttributes()\n                                    fetched.set type: doctype\n                                    @onRemoteUpdate fetched, collection\n\n            when 'delete'\n                @collections.forEach (collection) =>\n                    return unless model = collection.get id\n                    @onRemoteDelete model, collection\n","BaseView = require 'lib/base_view'\n\n# View that display a collection of subitems\n# used to DRY views\n# Usage : new ViewCollection(collection:collection)\n# Automatically populate itself by creating a itemView for each item\n# in its collection\n\n# can use a template that will be displayed alongside the itemViews\n\n# itemView       : the Backbone.View to be used for items\n# itemViewOptions : the options that will be passed to itemViews\n# collectionEl : the DOM element's selector where the itemViews will\n#                be displayed. Automatically falls back to el if null\n\nmodule.exports = class ViewCollection extends BaseView\n\n    collectionEl: null\n    template: -> ''\n    itemview: null\n    views: {}\n    itemViewOptions: ->\n\n    bufferEl: null\n\n    # Gets the selector of the item views\n    getItemViewSelector: ->\n        classNames = @itemview::className.replace ' ', '.'\n        return \"#{@itemview::tagName}.#{classNames}\"\n\n    # add 'empty' class to view when there is no subview\n    onChange: ->\n        @$el.toggleClass 'empty', _.size(@views) is 0\n\n    # we append the views at a specific index\n    # based on their order in the collection\n    appendView: (view) ->\n        index = @collection.indexOf view.model\n        if index is 0 # insert at the beginning\n            if @isBuffering\n                $(@bufferEl).prepend view.$el\n            else\n                @$collectionEl.prepend view.$el\n        else\n            if @isBuffering\n                brother = @bufferEl.childNodes[index - 1]\n                # if the user goes back and forth during upload\n                # brother may not be defined\n                if brother?\n                    brotherAfter = brother.nextSibling\n                    @bufferEl.insertBefore view.el, brotherAfter\n            else\n                selector = @getItemViewSelector()\n                view.$el.insertAfter $(selector).eq index - 1\n\n        ###\n            If buffering is enabled, we batch all appendView to one DOM request\n            thanks to a document fragment. Data are added one by one so we use\n            a set timeout\n        ###\n        if @isBuffering\n            clearTimeout @timeout\n            @timeout = setTimeout =>\n                @cleanBuffer()\n            , 1\n\n    # bind listeners to the collection\n    initialize: ->\n        super\n        @views = {}\n        @listenTo @collection, \"reset\",   @onReset\n        @listenTo @collection, \"add\",     @addItem\n        @listenTo @collection, \"remove\",  @removeItem\n        @listenTo @collection, \"sort\",    @onSort\n\n        @collectionEl = el if not @collectionEl?\n\n        # we only use buffer for the first render\n        @initializeBuffering()\n\n    # enable buffering\n    initializeBuffering: ->\n        @isBuffering = true\n        @bufferEl = document.createDocumentFragment()\n\n    # append the buffer to the DOM, removes it and disable buffering\n    cleanBuffer: ->\n        if @isBuffering\n            @isBuffering = false\n            @$collectionEl.html @bufferEl\n            @bufferEl = null\n\n    # if we have views before a render call, we detach them\n    render: ->\n        view.$el.detach() for id, view of @views\n        super\n\n    # after render, we reattach the views\n    afterRender: ->\n        @$collectionEl = $ @collectionEl\n        @onReset @collection\n        @onChange @views\n\n    # destroy all sub views before remove\n    remove: ->\n        @onReset []\n        super\n\n    # event listener for reset\n    onReset: (newcollection) ->\n        @removeItem view.model for id, view of @views\n        newcollection.forEach @addItem\n\n    # event listeners for add\n    addItem: (model) =>\n        options = _.extend {}, model: model, @itemViewOptions(model)\n        view = new @itemview options\n        @views[model.cid] = view.render()\n        @appendView view\n        @onChange @views\n\n    # event listeners for remove\n    removeItem: (model) =>\n        @views[model.cid].remove()\n        delete @views[model.cid]\n\n        @onChange @views\n\n    # We don't re-render the view if the order has not changed\n    # Based on Marionette.ViewCollection\n    onSort: ->\n        selector = @getItemViewSelector()\n        $itemViews = $ selector\n        orderChanged = @collection.find (item, index) =>\n            view = @views[item.cid]\n            indexView = $itemViews.index view.$el\n            return view and indexView isnt index\n\n        @render() if orderChanged\n","module.exports = {\n    \"file broken indicator\": \"Abgebrochene Datei\",\n    \"file broken remove\": \"Abgebrochene Datei entfernen\",\n    \"or\": \"oder\",\n    \"modal error\": \"Fehler\",\n    \"modal ok\": \"OK\",\n    \"modal error get files\": \"Fehler beim Holen von Dateien vom Server\",\n    \"modal error get folders\": \"Fehler beim Holen von Ordnern vom Server\",\n    \"modal error get content\": \"Ein Fehler ist aufgetreten während dem abholen des Inhalts von Ordner \\\"%{folderName}\\\" vom Server\",\n    \"modal error empty name\": \"Name kann nicht leer sein\",\n    \"modal error file invalid\": \"es scheint eine gültige Datei zu sein\",\n    \"modal error firefox dragdrop folder\": \"Mozilla Firefox unterstütz kein Hochladen von Ordner. Wenn Sie dieses\\nMerkmal benötigen, es ist verfügbar in Chromium, Chrome und Safari Browsern.\",\n    \"modal error existing folder\": \"Folder \\\"%{name}\\\" already exists. It is currently not possible to overwrite a folder.\",\n    \"root folder name\": \"root\",\n    \"confirmation reload\": \"Eine Opration ist noch aktiv, sind Sie sicher die Seite zu aktualisieren bzw. neu zu laden?\",\n    \"breadcrumbs search title\": \"Suche\",\n    \"modal error file exists\": \"Entschuldigung, eine Datei oder ein Ordner mit diesem Namen existiert bereits\",\n    \"modal error size\": \"Entschuldigung, es steht nicht genug Speicherplatz zur Verfügung\",\n    \"modal error file upload\": \"Datei konnte nicht zum Server gesendet werden\",\n    \"modal error folder create\": \"Ordner konnte nicht erstellt werden\",\n    \"modal error folder exists\": \"Entschuldigung, eine Datei oder ein Ordner mit diesem Namen existiert bereits\",\n    \"modal error zip empty folder\": \"Ein leerer Ordner kann nicht als ZIP herunter geladen werden.\",\n    \"upload running\": \"Upload is in progress. Do not close your browser\",\n    \"modal are you sure\": \"Sind Sie sicher?\",\n    \"modal delete msg\": \"Löschen kann nicht rückgänig gemacht werden\",\n    \"modal delete ok\": \"Löschen\",\n    \"modal cancel\": \"Abbrechen\",\n    \"modal delete error\": \"%{smart_count} deletion failed, corresponding file or folder has been re-integrated. |||| %{smart_count} deletions failed, corresponding files and folders have been re-integrated.\",\n    \"modal error in use\": \"Name ist schon in Gebrauch\",\n    \"modal error rename\": \"Name kann nicht geändert werden\",\n    \"modal error no data\": \"Kein Name und kein Ordner zum hochladen\",\n    \"tag\": \"Tag\",\n    \"file edit save\": \"Speichern\",\n    \"file edit cancel\": \"Abbrechen\",\n    \"tooltip delete\": \"Löschen\",\n    \"tooltip edit\": \"Umbennen\",\n    \"tooltip download\": \"Herunterladen\",\n    \"tooltip share\": \"Teilen\",\n    \"tooltip tag\": \"Tag\",\n    \"tooltip preview\": \"Preview\",\n    \"and x files\": \"und %{smart_count} andere Datei ||||\\nund %{smart_count} andere Dateien\",\n    \"already exists\": \"Existiert bereit.\",\n    \"failed to upload\": \"kann nicht zum Server gesendet werden.\",\n    \"upload complete\": \"Eine Datei wurde erfolgreich hochgeladen. ||||\\n%{smart_count} Dateien erfolgreich hochgeladen.\",\n    \"chrome error dragdrop title\": \"Dateien werden ignoriert\",\n    \"chrome error dragdrop content\": \"Druch einen Bug in Chrome, wird die folgende Datei: %{files} \\naufgrund eines Akzent im Namen ignoriert. Sie können diese mit\\nder Schaltfläche oben rechts im Bild weiterhin hinzufügen. ||||\\nDruch einen Bug in Chrome, werden die folgenden Dateien: %{files} \\naufgrund eines Akzent in deren Namen ignoriert. Sie können diese mit\\nder Schaltfläche oben rechts im Bild weiterhin hinzufügen.\",\n    \"chrome error submit\": \"Ok\",\n    \"upload caption\": \"Neue Datei hochladen\",\n    \"upload msg\": \"Ziehen Sie die Dateien oder klicken Sie hier zum auswählen.\",\n    \"upload msg selected\": \"Sie haben die Datei %{smart_count} ausgewählt, klicken Sie Hinzufügen um diese hochzuladen. ||||\\nSie haben die Dateien %{smart_count} ausgewählt, klicken Sie Hinzufügen um diese hochzuladen..\",\n    \"upload close\": \"Schließen\",\n    \"upload send\": \"Hinzufügen\",\n    \"upload button\": \"Eine Datei hochladen\",\n    \"upload success\": \"Hochladen erfolgreich beendet!\",\n    \"upload end button\": \"Schließen\",\n    \"total progress\": \"wird ausgeführt…\",\n    \"new folder caption\": \"Neuen Ordner hinzufügen\",\n    \"new folder msg\": \"Ordner mit folgendem Namen erstellen:\",\n    \"new folder close\": \"Schließen\",\n    \"new folder send\": \"Ordner erstellen\",\n    \"new folder button\": \"Neuen Ordner erstellen\",\n    \"new folder\": \"Neuer Ordner\",\n    \"download all\": \"Auswahl herunterladen\",\n    \"move all\": \"Auswahl verschieben\",\n    \"remove all\": \"Auswahl löschen\",\n    \"drop message\": \"Legen Sie Ihre Dateien hier ab um sich automatisch hinzuzufügen\",\n    \"upload folder msg\": \"Einen Ordner hochladen\",\n    \"upload folder separator\": \"oder\",\n    \"overwrite modal title\": \"Eine Datei existiert bereist\",\n    \"overwrite modal content\": \"Möchten Sie \\\"%{fileName}\\\" überschreiben?\",\n    \"overwrite modal remember label\": \"Bestätigen Sie diese Entscheidung für alle Konflikte\",\n    \"overwrite modal yes button\": \"Überschreiben\",\n    \"overwrite modal no button\": \"Auslassen\",\n    \"folder\": \"Ordner\",\n    \"image\": \"Bild\",\n    \"document\": \"Dokument\",\n    \"music\": \"Musik\",\n    \"video\": \"Video\",\n    \"yes\": \"Ja\",\n    \"no\": \"Nein\",\n    \"ok\": \"Ok\",\n    \"name\": \"Name\",\n    \"type\": \"Typ\",\n    \"size\": \"Größe\",\n    \"date\": \"Letzte Aktualisierung\",\n    \"download\": \"Alles Herunterladen\",\n    \"MB\": \"MB\",\n    \"KB\": \"KB\",\n    \"B\": \"B\",\n    \"files\": \"Dateien\",\n    \"element\": \"%{smart_count} Element |||| %{smart_count} Elemente\",\n    \"no file in folder\": \"Dieser Ordner is leer.\",\n    \"no file in search\": \"Ihre Suche ergabe keine Übereinstimmung mit Dokumenten.\",\n    \"enable notifications\": \"Mitteilungen freigeben\",\n    \"disable notifications\": \"Mitteilungen sperrem\",\n    \"notifications enabled\": \"Mitteilungen freigegeben\",\n    \"notifications disabled\": \"Mitteilungen gesperrt\",\n    \"open folder\": \"Ordner öffnen\",\n    \"download file\": \"Datei betrachten\",\n    \"also have access\": \"Diese Leute haben ebenso Zugriff, da Sie Zugriff zum übergeordnet Ordner haben\",\n    \"cancel\": \"Abbrechen\",\n    \"copy paste link\": \"Um Ihrem Kontakt Zugriff zu geben, senden Sie Ihr/Ihm den Link unten:\",\n    \"details\": \"Details\",\n    \"inherited from\": \"geerbt von\",\n    \"modal question folder shareable\": \"Wählen Sie Teilen Modus für diesen Ordner\",\n    \"modal shared folder custom msg\": \"E-Mail eintragen und Enter drücken\",\n    \"modal shared public link msg\": \"Senden Sie diesen Link um Leuten Zugriff zu diesem Ordner zu gewähren:\",\n    \"modal shared with people msg\": \"Geben Sie einer Auswahl von Leuten Zugriff. Tippen Sie Ihre E-Mail oder Namen in das Feld und drücken Enter (eine E-Mail wird versandt mit schliessen des Fensters):\",\n    \"modal send mails\": \"Mitteilung senden\",\n    \"modal question file shareable\": \"Wählen Sie Teilen Modus für diese Datei\",\n    \"modal shared file custom msg\": \"E-Mail eintragen und Enter drücken\",\n    \"modal shared file link msg\": \"Senden Sie diesen Link um Leuten Zugriff zu dieser Datei zu gewähren\",\n    \"only you can see\": \"Nur Sie haben Zugriff auf diese Resource\",\n    \"public\": \"Public\",\n    \"private\": \"Private\",\n    \"shared\": \"Shared\",\n    \"share\": \"Teilen\",\n    \"save\": \"Sicher\",\n    \"see link\": \"Siehe Link\",\n    \"send mails question\": \"Sende Mitteilungs E-Mail zu to:\",\n    \"sharing\": \"Teilen\",\n    \"revoke\": \"Absagen\",\n    \"forced public\": \"Aktuelle(r) Datei/Ordner wird geteilt, weil einer der übergeordneten Ordner geteilt wird.\",\n    \"forced shared\": \"Aktuelle(r) Datei/Ordner wird geteilt, weil einer der übergeordneten Ordner geteilt wird. Hier ist die Lsite der Gäste mit Zugriff:\",\n    \"confirm\": \"Bestätigen\",\n    \"share add\": \"Add\",\n    \"share forgot add\": \"Scheint so als ob Sie vergessen haben die Schaltfläche Hinzufügen zu drücken\",\n    \"share confirm save\": \"Die Änderungen die Sie an den Rechten vorgenommen haben, werden nicht gespeichert. Möchten Sie fortfahren?\",\n    \"mail not sent\": \"Mail not sent\",\n    \"postfix error\": \"Mail not sent.\\nCan you check that all recipient adresses are correct\\nand that your Cozy is well configured to send messages ?\",\n    \"yes forgot\": \"Zurück\",\n    \"no forgot\": \"es ist ok\",\n    \"perm\": \"Kann\",\n    \"perm r file\": \"Diese Datei herunterladen\",\n    \"perm r folder\": \"Diesen Ordner durchblättern\",\n    \"perm rw folder\": \"Dateien durchblättern und hochladen\",\n    \"change notif\": \"Diesen Kasten anwählen um benachrichtigt zu werden, wenn eine Kontakt\\neine Datei zu diesem Ordner hinzufügt.\",\n    \"send email hint\": \"Mitteilungs E-Mails werden einmalig beim Speichern gesendet\",\n    \"move\": \"Verschieben\",\n    \"tooltip move\": \"Element zu einem anderen Ordner verschieben.\",\n    \"moving...\": \"Verschieben...\",\n    \"move element to\": \"Elment verschieben zu\",\n    \"error occured canceling move\": \"Ein Fehler ist während dem abbrechen des Verschiebens aufgetreten.\",\n    \"error occured while moving element\": \"Ein Fehler ist während dem Verschieben eines Elements aufgetreten\",\n    \"file successfully moved to\": \"Datei erfolgreich verschoben zu\",\n    \"plugin modal close\": \"Schließen\",\n    \"moving selected elements\": \"Ausgewählte Elemente verschieben\",\n    \"move elements to\": \"Elemente verschieben zu\",\n    \"elements successfully moved to\": \"Elemente erfolgreich verschoben zu\",\n    \"close\": \"Schließen\"\n}\n;","module.exports = {\n  \"file broken indicator\": \"Broken file\",\n  \"file broken remove\": \"Remove broken file\",\n  \"or\": \"or\",\n  \"modal error\": \"Error\",\n  \"modal ok\": \"OK\",\n  \"modal error get files\": \"Error getting files from server\",\n  \"modal error get folders\": \"Error getting folders from server\",\n  \"modal error get content\": \"An error occurred while retrieving content of folder \\\"%{folderName}\\\" from the server\",\n  \"modal error empty name\": \"The name can't be empty\",\n  \"modal error file invalid\": \"doesn't seem to be a valid file\",\n  \"modal error firefox dragdrop folder\": \"Mozilla Firefox doesn't support folder uploading. If you need this\\nfeature, it's available in Chromium, Chrome and Safari browsers.\",\n  \"modal error existing folder\": \"Folder \\\"%{name}\\\" already exists. It is currently not possible to overwrite a folder.\",\n  \"root folder name\": \"root\",\n  \"confirmation reload\": \"An operation is in progress, are you sure you want to reload the page?\",\n  \"breadcrumbs search title\": \"Search\",\n  \"modal error file exists\": \"Sorry, a file or folder having this name already exists\",\n  \"modal error size\": \"Sorry, you haven't enough storage space\",\n  \"modal error file upload\": \"File could not be sent to server\",\n  \"modal error folder create\": \"Folder could not be created\",\n  \"modal error folder exists\": \"Sorry, a file or folder having this name already exists\",\n  \"modal error zip empty folder\": \"You can't download an empty folder as a ZIP.\",\n  \"upload running\": \"Upload is in progress. Do not close your browser\",\n  \"modal are you sure\": \"Are you sure ?\",\n  \"modal delete msg\": \"Deleting cannot be undone\",\n  \"modal delete ok\": \"Delete\",\n  \"modal cancel\": \"cancel\",\n  \"modal delete error\": \"%{smart_count} deletion failed, corresponding file or folder has been re-integrated. |||| %{smart_count} deletions failed, corresponding files and folders have been re-integrated.\",\n  \"modal error in use\": \"Name already in use\",\n  \"modal error rename\": \"Name could not be changed\",\n  \"modal error empty name\": \"Name can't be empty\",\n  \"modal error no data\": \"No name and no folder to upload\",\n  \"tag\": \"tag\",\n  \"file edit save\": \"Save\",\n  \"file edit cancel\": \"cancel\",\n  \"tooltip delete\": \"Delete\",\n  \"tooltip edit\": \"Rename\",\n  \"tooltip download\": \"Download\",\n  \"tooltip share\": \"Share\",\n  \"tooltip tag\": \"Tag\",\n  \"tooltip preview\": \"Preview\",\n  \"and x files\": \"and %{smart_count} other file ||||\\nand %{smart_count} other files\",\n  \"already exists\": \"already exists.\",\n  \"failed to upload\": \"could not be sent to server.\",\n  \"upload complete\": \"One file successfully uploaded. ||||\\n%{smart_count} files successfully uploaded.\",\n  \"chrome error dragdrop title\": \"Files are going to be ignored\",\n  \"chrome error dragdrop content\": \"Due to a bug in Chrome, the following file: %{files} is going to be\\nignored because it has an accent in its name. You can still add\\nit by using the button on the top right of your screen. ||||\\nDue to a bug in Chrome, the following files: %{files} are going to be\\nignored because they have an accent in their name. You can still add\\nthem by using the button on the top right of your screen.\",\n  \"chrome error submit\": \"Ok\",\n  \"upload caption\": \"Upload a new file\",\n  \"upload msg\": \"Drag files or click here to choose files.\",\n  \"upload msg selected\": \"You have selected %{smart_count} file, click Add to upload it. ||||\\nYou have selected %{smart_count} files, click Add to upload them.\",\n  \"upload close\": \"Close\",\n  \"upload send\": \"Add\",\n  \"upload button\": \"Upload a file\",\n  \"upload success\": \"Upload successfuly completed!\",\n  \"upload end button\": \"Close\",\n  \"total progress\": \"in progress…\",\n  \"new folder caption\": \"Add a new folder\",\n  \"new folder msg\": \"Create a folder named:\",\n  \"new folder close\": \"Close\",\n  \"new folder send\": \"Create Folder\",\n  \"new folder button\": \"Create a new folder\",\n  \"new folder\": \"new folder\",\n  \"download all\": \"Download the selection\",\n  \"move all\": \"Move the selection\",\n  \"remove all\": \"Remove the selection\",\n  \"drop message\": \"Drop your files here to automatically add them\",\n  \"upload folder msg\": \"Upload a folder\",\n  \"upload folder separator\": \"or\",\n  \"overwrite modal title\": \"A file already exist\",\n  \"overwrite modal content\": \"Do you want to overwrite \\\"%{fileName}\\\"?\",\n  \"overwrite modal remember label\": \"Apply this decision to all conflicts\",\n  \"overwrite modal yes button\": \"Overwrite\",\n  \"overwrite modal no button\": \"Skip\",\n  \"folder\": \"Folder\",\n  \"image\": \"Image\",\n  \"document\": \"Document\",\n  \"music\": \"Music\",\n  \"video\": \"Video\",\n  \"yes\": \"Yes\",\n  \"no\": \"No\",\n  \"ok\": \"Ok\",\n  \"name\": \"Name\",\n  \"type\": \"Type\",\n  \"size\": \"Size\",\n  \"date\": \"Last update\",\n  \"download\": \"Download all\",\n  \"MB\": \"MB\",\n  \"KB\": \"KB\",\n  \"B\": \"B\",\n  \"files\": \"files\",\n  \"element\": \"%{smart_count} element |||| %{smart_count} elements\",\n  \"no file in folder\": \"This folder is empty.\",\n  \"no file in search\": \"Your search did not match any documents.\",\n  \"enable notifications\": \"Enable notifications\",\n  \"disable notifications\": \"Disable notifications\",\n  \"notifications enabled\": \"Notifications enabled\",\n  \"notifications disabled\": \"Notifications disabled\",\n  \"open folder\": \"Open the folder\",\n  \"download file\": \"View the file\",\n  \"also have access\": \"These people also have access, because they have access to a parent folder\",\n  \"cancel\": \"Cancel\",\n  \"copy paste link\": \"To give access to your contact send him/her the link below:\",\n  \"details\": \"Details\",\n  \"inherited from\": \"inherited from\",\n  \"modal question folder shareable\": \"Select share mode for this folder\",\n  \"modal shared folder custom msg\": \"Enter email and press enter\",\n  \"modal shared public link msg\": \"Send this link to let people access this folder:\",\n  \"modal shared with people msg\": \"Give access to a selection of contacts. Type their emails or name in the field and press enter (an email will be sent to them when you will close this window):\",\n  \"modal send mails\": \"Send a notification\",\n  \"modal question file shareable\": \"Select share mode for this file\",\n  \"modal shared file custom msg\": \"Enter email and press enter\",\n  \"modal shared file link msg\": \"Send this link to let people access this file\",\n  \"only you can see\": \"Only you can access this resource\",\n  \"public\": \"Public\",\n  \"private\": \"Private\",\n  \"shared\": \"Shared\",\n  \"share\": \"Share\",\n  \"save\": \"Save\",\n  \"see link\": \"See link\",\n  \"send mails question\": \"Send a notification email to:\",\n  \"sharing\": \"Sharing\",\n  \"revoke\": \"Revoke\",\n  \"forced public\": \"The current file/folder is shared because one of its parent folders is shared.\",\n  \"forced shared\": \"The current file/folder is shared because one of its parent folders is shared. Here is the list of guests who can access it:\",\n  \"confirm\": \"Confirm\",\n  \"share add\": \"Add\",\n  \"share forgot add\": \"Looks like you forgot to click the Add button\",\n  \"share confirm save\": \"The changes you made to the permissions will not be saved. Is that what you want ?\",\n  \"mail not sent\": \"Mail not sent\",\n  \"postfix error\": \" Mail not sent.\\nCan you check that all recipient adresses are correct\\nand that your Cozy is well configured to send messages ?\",\n  \"yes forgot\": \"Back\",\n  \"no forgot\": \"It's ok\",\n  \"perm\": \"can \",\n  \"perm r file\": \"download this file\",\n  \"perm r folder\": \"browse this folder\",\n  \"perm rw folder\": \"browse and upload files\",\n  \"change notif\": \"Check this box to be notified when a contact\\nadd a file to this folder.\",\n  \"send email hint\": \"Notification emails will be sent one time on save\",\n  \"move\": \"Move\",\n  \"tooltip move\": \"Move element to another folder.\",\n  \"moving...\": \"Moving...\",\n  \"move element to\": \"Move element to\",\n  \"error occured canceling move\": \"An error occured while canceling move.\",\n  \"error occured while moving element\": \"An error occured while moving element\",\n  \"file successfully moved to\": \"File successfully moved to\",\n  \"plugin modal close\": \"Close\",\n  \"moving selected elements\": \"Moving selected elements\",\n  \"move elements to\": \"Move elements to\",\n  \"elements successfully moved to\": \"Elements successfully moved to\",\n  \"close\": \"Close\"\n}\n;","module.exports = {\n    \"file broken indicator\": \"Archivo estropeado\",\n    \"file broken remove\": \"Suprimir el archivo estropeado\",\n    \"or\": \"o\",\n    \"modal error\": \"Error\",\n    \"modal ok\": \"Ok\",\n    \"modal error get files\": \"Se produjo un error al recuperar los archivos del servidor\",\n    \"modal error get folders\": \"Se produjo un error al recuperar los dossiers del servidor\",\n    \"modal error get content\": \"Se produjo un error al recuperar del servidor el contenido del dossier \\\\\\\"%{folderName}\\\\\\\"\",\n    \"modal error empty name\": \"La casilla del nombre no puede estar vacía\",\n    \"modal error file invalid\": \"El archivo no parece válido\",\n    \"modal error firefox dragdrop folder\": \"Mozilla Firefox no administra la carga de dossiers. Si usted necesita\\nesta función, los navegadores Chromium, Chrome y Safari disponen de ella.\",\n    \"modal error existing folder\": \"Folder \\\"%{name}\\\" already exists. It is currently not possible to overwrite a folder.\",\n    \"root folder name\": \"root\",\n    \"confirmation reload\": \"Una operación se halla en curso. ¿Está usted seguro(a) que quiere recargar la página?\",\n    \"breadcrumbs search title\": \"Buscar\",\n    \"modal error file exists\": \"Lo siento, un archivo o un dossier tiene ya el mismo nombre\",\n    \"modal error size\": \"Lo siento, usted no dispone de espacio suficiente de almacenamiento\",\n    \"modal error file upload\": \"No se ha podido enviar el archivo al servidor\",\n    \"modal error folder create\": \"No se ha podido crear la carpeta\",\n    \"modal error folder exists\": \"Lo siento, un archivo o una carpeta tiene ya el mismo nombre\",\n    \"modal error zip empty folder\": \"Usted no puede descargar una carpeta vacía como ZIP.\",\n    \"upload running\": \"Upload is in progress. Do not close your browser\",\n    \"modal are you sure\": \"¿Está usted seguro(a)?\",\n    \"modal delete msg\": \"Suprimir es definitivo\",\n    \"modal delete ok\": \"Suprimir\",\n    \"modal cancel\": \"anular\",\n    \"modal delete error\": \"%{smart_count} deletion failed, corresponding file or folder has been re-integrated. |||| %{smart_count} deletions failed, corresponding files and folders have been re-integrated.\",\n    \"modal error in use\": \"Ese nombre ya se ha utilizado\",\n    \"modal error rename\": \"No se ha podido modificar el nombre\",\n    \"modal error no data\": \"La casilla del nombre de la carpeta no puede estar vacía\",\n    \"tag\": \"etiqueta\",\n    \"file edit save\": \"Guardar\",\n    \"file edit cancel\": \"anular\",\n    \"tooltip delete\": \"Suprimir\",\n    \"tooltip edit\": \"Renombrar\",\n    \"tooltip download\": \"Descargar\",\n    \"tooltip share\": \"Compartir\",\n    \"tooltip tag\": \"Etiqueta\",\n    \"tooltip preview\": \"Preview\",\n    \"and x files\": \"y %{smart_count} archivo ||||\\n y %{smart_count} archivos\",\n    \"already exists\": \"ya existen.\",\n    \"failed to upload\": \"no se ha podido enviar al servidor.\",\n    \"upload complete\": \"Un archivo cargado con éxito.||||\\n%{smart_count} archivos cargados con éxito.\",\n    \"chrome error dragdrop title\": \"Algunos archivos no se tendrán en cuenta\",\n    \"chrome error dragdrop content\": \"A causa de un bug de Chrome, el archivo siguiente : %{files} será\\nignorado pués su nombre tiene un acento marcado. Añádalo haciendo clic en\\nel botón que se encuentra arriba y a la derecha de su pantalla. ||||\\nA causa de un bug de Chrome, los archivos siguientes : %{files} serán\\n ignorados pués sus nombres tienen un acento marcado. Añádalos haciendo clic en\\nel botón que se encuentra arriba y a la derecha de su pantalla.\",\n    \"chrome error submit\": \"Ok\",\n    \"upload caption\": \"Añadir un archivo\",\n    \"upload msg\": \"Arrastrar archivos o hacer clic aquí para seleccionar los archivos que quiere poner en línea.\",\n    \"upload msg selected\": \"Usted ha seleccionado %{smart_count} archivo, haga clic en Añadir para cargarlo.||||\\nUsted ha seleccionado %{smart_count} archivos, haga clic en Añadir para cargarlos.\",\n    \"upload close\": \"Cerrar\",\n    \"upload send\": \"Añadir\",\n    \"upload button\": \"Cargar un archivo\",\n    \"upload success\": \"¡Descarga completa exitosa!\",\n    \"upload end button\": \"Cerrar\",\n    \"total progress\": \"en curso...\",\n    \"new folder caption\": \"Añadir una carpeta\",\n    \"new folder msg\": \"Crear una carpeta de nombre:\",\n    \"new folder close\": \"Cerrar\",\n    \"new folder send\": \"Crear una Carpeta\",\n    \"new folder button\": \"Crear una carpeta\",\n    \"new folder\": \"nueva carpeta\",\n    \"download all\": \"Descargar la selección\",\n    \"move all\": \"Desplazar la selección\",\n    \"remove all\": \"Suprimir la selección\",\n    \"drop message\": \"Pegar aquí sus archivos para añadirlos\",\n    \"upload folder msg\": \"Cargar una carpeta\",\n    \"upload folder separator\": \"o\",\n    \"overwrite modal title\": \"Ya existe un archivo\",\n    \"overwrite modal content\": \"¿Quiere usted sobrescribir \\\\\\\"%{fileName}\\\\\\\"?\",\n    \"overwrite modal remember label\": \"Aplique esta decisión a todos los conflictos\",\n    \"overwrite modal yes button\": \"Sobreescribir\",\n    \"overwrite modal no button\": \"Ignorar\",\n    \"folder\": \"Carpeta\",\n    \"image\": \"Imagen\",\n    \"document\": \"Documento\",\n    \"music\": \"Música\",\n    \"video\": \"Video\",\n    \"yes\": \"Si\",\n    \"no\": \"No\",\n    \"ok\": \"Ok\",\n    \"name\": \"Nombre\",\n    \"type\": \"Tipo\",\n    \"size\": \"Tamaño\",\n    \"date\": \"Última modificación\",\n    \"download\": \"Descargar todos los archivos\",\n    \"MB\": \"Mo\",\n    \"KB\": \"Ko\",\n    \"B\": \"o\",\n    \"files\": \"archivos\",\n    \"element\": \"%{smart_count} elemento |||| %{smart_count} elementos\",\n    \"no file in folder\": \"Esta carpeta está vacía.\",\n    \"no file in search\": \"No se ha encontrado un documento que corresponda.\",\n    \"enable notifications\": \"Activar las notificaciones\",\n    \"disable notifications\": \"Desactivar las notificaciones\",\n    \"notifications enabled\": \"Notificaciones activadas\",\n    \"notifications disabled\": \"Notificaciones desactivadas\",\n    \"open folder\": \"Abrir la carpeta\",\n    \"download file\": \"Consultar el archivo\",\n    \"also have access\": \"Esas personas tienen igualmente acceso, ya que pueden acceder a un dossier padre\",\n    \"cancel\": \"Anular\",\n    \"copy paste link\": \"Para que su contacto pueda acceder, enviarle este enlace : \",\n    \"details\": \"Detalles\",\n    \"inherited from\": \"heredado de\",\n    \"modal question folder shareable\": \"Escoger la manera de compartir esta carpeta\",\n    \"modal shared folder custom msg\": \"Escribir el correo electrónico y pulsar en Enter\",\n    \"modal shared public link msg\": \"Enviar este enlace para que puedan acceder a esta carpeta:\",\n    \"modal shared with people msg\": \"Permitir acceder a unos contactos seleccionados. Escribir sus correos electrónicos o el nombre en la casilla y pulsar Enter (se les enviará un mensaje cuando usted cierre esta ventana):\",\n    \"modal send mails\": \"Enviar una notificación\",\n    \"modal question file shareable\": \"Escoger  la manera de compartir este archivo\",\n    \"modal shared file custom msg\": \"Escriba el correo electrónico y pulsar en Enter\",\n    \"modal shared file link msg\": \"Enviar este enlace para que puedan acceder a este archivo\",\n    \"only you can see\": \"Sólo usted puede acceder a este recurso.\",\n    \"public\": \"Público\",\n    \"private\": \"Privado\",\n    \"shared\": \"Compartido\",\n    \"share\": \"Compartir\",\n    \"save\": \"Guardar\",\n    \"see link\": \"Ver el enlace\",\n    \"send mails question\": \"Enviar una notificación por correo electrónico a:\",\n    \"sharing\": \"Compartiendo\",\n    \"revoke\": \"Revocar\",\n    \"forced public\": \"Esta(e) carpeta/archivo es compartido ya que uno de sus dossiers padre es compartido.\",\n    \"forced shared\": \"Esta(e) carpeta/archivo es compartido ya que uno de sus dossiers padre es compartido. A continuación la lista de las personas con las cuales se comparte :\",\n    \"confirm\": \"Confirmar\",\n    \"share add\": \"Add\",\n    \"share forgot add\": \"Parece que a usted se le ha olvidado pulsar el botón Añadir\",\n    \"share confirm save\": \"Los cambios efectuados en los permisos no se tendrán en cuenta. ¿Lo confirma?\",\n    \"mail not sent\": \"Mail not sent\",\n    \"postfix error\": \"Mail not sent.\\nCan you check that all recipient adresses are correct\\nand that your Cozy is well configured to send messages ?\",\n    \"yes forgot\": \"Atrás\",\n    \"no forgot\": \"Ok\",\n    \"perm\": \"puede\",\n    \"perm r file\": \"cargar este archivo\",\n    \"perm r folder\": \"navegar en la carpeta\",\n    \"perm rw folder\": \"navegar en la carpeta y cargar archivos\",\n    \"change notif\": \"Desplazar\",\n    \"send email hint\": \"Se notificará por correo electrónico cuando se guarde.\",\n    \"move\": \"Desplazar\",\n    \"tooltip move\": \"Desplazar el elemento a otra carpeta.\",\n    \"moving...\": \"Desplazamiento en curso...\",\n    \"move element to\": \"Desplazar el elemento a\",\n    \"error occured canceling move\": \"Se produjo un error al anular el desplazamiento.\",\n    \"error occured while moving element\": \"Se produjo un error al desplazar el elemento.\",\n    \"file successfully moved to\": \"Archivos desplazados con éxito a\",\n    \"plugin modal close\": \"Cerrar\",\n    \"moving selected elements\": \"Desplazando los elementos seleccionados\",\n    \"move elements to\": \"Desplazar los elementos a\",\n    \"elements successfully moved to\": \"Elementos desplazados con éxito a\",\n    \"close\": \"Cerrar\"\n}\n;","module.exports = {\n    \"file broken indicator\": \"Fichier cassé\",\n    \"file broken remove\": \"Supprimer le fichier cassé\",\n    \"or\": \"ou\",\n    \"modal error\": \"Erreur\",\n    \"modal ok\": \"OK\",\n    \"modal error get files\": \"Une erreur s'est produite en récupérant les fichiers du serveur\",\n    \"modal error get folders\": \"Une erreur s'est produite en récupérant les dossiers du serveur\",\n    \"modal error get content\": \"Une erreur s'est produite en récupérant le contenu du dossier \\\"%{folderName}\\\" sur le serveur\",\n    \"modal error empty name\": \"Le nom du dossier ne peut pas être vide\",\n    \"modal error file invalid\": \"Le fichier ne parait pas être valide\",\n    \"modal error firefox dragdrop folder\": \"Mozilla Firefox ne gère pas le téléversement de dossiers. Si vous avez besoin\\nde cette fonctionnalité, elle est disponible avec les navigateurs Chromium,\\nChrome et Safari.\",\n    \"modal error existing folder\": \"Folder \\\"%{name}\\\" already exists. It is currently not possible to overwrite a folder.\",\n    \"root folder name\": \"racine\",\n    \"confirmation reload\": \"Une opération est en cours. Voulez-vous vraiment recharger la page ?\",\n    \"breadcrumbs search title\": \"Recherche\",\n    \"modal error file exists\": \"Désolé, un fichier ou un dossier a déjà le même nom\",\n    \"modal error size\": \"Désolé, vous n'avez pas assez d'espace de stockage\",\n    \"modal error file upload\": \"Le fichier n'a pas pu être envoyé au serveur\",\n    \"modal error folder create\": \"Le dossier n'a pas pu être créé\",\n    \"modal error folder exists\": \"Désolé, un fichier ou un dossier a déjà le même nom\",\n    \"modal error zip empty folder\": \"Vous ne pouvez pas télécharger un dossier vide en tant que ZIP.\",\n    \"upload running\": \"Upload is in progress. Do not close your browser\",\n    \"modal are you sure\": \"Êtes-vous sûr(e) ?\",\n    \"modal delete msg\": \"La suppression ne pourra pas être annulée\",\n    \"modal delete ok\": \"Supprimer\",\n    \"modal cancel\": \"Annuler\",\n    \"modal delete error\": \"%{smart_count} deletion failed, corresponding file or folder has been re-integrated. |||| %{smart_count} deletions failed, corresponding files and folders have been re-integrated.\",\n    \"modal error in use\": \"Ce nom est déjà utilisé\",\n    \"modal error rename\": \"Le nom n'a pas pu être modifié\",\n    \"modal error no data\": \"Pas de nom et aucun dossier à envoyer\",\n    \"tag\": \"étiquette\",\n    \"file edit save\": \"Sauvegarder\",\n    \"file edit cancel\": \"Annuler\",\n    \"tooltip delete\": \"Supprimer\",\n    \"tooltip edit\": \"Renommer\",\n    \"tooltip download\": \"Télécharger\",\n    \"tooltip share\": \"Partager\",\n    \"tooltip tag\": \"Étiquette\",\n    \"tooltip preview\": \"Preview\",\n    \"and x files\": \"et un autre fichier ||||\\net %{smart_count} autres fichiers\",\n    \"already exists\": \"existent déjà.\",\n    \"failed to upload\": \"n'a pas pu être envoyé au serveur |||| n'ont pas pu être envoyés au serveur\",\n    \"upload complete\": \"Le fichier a été transféré. ||||\\n%{smart_count} fichiers ont été transférés.\",\n    \"chrome error dragdrop title\": \"Des fichiers vont être ignorés\",\n    \"chrome error dragdrop content\": \"À cause d'un bug de Chrome, les fichiers suivants : %{files} seront\\nignorés car leur nom contient un accent. Ajoutez-les en cliquant sur\\nle bouton en haut à droite de votre écran. ||||\\nÀ cause d'un bug de Chrome, le fichier suivant : %{files} sera\\nignoré car son nom contient un accent. Ajoutez-le en cliquant sur\\nle bouton en haut à droite de votre écran.\",\n    \"chrome error submit\": \"Ok\",\n    \"upload caption\": \"Ajouter des fichiers\",\n    \"upload msg\": \"Faites glisser des fichiers ou cliquez ici pour sélectionner des fichiers à mettre en ligne.\",\n    \"upload msg selected\": \"Vous avez sélectionné %{smart_count} fichier, cliquez sur \\\"Ajouter\\\" pour les mettre en ligne. ||||\\nVous avez sélectionné %{smart_count} fichiers, cliquez sur \\\"Ajouter\\\" pour les mettre en ligne.\",\n    \"upload close\": \"Annuler\",\n    \"upload send\": \"Ajouter\",\n    \"upload button\": \"Ajouter un fichier\",\n    \"upload success\": \"Ajouté avec succès !\",\n    \"upload end button\": \"Fermer\",\n    \"total progress\": \"Progression\",\n    \"new folder caption\": \"Créer un nouveau dossier\",\n    \"new folder msg\": \"Entrer le nom du dossier :\",\n    \"new folder close\": \"Annuler\",\n    \"new folder send\": \"Créer\",\n    \"new folder button\": \"Créer un nouveau dossier\",\n    \"new folder\": \"nouveau dossier\",\n    \"download all\": \"Télécharger la sélection\",\n    \"move all\": \"Déplacer la sélection\",\n    \"remove all\": \"Supprimer la sélection\",\n    \"drop message\": \"Déposez ici vos fichiers pour les ajouter\",\n    \"upload folder msg\": \"Mettre en ligne un dossier\",\n    \"upload folder separator\": \"ou\",\n    \"overwrite modal title\": \"Un fichier existe déjà\",\n    \"overwrite modal content\": \"Voulez-vous écraser \\\"%{fileName}\\\" ?\",\n    \"overwrite modal remember label\": \"Appliquer cette décision à tous les conflits\",\n    \"overwrite modal yes button\": \"Écraser\",\n    \"overwrite modal no button\": \"Ignorer\",\n    \"folder\": \"Dossier\",\n    \"image\": \"Image\",\n    \"document\": \"Document\",\n    \"music\": \"Musique\",\n    \"video\": \"Vidéo\",\n    \"yes\": \"Oui\",\n    \"no\": \"Non\",\n    \"ok\": \"Ok\",\n    \"name\": \"Nom\",\n    \"type\": \"Type\",\n    \"size\": \"Taille\",\n    \"date\": \"Dernière modification\",\n    \"download\": \"Télécharger tous les fichiers\",\n    \"MB\": \"Mo\",\n    \"KB\": \"Ko\",\n    \"B\": \"o\",\n    \"files\": \"fichiers\",\n    \"element\": \"%{smart_count} élément |||| %{smart_count} éléments\",\n    \"no file in folder\": \"Ce dossier est vide.\",\n    \"no file in search\": \"Votre recherche ne correspond à aucun document.\",\n    \"enable notifications\": \"Activer les notifications\",\n    \"disable notifications\": \"Désactiver les notifications\",\n    \"notifications enabled\": \"Notifications activées\",\n    \"notifications disabled\": \"Notifications désactivées\",\n    \"open folder\": \"Ouvrir le dossier\",\n    \"download file\": \"Consulter le fichier\",\n    \"also have access\": \"Ces personnes ont également accès, car elles ont accès à un dossier parent\",\n    \"cancel\": \"Annuler\",\n    \"copy paste link\": \"Pour donner accès à votre contact envoyez-lui ce lien :\",\n    \"details\": \"Détails\",\n    \"inherited from\": \"hérité de\",\n    \"modal question folder shareable\": \"Choisissez le mode de partage pour ce dossier\",\n    \"modal shared folder custom msg\": \"Entrez un email et appuyez sur Entrée\",\n    \"modal shared public link msg\": \"Envoyez ce lien pour partager ce dossier ou fichier :\",\n    \"modal shared with people msg\": \"Invitez une sélection de contacts à y accéder. Saisissez l'email dans le champ et appuyez sur entrée (un email pour les prévenir leur sera envoyé) :\",\n    \"modal send mails\": \"Envoyer une notification\",\n    \"modal question file shareable\": \"Choisissez le mode de partage pour ce fichier\",\n    \"modal shared file custom msg\": \"Entrez un email et appuyez sur Entrée\",\n    \"modal shared file link msg\": \"Envoyez ce lien pour qu'elles puissent accéder à ce dossier\",\n    \"only you can see\": \"Vous seul(e) pouvez accéder à cette ressource.\",\n    \"public\": \"Public\",\n    \"private\": \"Privé\",\n    \"shared\": \"Partagé\",\n    \"share\": \"Partager\",\n    \"save\": \"Sauvegarder\",\n    \"see link\": \"Voir le lien\",\n    \"send mails question\": \"Envoyer un email de notification à :\",\n    \"sharing\": \"Partage\",\n    \"revoke\": \"Révoquer la permission\",\n    \"forced public\": \"Ce dossier/fichier est partagé car un de ses dossiers parents est partagé.\",\n    \"forced shared\": \"Ce dossier/fichier est partagé car un de ses dossiers parents est partagé. Voici la liste des personnes avec lesquelles il est partagé :\",\n    \"confirm\": \"Confirmer\",\n    \"share add\": \"Add\",\n    \"share forgot add\": \"Il semble que vous ayez oublié d'appuyer sur le bouton Ajouter\",\n    \"share confirm save\": \"Les changements effectués sur les permissions ne seront pas sauvegardés. Vous confirmez ?\",\n    \"mail not sent\": \"Mail not sent\",\n    \"postfix error\": \"Mail not sent.\\nCan you check that all recipient adresses are correct\\nand that your Cozy is well configured to send messages ?\",\n    \"yes forgot\": \"Retour\",\n    \"no forgot\": \"Ok\",\n    \"perm\": \"peut\",\n    \"perm r file\": \"consulter ce fichier\",\n    \"perm r folder\": \"parcourir ce dossier\",\n    \"perm rw folder\": \"parcourir ce dossier et ajouter des fichiers\",\n    \"change notif\": \"Cocher cette case pour recevoir une notification de Cozy quand un contact\\najoute un fichier à ce dossier.\",\n    \"send email hint\": \"Des emails de notification seront envoyés lors de la première sauvegarde.\",\n    \"move\": \"Déplacer\",\n    \"tooltip move\": \"Déplacer l'élément dans un autre dossier.\",\n    \"moving...\": \"Déplacement en cours…\",\n    \"move element to\": \"Déplacer l'élément vers\",\n    \"error occured canceling move\": \"Une erreur est survenue en annulant le déplacement.\",\n    \"error occured while moving element\": \"Une erreur est survenue en déplaçant l'élément.\",\n    \"file successfully moved to\": \"Fichier déplacé avec succès vers\",\n    \"plugin modal close\": \"Fermer\",\n    \"moving selected elements\": \"Déplacer des éléments\",\n    \"move elements to\": \"Déplacer les éléments vers\",\n    \"elements successfully moved to\": \"Eléments déplacés avec succès vers\",\n    \"close\": \"Fermer\"\n}\n;","module.exports = {\n  \"modal error\": \"Eroare\",\n  \"modal ok\": \"OK\",\n  \"modal error get files\": \"A apărut o eroare în transferul de fișiere de la server\",\n  \"modal error get folders\": \"A apărut o eroare în transferul de directoare de la server\",\n  \"modal error get content\": \"An error occurred while retrieving content of folder \\\"%{folderName}\\\" from the server\",\n  \"modal error empty name\": \"Numele nu poate fi vid\",\n  \"modal error file invalid\": \"Fișierul nu pare a fi valid\",\n  \"root folder name\": \"root\",\n  \"confirmation reload\": \"An operation is in progress, are you sure you want to reload the page?\",\n  \"breadcrumbs search title\": \"Căutare\",\n  \"modal error file exists\": \"Ne pare rău, există deja un document cu acest nume\",\n  \"modal error file upload\": \"Fișierul nu a putut fi trimis server-ului\",\n  \"modal error folder create\": \"Directorul nu a putut fi creat\",\n  \"modal error folder exists\": \"Ne pare rău, există deja un director cu acest nume\",\n  \"modal error zip empty folder\": \"You can't download an empty folder as a ZIP.\",\n  \"modal are you sure\": \"Sunteți sigur(ă)?\",\n  \"modal delete msg\": \"Ștergerea nu poate fi anulată\",\n  \"modal delete ok\": \"Ștergere\",\n  \"modal cancel\": \"Anulare\",\n  \"modal delete error\": \"%{smart_count} deletion failed, corresponding file or folder has been re-integrated. |||| %{smart_count} deletions failed, corresponding files and folders have been re-integrated.\",\n  \"modal error in use\": \"Nume deja folosit\",\n  \"modal error rename\": \"Numele nu a putut fi schimbat\",\n  \"modal error empty name\": \"Numele nu poate fi vid\",\n  \"modal error no data\": \"Nu există date de încărcat\",\n  \"tag\": \"etichetă\",\n  \"file edit save\": \"Salvare\",\n  \"file edit cancel\": \"Anulare\",\n  \"tooltip delete\": \"Ștergere\",\n  \"tooltip edit\": \"Redenumire\",\n  \"tooltip download\": \"Descărcare\",\n  \"tooltip share\": \"Partajare\",\n  \"and x files\": \"și un alt fișier ||||\\nși %{smart_count} alte fișiere\",\n  \"already exists\": \"există deja.\",\n  \"failed to upload\": \"nu au putut fi trimise la server.\",\n  \"upload complete\": \"dosarul a fost trimis cu succes la server ||||\\n%{smart_count} dosare au fost trimise cu succes la server.\",\n  \"chrome error dragdrop title\": \"Files are going to be ignored\",\n  \"chrome error dragdrop content\": \"Due to a bug in Chrome, the following file: %{files} is going to be\\nignored because it has an accent in its name. You can still add\\nit by using the button on the top right of your screen. ||||\\nDue to a bug in Chrome, the following files: %{files} are going to be\\nignored because they have an accent in their name. You can still add\\nthem by using the button on the top right of your screen.\",\n  \"chrome error submit\": \"Ok\",\n  \"upload caption\": \"Încărcare fișier\",\n  \"upload msg\": \"Alegeți fișierul de încărcat:\",\n  \"upload close\": \"Anulare\",\n  \"upload send\": \"Încărcare\",\n  \"upload button\": \"Încărcați un fișier aici\",\n  \"new folder caption\": \"Adăugați un nou director\",\n  \"new folder msg\": \"Creați un director cu numele:\",\n  \"new folder close\": \"Anulare\",\n  \"new folder send\": \"OK\",\n  \"new folder button\": \"Creare director\",\n  \"upload folder msg\": \"Încărcați un director\",\n  \"overwrite modal title\": \"A file already exist\",\n  \"overwrite modal content\": \"Do you want to overwrite \\\"%{fileName}\\\"?\",\n  \"overwrite modal remember label\": \"Apply this decision to all conflicts\",\n  \"overwrite modal yes button\": \"Overwrite\",\n  \"overwrite modal no button\": \"Skip\",\n  \"folder\": \"Director\",\n  \"image\": \"Imagine\",\n  \"document\": \"Document\",\n  \"music\": \"Muzică\",\n  \"video\": \"Video\",\n  \"yes\": \"Da\",\n  \"no\": \"Nu\",\n  \"ok\": \"Ok\",\n  \"name\": \"Nume\",\n  \"type\": \"Tip\",\n  \"size\": \"Dimensiune\",\n  \"date\": \"Ultima modificare\",\n  \"download\": \"Descărcare\",\n  \"MB\": \"Mo\",\n  \"KB\": \"Ko\",\n  \"B\": \"o\",\n  \"enable notifications\": \"Activare notificări\",\n  \"disable notifications\": \"Dezactivare notificări\",\n  \"open folder\": \"Accesare director\",\n  \"download file\": \"Descărcare fișier\",\n  \"also have access\": \"Aceste persoane au acces, deoarece au acces la un director părinte\",\n  \"cancel\": \"Anulare\",\n  \"copy paste link\": \"Pentru a oferi acces la dvs. de contact trimite el/ea pe link-ul de mai jos: \",\n  \"details\": \"Detalii\",\n  \"inherited from\": \"moștenit de la\",\n  \"modal question folder shareable\": \"Alegeți modul de partajare pentru acest director\",\n  \"modal shared folder custom msg\": \"Introduceți adresa de e-mail și apăsați Enter\",\n  \"modal shared folder link msg\": \"Trimiteți această adresă persoanelor pentru a putea accesa directorul\",\n  \"modal send mails\": \"Trimiteți o notificare\",\n  \"modal question file shareable\": \"Alegeți modul de partajare pentru acest document\",\n  \"modal shared file custom msg\": \"Introduceți adresa de e-mail și apăsați Enter\",\n  \"modal shared file link msg\": \"Trimiteți această adresă persoanelor pentru a putea accesa directorul\",\n  \"only you can see\": \"Numai Dvs. și persoanele de mai jos au acces\",\n  \"public\": \"Public\",\n  \"private\": \"Privat\",\n  \"shared\": \"Partajat\",\n  \"save\": \"Salvare\",\n  \"see link\": \"Vedeți adresă\",\n  \"send mails question\": \"Trimiteți e-mail de notificare la: \",\n  \"sharing\": \"Partajare\",\n  \"revoke\": \"Revocare permisiune\",\n  \"forced public\": \"Acesta este public deoarece un director părinte este public: \",\n  \"perm\": \"poate \",\n  \"perm r file\": \"descărca acest fișier\",\n  \"perm r folder\": \"parcurge acest dosar \",\n  \"perm rw folder\": \"parcurge acest dosar și încărca fișiere\",\n  \"change notif\": \"Bifați această casetă pentru a fi notificat atunci când o persoană de contact\\nadăuga un fișier în acest dosar.\",\n  \"send email hint\": \"Notification emails will be sent one time on save\",\n  \"share add\": \"Încărcare\"\n}\n;","client = require '../lib/client'\n\n###\n\nRepresent a file or folder document.\n\n\n# Local state and Shared state.\nThere is a concept of local state and shared state in the application, it is\nhandled in this class.\n\nThe local state corresponds to the state of the client that is not shared\nwith other clients through websockets.\n\nThe shared state is shared with other clients through websockets.\n\nBoth are needed in order to support various features like conflict management,\nupload cancel, or broken file detection.\n\n# View state.\nThe state \"selected\" is only relevant into the view, but it's handy to manage\nit in the model.\n###\nmodule.exports = class File extends Backbone.Model\n\n    # The breadcrumb is an array of vanilla JS objects\n    # representing a parent folder.\n    breadcrumb: []\n\n    # Local state. Handled through `markAs*` and `is*` methods.\n    uploadStatus: null\n\n    # Local state. Handled through `markAsErrored` method.\n    error: null\n\n    # View state. Handled through *viewSelected\n    viewSelected: false\n\n    # Flag to know if a folder's content has been rendered yet or not. Used by\n    # folder view to refresh cached data only if needed.\n    isContentRendered: false\n\n    # Valid values for `uploadStatus`.\n    @VALID_STATUSES: [null, 'uploading', 'uploaded', 'errored', 'conflict']\n\n    mimeClasses  :\n        'application/octet-stream'               : 'type-file'\n        'application/x-binary'                   : 'type-binary'\n        'text/plain'                             : 'type-text'\n        'text/richtext'                          : 'type-text'\n        'application/x-rtf'                      : 'type-text'\n        'application/rtf'                        : 'type-text'\n        'application/msword'                     : 'type-text'\n        'application/x-iwork-pages-sffpages'     : 'type-text'\n        'application/mspowerpoint'               : 'type-presentation'\n        'application/vnd.ms-powerpoint'          : 'type-presentation'\n        'application/x-mspowerpoint'             : 'type-presentation'\n        'application/x-iwork-keynote-sffkey'     : 'type-presentation'\n        'application/excel'                      : 'type-spreadsheet'\n        'application/x-excel'                    : 'type-spreadsheet'\n        'aaplication/vnd.ms-excel'               : 'type-spreadsheet'\n        'application/x-msexcel'                  : 'type-spreadsheet'\n        'application/x-iwork-numbers-sffnumbers' : 'type-spreadsheet'\n        'application/pdf'                        : 'type-pdf'\n        'text/html'                              : 'type-code'\n        'text/asp'                               : 'type-code'\n        'text/css'                               : 'type-code'\n        'application/x-javascript'               : 'type-code'\n        'application/x-lisp'                     : 'type-code'\n        'application/xml'                        : 'type-code'\n        'text/xml'                               : 'type-code'\n        'application/x-sh'                       : 'type-code'\n        'text/x-script.python'                   : 'type-code'\n        'application/x-bytecode.python'          : 'type-code'\n        'text/x-java-source'                     : 'type-code'\n        'application/postscript'                 : 'type-image'\n        'image/gif'                              : 'type-image'\n        'image/jpg'                              : 'type-image'\n        'image/jpeg'                             : 'type-image'\n        'image/pjpeg'                            : 'type-image'\n        'image/x-pict'                           : 'type-image'\n        'image/pict'                             : 'type-image'\n        'image/png'                              : 'type-image'\n        'image/x-pcx'                            : 'type-image'\n        'image/x-portable-pixmap'                : 'type-image'\n        'image/x-tiff'                           : 'type-image'\n        'image/tiff'                             : 'type-image'\n        'audio/aiff'                             : 'type-audio'\n        'audio/x-aiff'                           : 'type-audio'\n        'audio/midi'                             : 'type-audio'\n        'audio/x-midi'                           : 'type-audio'\n        'audio/x-mid'                            : 'type-audio'\n        'audio/mpeg'                             : 'type-audio'\n        'audio/x-mpeg'                           : 'type-audio'\n        'audio/mpeg3'                            : 'type-audio'\n        'audio/x-mpeg3'                          : 'type-audio'\n        'audio/wav'                              : 'type-audio'\n        'audio/x-wav'                            : 'type-audio'\n        'video/avi'                              : 'type-video'\n        'video/mpeg'                             : 'type-video'\n        'video/mp4'                              : 'type-video'\n        'application/zip'                        : 'type-archive'\n        'multipart/x-zip'                        : 'type-archive'\n        'multipart/x-zip'                        : 'type-archive'\n        'application/x-bzip'                     : 'type-archive'\n        'application/x-bzip2'                    : 'type-archive'\n        'application/x-gzip'                     : 'type-archive'\n        'application/x-compress'                 : 'type-archive'\n        'application/x-compressed'               : 'type-archive'\n        'application/x-zip-compressed'           : 'type-archive'\n        'application/x-apple-diskimage'          : 'type-archive'\n        'multipart/x-gzip'                       : 'type-archive'\n\n\n    constructor: (options) ->\n        doctype = options.docType?.toLowerCase()\n        if doctype? and doctype in ['file', 'folder']\n            options.type = doctype\n\n        super options\n\n\n    # Helpers. @TODO DUPLICATE OF GETREPOSITORY.\n    getPath: ->\n        path = @get 'path'\n        path = \"/#{path}\" if (path.length > 0) and (path[0] isnt '/')\n        name = @get 'name'\n        return \"#{path}/#{name}\"\n\n    isFolder : -> return @get('type') is 'folder'\n    isFile   : -> return @get('type') is 'file'\n    isImage  : -> return @get('type') is 'file' and @get('class') is 'image'\n    isSearch : -> return @get('type') is 'search'\n    isRoot   : -> return @get('id') is 'root'\n    isShared : ->\n        clearance = @get 'clearance'\n        return clearance? and (clearance is 'public' or clearance.length > 0)\n\n    hasBinary: -> return @isFile() and @get('binary')?.file?.id?\n    isBroken: -> return @isFile() and not @hasBinary() and not @get('uploading')\n\n    hasContentBeenRendered: -> return @isFolder() and @isContentRendered\n\n    ###\n        Getters for the local state.\n    ###\n    isUploading: -> return @isFile() and @uploadStatus is 'uploading'\n    isUploaded: -> return @isFile() and @uploadStatus is 'uploaded'\n    isErrored: -> return @isFile() and @uploadStatus is 'errored'\n    isConflict: -> return @uploadStatus is 'conflict'\n    inUploadCycle: ->\n        return @isUploading() or @isUploaded() or @isErrored() or @isConflict()\n\n    ###\n        Setters for the local state. Semantic wrapper for _setUploadStatus.\n    ###\n    markAsUploading: -> @_setUploadStatus 'uploading'\n    markAsUploaded: -> @_setUploadStatus 'uploaded'\n    markAsConflict: -> @_setUploadStatus 'conflict'\n    markAsErrored: (error) -> @_setUploadStatus 'errored', error\n    resetStatus: ->\n        @overwrite = null\n        @_setUploadStatus null\n\n    ###\n        Trigger change for each status update because Backbone only triggers\n        `change` events for model's attributes.\n        The `change` events allow the projection to be updated.\n\n        @param `status` must be in File.VALID_STATUSES\n    ###\n    _setUploadStatus: (status, error = null) ->\n        if status not in File.VALID_STATUSES\n            message = \"Invalid upload status #{status} not \" + \\\n                      \"in #{File.VALID_STATUSES}\"\n            throw new Error message\n        else\n            @error = error\n            @uploadStatus = status\n            @trigger 'change', @\n\n\n    # Solve a conflict by either marking the model with the resolution result\n    # or resuming the queue processing.\n    solveConflict: (choice) ->\n        # if the model is already in the queue, we trigger the process to get\n        # the queue going.\n        if @processOverwrite?\n            @processOverwrite choice\n            @processOverwrite = null\n\n        # otherwise, just mark the resolution result so the queue can process\n        # the item by itself.\n        else\n            @overwrite = choice\n\n\n    ###\n        Getter for the shared state.\n    ###\n    isServerUploading: -> return @get('uploading') and not @inUploadCycle()\n\n\n\n    ###\n        Manage view state.\n        The state \"selected\" is only relevant into the view, but it's handy\n        to manage it in the model.\n    ###\n    isViewSelected: -> return @viewSelected\n\n\n    toggleViewSelected: (isShiftPressed = false) ->\n        @setSelectedViewState not @isViewSelected(), isShiftPressed\n\n\n    setSelectedViewState: (viewSelected, isShiftPressed = false) ->\n        @viewSelected = viewSelected\n        @trigger 'toggle-select', cid: @cid, isShiftPressed: isShiftPressed\n\n\n    # Remove server's additional information\n    parse: (data) ->\n        delete data.success\n        return data\n\n    # the repository is the model's full path (name included in the path)\n    getRepository: ->\n        if @isRoot() then \"\" else \"#{@get('path')}/#{@get('name')}\"\n\n    # Overrides sync method to allow file upload (multipart request)\n    # and progress events\n    sync: (method, model, options) =>\n\n\n        # this is a new model, let's upload it as a multipart\n        if model.file\n\n            # if the file is being overwritten (update), we force\n            # the \"create\" method, since only the \"create\" action in the server\n            # can handle file upload.\n            method = 'create'\n            @id = \"\"\n\n            formdata = new FormData()\n            formdata.append 'name', model.get 'name'\n            formdata.append 'path', model.get 'path'\n            formdata.append 'lastModification', model.get 'lastModification'\n            formdata.append 'overwrite', true if @overwrite\n            formdata.append 'file', model.file\n\n            # trigger upload progress on the model\n            progress = (e) ->\n                model.loaded = e.loaded\n                model.trigger 'progress', e\n\n            _.extend options,\n                contentType: false\n                data: formdata\n                # patch Model.sync so it could trigger progress event\n                xhr: =>\n                    xhr = $.ajaxSettings.xhr()\n                    if xhr.upload\n                        xhr.upload.addEventListener 'progress', progress, false\n                        @uploadXhrRequest = xhr\n                    xhr\n\n        Backbone.sync.apply @, arguments\n\n    urlRoot: ->\n        prefix = if app.isPublic then '../' else ''\n\n        if @isFolder()\n            prefix + 'folders/'\n        else if @isSearch()\n            prefix + 'search/'\n        else\n            prefix + 'files/'\n\n\n    # Overrides the url method to append the key if it's public mode\n    url: (toAppend = '') ->\n        url = super()\n        key = if app.isPublic then window.location.search else ''\n\n        return url + toAppend + key\n\n\n    getPublicURL: (key) ->\n        link = \"#{app.domain}#{@urlRoot()}#{@id}\"\n        if @isFile()\n            name = encodeURIComponent @get 'name'\n            link = \"#{link}/attach/#{name}\"\n        return link\n\n\n    # Only relevant if model is a folder\n    getZipURL: ->\n        if @isFolder()\n            toAppend = \"/zip/#{encodeURIComponent @get 'name'}\"\n            @url toAppend\n\n\n    # Only relevant if model is a file\n    getAttachmentUrl: ->\n        # if the file is being uploaded, it's not accessible (yet)\n        if @isUploading()\n            \"#\"\n        else if @isFile()\n            toAppend = \"/attach/#{encodeURIComponent @get 'name'}\"\n            @url toAppend\n\n\n    getDownloadUrl: ->\n        if @isFile()\n            toAppend = \"/download/#{encodeURIComponent @get 'name'}\"\n            @url toAppend\n        else if @isFolder()\n            @getZipURL()\n\n\n    getThumbUrl: () ->\n        if @attributes.binary && @attributes.binary.thumb\n            return @url \"/thumb\"\n        else\n            return ''\n\n\n    getScreenUrl: () ->\n        if @attributes.binary && @attributes.binary.screen\n            return @url \"/screen/#{encodeURIComponent @get 'name'}\"\n        else\n            return ''\n\n\n    # Returns the type of icon. Can be :\n    #    . type-folder\n    #    . type-file      : generic when the mime is unknown\n    #    . #{a mime type} : a file with a known mime (type-pdf, type-code...)\n    #    . type-thumb     : if a file has a thumbnail\n    getIconType: () ->\n        if @isFolder()\n            return 'type-folder'\n        mimeType  = @get 'mime'\n        mimeClass = @mimeClasses[mimeType]\n        if mimeType? and mimeClass?\n            iconType = mimeClass\n        else\n            iconType = 'type-file'\n        if @attributes.binary && @attributes.binary.thumb\n            iconType = 'type-thumb'\n        return iconType\n\n\n    validate: (attrs) ->\n        errors = []\n        if not attrs.name or attrs.name is ''\n            errors.push\n                field: 'name'\n                value: \"A name must be set.\"\n\n        if errors.length > 0\n            return errors\n        return\n\n    prepareCallbacks: (callbacks, presuccess, preerror) ->\n        {success, error} = callbacks or {}\n        presuccess ?= (data) => @set data.app\n        @trigger 'request', @, null, callbacks\n        callbacks.success = (data) =>\n            presuccess data if presuccess\n            @trigger 'sync', @, null, callbacks\n            success data if success\n        callbacks.error = (jqXHR) =>\n            preerror jqXHR if preerror\n            @trigger 'error', @, jqXHR, {}\n            error jqXHR if error\n\n    ###\n        ONLY RELEVANT IF IT'S A FOLDER\n        Fetches content (folders and files) for the current folder\n        the request also responds with the breadcrumb\n    ###\n    fetchContent: (callbacks) ->\n        @prepareCallbacks callbacks\n\n        url = \"#{@urlRoot()}content\"\n        key = window.location.search # relevant if shared mode\n        if app.isPublic and not @isSearch()\n            url = \"#{@urlRoot()}#{@id}/content#{key}\"\n        else if @isSearch()\n            url += key\n\n        client.post url, id: @id, (err, body) =>\n            if err?\n                @setBreadcrumb []\n                callbacks err\n            else\n                if body.parents?\n                    {content, parents} = body\n                else\n                    # during search or for root, there is not parents\n                    content = body\n                    parents = []\n\n                @setBreadcrumb parents or []\n                callbacks null, content, parents\n\n    # Set the breadcrumb attribute and append the root model to it\n    # If the folder is a search query, the breadcrumb is the query\n    setBreadcrumb: (parents) ->\n        if @get('type') is 'search'\n            @breadcrumb = [window.app.root.toJSON(), @toJSON()]\n        else\n            parents.unshift window.app.root.toJSON()\n            # adds the current folder to the parent's list unless it's the root\n            parents.push @toJSON() unless @isRoot()\n            @breadcrumb = parents\n\n    getClearance: ->\n        if app.isPublic\n            return null\n        else\n            inheritedClearance = @get 'inheritedClearance'\n            if not inheritedClearance or inheritedClearance.length is 0\n                return @get 'clearance'\n            else\n                return inheritedClearance[0].clearance\n","app = require 'application'\nFile = require './models/file'\nFileCollection = require './collections/files'\nFolderView = require './views/folder'\nPublicFolderView = require './views/public_folder'\n\n###\nBinds routes to code actions.\nThis is also used as a controller to initialize views and perform data fetching\n###\nmodule.exports = class Router extends Backbone.Router\n\n    folderView: null\n\n    routes:\n        '': 'main'\n        'folders/:folderid' : 'folder'\n        'search/:query' : 'search'\n\n    main: ->\n        rootID = app.root.get 'id'\n        @_loadFolderView rootID\n\n    folder: (id) -> @_loadFolderView id\n\n    search: (query) ->\n        folder = new File\n            id: query\n            type: \"search\"\n            name: \"#{t('breadcrumbs search title')} '#{query}'\"\n\n        @folderView.spin() if @folderView?\n        folder.fetchContent (err, content) =>\n            collection = new FileCollection content\n\n            # we don't re-render the view to prevent the search field\n            # from being reset\n            if @folderView?\n                @folderView.spin false\n                @folderView.updateSearch folder, collection\n            else\n                @_renderFolderView folder, collection, query\n\n    # get the data and render the view\n    _loadFolderView: (folderID) ->\n        # add the spinner during folder change\n        @folderView.spin() if @folderView?\n\n        # retrieve folder info and content from data source or cache\n        app.baseCollection.getByFolder folderID, (err, folder, collection) =>\n            if err? then console.log err\n            else\n                # sort by creation date the folder where phones photo are\n                # uploaded\n                path = folder.getRepository()\n                if  path == '/Appareils photo' or path == '/Photos from devices'\n                    collection.type = 'lastModification'\n                    collection.order = 'desc'\n                    collection.sort()\n                @_renderFolderView folder, collection\n\n    # process the actual render\n    _renderFolderView: (folder, collection, query = '') ->\n        if @folderView?\n            @folderView.destroy()\n            # because destroying the view also removes the element\n            $('html').append $ '<body></body>'\n\n        # we generate a mixed collection with content & uploads\n        @folderView = @_getFolderView\n            model: folder\n            collection: collection\n            baseCollection: app.baseCollection\n            breadcrumbs: app.breadcrumbs\n            uploadQueue: app.uploadQueue\n            query: query\n        @folderView.render()\n\n    # factory to get the proper folder object based on mode (shared or not)\n    _getFolderView: (params) ->\n        if app.isPublic\n            return new PublicFolderView _.extend params, rootFolder: app.root\n        else\n            return new FolderView params\n\n","helpers =\n    # Display a Bootstrap modal window\n    #\n    # Available options:\n    # title: modal window title\n    # body: modal window body\n    # size: null, 'small' or 'large'\n    # show: if not false, show modal\n    modal: (options) ->\n        win = document.createElement 'div'\n        win.classList.add 'modal'\n        win.classList.add 'fade'\n        win.innerHTML = \"\"\"\n        <div class=\"modal-dialog\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\"\n                            aria-label=\"Close\">\n                        <span aria-hidden=\"true\">&times;</span>\n                    </button>\n                    <h4 class=\"modal-title\"></h4>\n                </div>\n                <div class=\"modal-body\"> </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-default\"\n                            data-dismiss=\"modal\">#{t 'plugin modal close'}\n                    </button>\n                </div>\n            </div>\n        </div>\n        \"\"\"\n        if options.title\n            win.querySelector('.modal-title').innerHTML = options.title\n        if options.body\n            win.querySelector('.modal-body').innerHTML = options.body\n        if options.size is 'small'\n            win.querySelector('.modal-dialog').classList.add 'modal-sm'\n        if options.size is 'large'\n            win.querySelector('.modal-dialog').classList.add 'modal-lg'\n        if options.show isnt false\n            document.body.appendChild win\n            window.jQuery(win).modal 'show'\n        return win\n    getFiles: (extensions, node) ->\n        selector = extensions.map (f) ->\n            \"[data-file-name$=\" + f + \"]\"\n        .join ','\n        if not node?\n            node = document\n\n        return node.querySelectorAll selector\n    addIcon: (elmt, onClick) ->\n        if not elmt.dataset.hasPreview\n            elmt.dataset.hasPreview = true\n            icon = document.createElement 'a'\n            icon.classList.add 'file-preview'\n            icon.title = window.t 'tooltip preview'\n            icon.innerHTML = \"<i class='fa fa-eye'></i>\"\n            icon.addEventListener 'click', onClick\n            operationsEl = elmt.parentNode.querySelector('.operations')\n            operationsEl?.appendChild icon\n\nmodule.exports =\n\n    init: ->\n        if not window.plugins?\n            window.plugins = {}\n\n        # Init every plugins\n        for own pluginName, pluginConf of window.plugins\n            @activate pluginName\n\n        window.plugins.helpers = helpers\n\n        if MutationObserver?\n\n            config =\n                attributes: false\n                childList: true\n                characterData: false\n                subtree: true\n\n            onMutation = (mutations) ->\n                checkNode = (node, action) ->\n                    if node.nodeType isnt Node.ELEMENT_NODE\n                        return\n\n                    for own pluginName, pluginConf of window.plugins\n                        if pluginConf.active\n                            listener = pluginConf.onAdd if action is 'add'\n                            listener = pluginConf.onDelete if action is 'delete'\n                            if listener? and\n                            listener.condition.bind(pluginConf)(node)\n                                listener.action.bind(pluginConf)(node)\n\n                check = (mutation) ->\n\n                    nodes = Array.prototype.slice.call mutation.addedNodes\n                    checkNode node, 'add' for node in nodes\n\n                    nodes = Array.prototype.slice.call mutation.removedNodes\n                    checkNode node, 'del' for node in nodes\n\n                check mutation for mutation in mutations\n\n            # Observes DOM mutation to see if a plugin should be called\n            observer = new MutationObserver onMutation\n            observer.observe document, config\n\n        else\n            # Dirty fallback for IE\n            # @TODO use polyfill ???\n            setInterval ->\n                for own pluginName, pluginConf of window.plugins\n                    if pluginConf.active\n                        if pluginConf.onAdd?\n                            if pluginConf.onAdd.condition document.body\n                                pluginConf.onAdd.action document.body\n\n            , 200\n\n    activate: (key) ->\n        plugin = window.plugins[key]\n        type   = plugin.type\n        plugin.active = true\n\n        # Add custom events listeners\n        if plugin.listeners?\n            for own event, listener of plugin.listeners\n                window.addEventListener event, listener.bind(plugin)\n\n        if plugin.onActivate\n            plugin.onActivate()\n\n        if type?\n            for own pluginName, pluginConf of window.plugins\n                if pluginName is key\n                    continue\n                if pluginConf.type is type and pluginConf.active\n                    @deactivate pluginName\n\n    deactivate: (key) ->\n        plugin = window.plugins[key]\n        plugin.active = false\n\n        # remove custom events listeners\n        if plugin.listeners?\n            for own event, listener of plugin.listeners\n                window.removeEventListener event, listener\n\n        if plugin.onDeactivate\n            plugin.onDeactivate()\n\n\n","BaseView = require '../lib/base_view'\n\nmodule.exports = class BreadcrumbsView extends BaseView\n\n    itemview: require './templates/breadcrumbs_element'\n    tagName: \"ul\"\n\n    # collection is a simple array, not a backbone collection\n    render: ->\n        # temporary trick to prevent public area\n        # to display the root (shared folder) twice in shared mode\n        @collection.shift() unless @collection[0].id is 'root'\n\n        opacity = if @collection.length is 1 then '0.5' else '1'\n        @$el.css 'opacity', opacity\n\n        @$el.empty()\n        for folder in @collection\n            @$el.append @itemview model: folder\n        @\n\n","\n###*\n * This module is in charge of displaying the file information in a popover when\n * the user lets his mouse over the icon of the file.\n * For now we only display the thumbnail of files being an image.\n###\n\nARROW_TOP_OFFSET       = 17  # top offset in pixels for the arrow of the popover\nPOPOVER_DEFAULT_HEIGHT = 310 # height of thumbnails\n\nmodule.exports = class FileInfo\n\n    constructor: (elmt) ->\n\n        # A] DOM of the Popover\n        @el    = elmt\n        @img   = document.createElement('img')\n        @a     = document.createElement('a')\n        @arrow = document.createElement('div')\n        @el.appendChild(@a).appendChild(@img)\n        @el.appendChild(@arrow)\n\n        # B] EVENTS LISTENERS ON POPOVER\n        elmt.addEventListener 'mouseenter', (event) =>\n            @_isIntoPopover = true\n            @stateMachine.E3_enterPopo()\n        elmt.addEventListener 'mouseleave', (event) =>\n            @_isIntoPopover = false\n            @stateMachine.E4_exitPopo()\n        @a.addEventListener 'click', (event) =>\n            # if ctrl => open link in new window : nothing to do\n            if event.ctrlKey\n                return\n            # else show gallery\n            window.app.gallery.show(@_currentTarget.model)\n            event.preventDefault()\n\n        # C] EVENTS LISTENERS ON IMG\n        @_previousPopoverHeight = POPOVER_DEFAULT_HEIGHT\n        @img.onload = (event) =>\n            dim = @el.getBoundingClientRect()\n            if @_previousPopoverHeight != dim.height\n                @_previousPopoverHeight = dim.height\n\n        # D] TRACK MOUSE POSITION to check it is in the column of the files icons,\n        # or it goes out of the column (+-10px)\n        @_columnGardian.init(@)\n\n        # E] FINITE STATE MACHINE CONFIGURATION\n        # we use a finite state model to describe the states and\n        # their transitions\n        # States :\n        #   . S1_Init          : the mouse is not over the link, the popover is hidden\n        #   . S2_WaitingToShow : the mouse is over the link, the popover is not yet visible\n        #   . S3_Visible       : the popopver is visible and the mouse is over the link or the popover\n        #   . S4_WaitingToHide : the popopver is visible and the mouse is neither over the link nor the popover\n        #  Events :\n        #   . E1_enterLink  :\n        #   . E2_exitLink   :\n        #   . E3_enterPopo  : Enter popover\n        #   . E4_exitPopo   : Exit popover\n        #   . E5_showTimer  :\n        #   . E6_hideTimer  :\n        #   . E7_enterCol   : the mouse enters the column of the thumbnail\n        #   . E8_exitCol    : the mouse exits  the column of the thumbnail\n        #   . E9_linkNoData :\n\n        @stateMachine = StateMachine.create\n\n            initial: 'S1_Init'\n\n            events : [\n\n                { from:'S1_Init'          , to:'S2_WaitingToShow' , name:'E1_enterLink'  }\n                { from:'S1_Init'          , to:'S1_Init'          , name:'E4_exitPopo'   } # can occur... why ?\n\n                { from:'S2_WaitingToShow' , to:'S3_Visible'       , name:'E5_showTimer'  }\n                { from:'S2_WaitingToShow' , to:'S1_Init'          , name:'E8_exitCol'    }\n                { from:'S2_WaitingToShow' , to:'S1_Init'          , name:'E2_exitLink'   }\n                { from:'S2_WaitingToShow' , to:'S2_WaitingToShow' , name:'E1_enterLink'  }\n\n                { from:'S3_Visible'       , to:'S4_WaitingToHide' , name:'E4_exitPopo'   }\n                { from:'S3_Visible'       , to:'S4_WaitingToHide' , name:'E8_exitCol'    }\n                { from:'S3_Visible'       , to:'S4_WaitingToHide' , name:'E9_linkNoData' }\n                { from:'S3_Visible'       , to:'S3_Visible'       , name:'E1_enterLink'  }\n                { from:'S3_Visible'       , to:'S3_Visible'       , name:'E3_enterPopo'  }\n                { from:'S3_Visible'       , to:'S3_Visible'       , name:'E7_enterCol'   }\n\n                { from:'S4_WaitingToHide' , to:'S3_Visible'       , name:'E1_enterLink'  }\n                { from:'S4_WaitingToHide' , to:'S3_Visible'       , name:'E3_enterPopo'  }\n                { from:'S4_WaitingToHide' , to:'S3_Visible'       , name:'E7_enterCol'   }\n                { from:'S4_WaitingToHide' , to:'S1_Init'          , name:'E6_hideTimer'  }\n                { from:'S4_WaitingToHide' , to:'S4_WaitingToHide' , name:'E4_exitPopo'   } # can occur... why ?\n            ]\n\n            # usefull for debug\n            # error: (eventName, from, to, args, errorCode, errorMessage) ->\n            #     console.log '  event ' , eventName + ' from:', from,' to', to, ' was naughty : ' , errorMessage\n\n            callbacks:\n\n                ####\n                # A/ Callbacks on entering or leaving a state\n                onenterS2_WaitingToShow: (event,from,to) =>\n                    # console.log '  onenterS2_WaitingToShow',event, from, to\n                    if from == 'S1_Init'\n                        @_startShowTimer()\n                        @_lastEnteredTarget.el.querySelector('.icon-type').style.cursor = 'wait'\n                        @_columnGardian.start()\n\n                onleaveS2_WaitingToShow: (event,from,to) =>\n                    # console.log '  onleaveS2_WaitingToShow',event, from, to\n                    @_lastEnteredTarget.el.querySelector('.icon-type').style.cursor = ''\n\n                onenterS3_Visible: (event,from,to) =>\n                    # console.log '  onenterS3_Visible', event, from, to\n                    if from == 'S2_WaitingToShow'\n                        @_setNewTarget()\n                        @_show()\n                    else if from == 'S4_WaitingToHide'\n                        window.clearTimeout(@hideTimeout)\n                        if @_lastEnteredTarget != @_currentTarget\n                            @_setNewTarget()\n\n                onenterS4_WaitingToHide: (event,from,to) =>\n                    # console.log '  onenterS4_WaitingToHide', event, from, to\n                    @_startHideTimer()\n\n                onenterS1_Init: (event,from,to) =>\n                    # console.log '  onenterInit', event, from, to\n                    if from == 'S4_WaitingToHide'\n                        @_hide()\n                        @_columnGardian.stop()\n                    else if from == 'S2_WaitingToShow'\n                        window.clearTimeout(@showTimeout)\n                        @_columnGardian.stop()\n\n                ####\n                # B/ Callbacks on entering an event to cancel it if required\n                onbeforeE1_enterLink: (event,from, to) =>\n                    # console.log '  onbeforeE1_enterLink', @_hasInfoToDisplay(@_lastEnteredTarget), from, to\n                    if @_hasInfoToDisplay(@_lastEnteredTarget)\n                        if from == to == 'S3_Visible'\n                            @_setNewTarget()\n                        return true\n                    else\n                        if from == 'S3_Visible'\n                            @stateMachine.E9_linkNoData()\n                        return false\n\n                onbeforeE2_exitLink: (event,from, to) =>\n                    # console.log '  onbeforeE2_exitLink', @_hasInfoToDisplay(@_lastEnteredTarget), from, to\n                    if !@_hasInfoToDisplay(@_lastEnteredTarget)\n                        return false\n\n                onbeforeE8_exitCol: (event,from, to) =>\n                    # exit col can occur after enterPopover because the widht of\n                    # the column is over the popover... So exit the column is\n                    # after the entre popover event.\n                    if @_isIntoPopover\n                        return false\n                    else\n                        return true\n\n    ###*\n     * Moves the popover on its corresponding thumbnail target.\n    ###\n    _setNewTarget:() ->\n        # console.log '_setNewTarget'\n        # update position (takes care if the thumbnail is too low in the window)\n        target          = @_lastEnteredTarget\n        @_currentTarget = target\n        el              = target.el\n        topFileInfo     = el.offsetTop\n        scrollTop       = el.offsetParent.scrollTop\n        clientHeight    = el.offsetParent.clientHeight\n        popoverTop      = topFileInfo - scrollTop\n        popoverBottom   = popoverTop + @_previousPopoverHeight\n        if popoverBottom < clientHeight\n            @el.style.top   = popoverTop + 'px'\n            @arrow.style.top = ARROW_TOP_OFFSET + 'px'\n        else\n            @el.style.top   = (clientHeight - @_previousPopoverHeight) + 'px'\n            arrowTop = popoverTop - clientHeight + @_previousPopoverHeight + ARROW_TOP_OFFSET\n            arrowTop = Math.min(arrowTop, @_previousPopoverHeight - 12 )\n            @arrow.style.top = arrowTop + 'px'\n        # update content\n        @img.src = target.model.getThumbUrl()\n        @a.href  = target.model.getAttachmentUrl()\n\n\n    _show: () ->\n        # console.log '_show'\n        @el.style.display = 'block'\n        @el.classList.add('ease')\n\n\n    _hide: () ->\n        # console.log '_hide'\n        @el.style.display = 'none'\n        @el.classList.remove('ease')\n\n\n    _startShowTimer: ()->\n        @showTimeout = window.setTimeout () =>\n            @stateMachine.E5_showTimer()\n        , 700\n\n\n    _startHideTimer: ()->\n        @hideTimeout = window.setTimeout () =>\n            @stateMachine.E6_hideTimer()\n        , 300\n\n    ###*\n     * Return false if the model corresponds to a file which has no info to\n     * display in the popover. For now only files with thumbnails are concerned.\n     * @param  {View}  targetView Backbone view of the file\n     * @return {Boolean}  True if the file has info to display in the\n     *                    popover, false otherwise.\n    ###\n    _hasInfoToDisplay: (targetView)->\n        if targetView.model.attributes.binary?.thumb?\n            return true\n        else\n            return false\n\n\n    onEnterLink: (targetView)->\n        # console.log 'onEnterLink', @stateMachine.current\n        @_lastEnteredTarget =\n            el    : targetView.el\n            model : targetView.model\n        @stateMachine.E1_enterLink()\n\n\n    onExitLink: (targetView)->\n        # console.log 'onExitLink', @stateMachine.current\n        if @stateMachine.current == 'S2_WaitingToShow'\n            @stateMachine.E2_exitLink()\n\n\n\n    _columnGardian :\n\n        init: (file_info_ctlr)->\n\n            @file_info_ctlr = file_info_ctlr\n            @FIC_container = file_info_ctlr.el.parentElement\n            @_computeColumnWidth()\n\n            # update the col positions when the window is resized\n            computeColAfterResize = _.debounce () =>\n                @_computeColumnWidth()\n            , 1000\n            window.addEventListener(\"resize\", computeColAfterResize, false)\n\n            # callback to track if the mouse remains or not in the column of the\n            # thumbnails.\n            @mouseMoved = (ev) =>\n                # console.log '_mouseMoved', ev.pageX, ev.pageY\n                isInCol = this.col_left < ev.pageX\n                isInCol = isInCol &&  ev.pageX < this.col_right\n                if this.isInCol != isInCol\n                    if isInCol\n                        this.file_info_ctlr.stateMachine.E7_enterCol()\n                    else\n                        this.file_info_ctlr.stateMachine.E8_exitCol()\n                    this.isInCol = isInCol\n\n        _computeColumnWidth: ()->\n            thumb = @FIC_container.querySelector('.icon-type')\n            if thumb == null\n                return\n            dimensions = thumb.getBoundingClientRect()\n            this.col_left  = dimensions.left - 10\n            this.col_right = this.col_left + dimensions.width + 20\n            captionWrapper = @FIC_container.querySelector('.caption-wrapper')\n            @file_info_ctlr.el.style.left   = (captionWrapper.offsetLeft + 42) + 'px'\n\n        start: ()->\n            @FIC_container.addEventListener(\"mousemove\", @mouseMoved, false)\n            @isInCol = true\n\n        stop : ()->\n            @FIC_container.removeEventListener(\"mousemove\", @mouseMoved, false)\n\n\n\n\n","BaseView       = require '../lib/base_view'\nModalView      = require \"./modal\"\nModalShareView = null\nTagsView       = require \"../widgets/tags\"\nProgressBar    = require '../widgets/progressbar'\nclient         = require \"../lib/client\"\n\nmodule.exports = class FileView extends BaseView\n\n    template     : require './templates/file'\n    templateEdit : require './templates/file_edit'\n\n    getRenderData: ->\n        _.extend super(),\n            isUploading       : @model.isUploading()\n            isServerUploading : @model.isServerUploading()\n            isBroken          : @model.isBroken()\n            attachmentUrl     : @model.getAttachmentUrl()\n            downloadUrl       : @model.getDownloadUrl()\n            clearance         : @model.getClearance()\n            isViewSelected    : @model.isViewSelected()\n\n\n    initialize: (options) ->\n        @isSearchMode = options.isSearchMode\n        @uploadQueue  = options.uploadQueue\n\n        # prevent contacts loading in shared area\n        unless app.isPublic\n            ModalShareView ?= require './modal_share'\n\n\n    beforeRender: ->\n        # If the model is a folder, listen to the upload queue to enable or\n        # disable the \"something is being uploaded in my tree\" indicator.\n        if @model.isFolder()\n            path = @model.getRepository()\n            numUploadChildren = @uploadQueue.getNumUploadingElementsByPath path\n            @hasUploadingChildren = numUploadChildren > 0\n        else\n            @hasUploadingChildren = false\n\n\n    afterRender: ->\n        @el.displayMode = 'normal'\n        @filePath    = @$ 'a.file-path'\n        @elementLink = @$ 'a.link-wrapper'\n        @elementName = @elementLink.find '.file-name'\n        @thumb       = (@elementLink.find 'img.thumb')[0]\n        @elementSize = @$ '.size-column-cell'\n        @elementType = @$ '.type-column-cell'\n        @elementLastModificationDate = @$ '.date-column-cell'\n        @elementIcon = @$ '.icon-type'\n\n        @$el.data('cid', @model.cid) # link between the element and the model\n        @$el.addClass('itemRow')\n\n        # all displayed files are in searchMode or none. That's why we can set\n        # the line is search mode once for all.\n        if @isSearchMode\n            @filePath.show()\n\n        # add tags\n        @tags = new TagsView\n            el   : @$ '.tags'\n\n        # When folders are drag and drop, they can be clicked before being\n        # actually created, resulting in an error. Folders don't rely\n        # on `isUploading` because it is needless, so they are treated\n        # separately.\n        @blockNameLink() if @model.isNew()\n        @showLoading()   if @hasUploadingChildren\n        @reDecorate()\n\n\n    reDecorate: ->\n        # console.log 'reDecorate, displaymode=', @el.displayMode, @isSearchMode\n\n        # by default a line is not on edit mode. If the moved row was in edit\n        # mode, just re-render the line not to be in edit mode.\n        if @el.displayMode == 'edit'\n            @render()\n            return\n\n        @beforeRender()\n\n        # get data\n        renderData = @getRenderData()\n        if @model.isFolder()\n            link = \"#folders/#{renderData.model.id}\"\n            size = ''\n            type = 'folder'\n        else\n            if @model.isImage()\n                link = renderData.attachmentUrl\n            else\n                link = renderData.downloadUrl\n            size = renderData.model.size or 0\n            size = filesize(size, base: 2)\n            type = renderData.model.class\n\n        # update path if in search mode\n        if @isSearchMode\n            @filePath.html @model.attributes.path\n            # todo : find the parent folder id to that users can click on path\n            # 2 solutions :\n            #     get the data from the server for the files (perf...)\n            #     get the data only on click : create a special route to point\n            #     on the parent, exemple : /files/fileid/parent\n            # the first one is less performant and more complex (async)\n            # the second gives a path that is not sustainable.\n            # @filePath[0].href = \"/#folders/\" + @model.attributes.parentFolderID\n\n        # update the icon.\n        # Can be a file (its mime type) or a folder or an image or a thumbnail.\n        iconType = @model.getIconType()\n        @elementIcon.attr 'class', \"icon-type #{iconType}\"\n\n        # in case of a thumbnail, update src\n        if iconType == 'type-thumb'\n            @thumb.src = @model.getThumbUrl()\n\n        # show sharing status icon if necessary\n        if @model.isShared()\n            @elementIcon.addClass 'shared'\n        else\n            @elementIcon.removeClass 'shared'\n\n        # update file link url\n        @elementLink.attr 'href', link\n\n        # update tags\n        @tags.refresh(@model)\n\n        # update name, size and type\n        @elementName.html renderData.model.name\n        @elementSize.html size\n        @elementType.html t(type)\n\n        # update last modification\n        lastModification = renderData.model.lastModification\n        if lastModification\n            m = moment(lastModification)\n            lastModification = m.calendar()\n            longLastModification = m.format('lll')\n        else\n            lastModification = ''\n            longLastModification = ''\n        @elementLastModificationDate.html lastModification\n        @elementLastModificationDate.attr 'title', longLastModification\n\n        # link between the element and the model\n        @$el.data 'cid', @model.cid\n\n        if @model.isUploading() or @model.isServerUploading()\n            @addProgressBar()\n            @blockDownloadLink()\n            @blockNameLink()\n        else\n            @removeProgressBar() if @progressbar?\n            @$el.toggleClass 'broken', @model.isBroken()\n\n\n        # When folders are drag and drop, they can be clicked before being\n        # actually created, resulting in an error. Folders don't rely\n        # on `isUploading` because it is needless, so they are treated\n        # separately.\n        if @model.isNew()\n            @blockNameLink()\n\n        # TODO : avoid or adapt to an update operation\n        @hideLoading()\n        @showLoading() if @hasUploadingChildren\n\n\n    onUploadComplete: ->\n        if @model.isFolder()\n            @hasUploadingChildren = false\n            @hideLoading()\n\n\n    onCollectionChanged: ->\n        if @model.isFolder()\n            path = @model.getRepository()\n\n            hasItems = @uploadQueue.getNumUploadingElementsByPath(path) > 0\n            if hasItems and not @$('.spinholder').is ':visible'\n                @showLoading()\n            else if not hasItems and @$('.spinholder').is ':visible'\n                @hideLoading()\n\n\n    onSyncError: ->\n        # For overwritten files, render entirely to show\n        # modification date and type. Render folders unless they are in\n        # an errored state.\n        if @model.isConflict() or (@model.isFolder() and not @isErrored)\n            @render()\n\n\n    refresh: ->\n        changes = Object.keys @model.changed\n\n        if changes.length is 1\n            if changes[0] is 'tags'\n                return # only tags has changed, TagsView handle it\n\n        # more complex change = rerender\n        @render()\n\n\n    displayError: (message) ->\n\n        cancelButton =  @$ '.file-edit-cancel'\n        @errorField ?= $('<span class=\"error\">').insertAfter cancelButton\n\n        if message isnt false\n            @errorField.text message\n            @errorField.show()\n            @isErrored = true\n        else\n            @errorField.hide()\n            @isErrored = false\n\n\n    onTagClicked: ->\n        @tags.showInput()\n\n\n    onDeleteClicked: ->\n        new ModalView t('modal are you sure'), t('modal delete msg'), t('modal delete ok'), t('modal cancel'), (confirm) =>\n            if confirm\n                window.pendingOperations.deletion++\n                @model.destroy\n                    success: -> window.pendingOperations.deletion--\n                    error: ->\n                        window.pendingOperations.deletion--\n                        ModalView.error t 'modal delete error'\n\n    ###*\n     * Triggers the input to rename the file/folder\n    ###\n    onEditClicked: (name) ->\n        @el.displayMode = 'edit'\n        @$el.addClass('edit-mode')\n        width = @$('.caption').width() + 10\n        model = @model.toJSON()\n        model.class = 'folder' unless model.class?\n\n        if typeof(name) is 'string'\n            model.name = name\n\n        # change the template\n        clearance = @model.getClearance()\n        iconClass = 'icon-type'\n        if clearance == 'public' or (clearance && clearance.length > 0)\n            iconClass += ' shared'\n        iconType = @model.getIconType()\n        iconClass += ' ' + iconType\n        if iconType == 'type-thumb'\n            thumbSrc = @model.getThumbUrl()\n        else\n            thumbSrc = ''\n\n        @$el.html @templateEdit\n            model     : model\n            iconClass : iconClass\n            thumbSrc  : thumbSrc\n            clearance : clearance\n\n        # manage input\n        input$ = @$('.file-edit-name')\n        input  = input$[0]\n        if name is ''\n            input.placeholder = t 'new folder'\n        input$.width width\n        input$.focus()\n        input$.focusout () =>\n            @onSaveClicked()\n\n\n        # manage selection in the input :\n        # we only want to select the part before the file extension\n        # (the timeout otherwise there is a pb with the selection)\n        setTimeout () ->\n            lastIndexOfDot = model.name.lastIndexOf '.'\n            lastIndexOfDot = model.name.length if lastIndexOfDot is -1\n\n            if typeof input.selectionStart isnt 'undefined'\n                input.selectionStart = 0\n                input.selectionEnd = lastIndexOfDot\n            else if document.selection and document.selection.createRange\n                # IE Branch...\n                input.select()\n                range = document.selection.createRange()\n                range.collapse true\n                range.moveStart 'character', 0\n                range.moveEnd 'character', lastIndexOfDot\n                range.select()\n\n\n\n    onShareClicked: ->\n        new ModalShareView model: @model\n\n\n    onSaveClicked: ->\n        name = @$('.file-edit-name').val()\n\n        # Prevent empty names (with spaces only).\n        name = name?.trim()\n\n        # If the name has not changed, reset the view state.\n        if name and name is @model.get('name')\n            @onCancelClicked()\n\n        # If the input is not empty, start the update process.\n        else if name and name isnt \"\"\n            @$el.removeClass 'edit-mode'\n\n            # Show the loading indicator.\n            @showLoading()\n\n            # Hide the previous error in case there was one.\n            @displayError false\n\n            # Prevent re-submit/cancel during the save request.\n            @undelegateEvents()\n\n            # Mark submit/cancel buttons as disabled during the request.\n            @$('a.btn').addClass 'disabled'\n\n            # Pause the realtime during the request, because sometimes the\n            # realtime notification is received and processed by the client,\n            # before the request's response to the `save` request. It leads to\n            # a duplication of the model (two models with the exact same\n            # attributes), and as a result, in the UI.\n            options = ignoreMySocketNotification: true\n            window.app.socket.pause @model, null, options\n\n            @model.save name: name,\n                wait: true,\n                success: (data) =>\n\n                    # Resume the realtime, now the response has been received.\n                    window.app.socket.resume @model, null, options\n\n                    # Hide the loading indicator.\n                    @hideLoading()\n\n                    # Re-enable events handling for the view.\n                    @delegateEvents()\n\n                    # Render will remove the edit form, and display the folder\n                    # properly.\n                    @render()\n\n                error: (model, err) =>\n\n                    # Resume the realtime, now the response has been received.\n                    window.app.socket.resume @model, null, options\n\n                    # Hide the loading indicator.\n                    @hideLoading()\n\n                    # Re-enable submit/cancel buttons for future edit.\n                    @$('a.btn').removeClass 'disabled'\n                    @delegateEvents()\n\n                    # Focus the input field to allow the user to edit\n                    # immediately.\n                    @$('.file-edit-name').focus()\n\n                    # Customize the error if status is 400, which means the file\n                    # or the folder already exists.\n                    if err.status is 400\n                        message = t 'modal error in use'\n                    else\n                        message = t 'modal error rename'\n\n                    @displayError message\n\n        # If the input is empty, show an error.\n        else\n            @displayError t('modal error empty name')\n\n\n    onCancelClicked: ->\n        @$el.removeClass 'edit-mode'\n\n        # If it's a new folder, cancel should stop the creation.\n        if @model.isNew()\n            @model.destroy()\n\n        # Otherwise, the edition mode is just disabled.\n        else\n            @render()\n\n\n    # Cancel current upload. Then display a notification that the upload has\n    # been canceled for two seconds before removing the whole file line.\n    onCancelUploadClicked: ->\n        @uploadQueue.abort @model\n\n\n    # when a file link (icon or name) is clicked, choose the action to lauch\n    onFileLinkClicked: (e)=>\n        # if an image, launch the gallerie viewer, otherwise let the browser\n        # open the link in a new window\n        if @model.attributes.mime?.substr(0,5)=='image'\n            # ctrl + click on an img => open in new window, nothing to do\n            if e.ctrlKey\n                return\n            window.app.gallery.show(@model)\n            e.preventDefault()\n\n\n    # When a line is clicked, it should mark the item as selected, unless the\n    # user clicked a button.\n    onLineClicked: (event) ->\n        # List of selectors that will prevent the selection if they, or one\n        # of their children, have been clicked.\n        forbiddenSelectors = [\n            '.operations'\n            '.tags'\n            '.link-wrapper'\n            'a.file-edit-save'\n            'a.file-edit-cancel'\n            'span.error'\n            '.selector-wrapper'\n        ]\n\n        if @$el.hasClass('edit-mode')\n            return\n\n        t = event.target\n        for sel in forbiddenSelectors\n            if $(t).parents(sel).length != 0 or t.matches(sel)\n                return\n\n        isShiftPressed = event.shiftKey or false\n        window.getSelection().removeAllRanges()\n        @model.toggleViewSelected isShiftPressed\n\n\n    ###\n    # called when the user edits the name of the file or folder\n    ###\n    onKeyPress: (e) =>\n\n        if e.keyCode is 13 # ENTER key\n            @onSaveClicked()\n\n        else if e.keyCode is 27 # ESCAPE key\n            @onCancelClicked()\n\n        else if e.keyCode is 40 # DOWN key : edit next file\n            next = this.$el.next()\n            if next.length == 0\n                return\n            @onSaveClicked()\n            next.find('a.file-edit').click()\n\n        else if e.keyCode is 38 # UP key : edit previous file\n            prev = this.$el.prev()\n            if prev.length == 0\n                return\n            @onSaveClicked()\n            prev.find('a.file-edit').click()\n\n\n    onSelectClicked: (event) ->\n        isShiftPressed = event.shiftKey or false\n        @model.toggleViewSelected isShiftPressed\n\n\n    onToggleSelect: ->\n        isViewSelected = @model.isViewSelected()\n        @$el.toggleClass 'selected', isViewSelected\n\n        if isViewSelected\n            @$('.selector-wrapper i').removeClass 'fa-square-o'\n            @$('.selector-wrapper i').addClass 'fa-check-square-o'\n        else\n            @$('.selector-wrapper i').removeClass 'fa-check-square-o'\n            @$('.selector-wrapper i').addClass 'fa-square-o'\n\n\n    # add and display progress bar.\n    addProgressBar: ->\n        console.log 'addProgressBar', @progressbar\n\n        @removeProgressBar() if @progressbar?\n        @$el.addClass 'uploading'\n        @$('.type-column-cell').hide()\n        @$('.date-column-cell').hide()\n\n        @progressbar = new ProgressBar model: @model\n        @cell = $ '<td colspan=\"2\" class=\"progressbar-cell\" role=\"gridcell\"></td>'\n        @cell.append @progressbar.render().$el\n        @$('.size-column-cell').after @cell\n\n\n    # remove progress bar.\n    removeProgressBar: ->\n        console.log 'removeProgressBar', @progressbar\n        @$('.type-column-cell').show()\n        @$('.date-column-cell').show()\n        @$el.removeClass 'uploading'\n        if @progressbar?\n            @progressbar.destroy()\n            @progressbar = null\n            console.log  'destroyed?', @progressbar\n        @cell.remove()\n\n\n    # Make download link inactive.\n    blockDownloadLink: ->\n        @$('a.caption.btn').click (event) -> event.preventDefault()\n\n\n    # Make name link inactive.\n    blockNameLink: ->\n        @$('.link-wrapper > a').click (event) -> event.preventDefault()\n\n\n    # Show loading spinner.\n    showLoading: ->\n        @$('.link-wrapper .fa').addClass 'hidden'\n        @$('.spinholder').css 'display', 'inline-block'\n\n\n    # Hide loading spinner.\n    hideLoading: ->\n        @$('.link-wrapper .fa').removeClass 'hidden'\n        @$('.spinholder').hide()\n","#ViewCollection = require '../lib/view_collection'\nBaseView = require '../lib/base_view'\nFileView = require './file_view'\nLongList = require '../lib/long-list-rows'\nFileInfo = require './file_info'\n\nmodule.exports = class FilesView extends BaseView #ViewCollection\n    template: require './templates/files'\n    el: '#files'\n\n    itemview: FileView\n    collectionEl: '#table-items-body'\n\n    events:\n        'click #up-name'               : 'onChangeOrder'\n        'click #down-name'             : 'onChangeOrder'\n        'click #up-class'              : 'onChangeOrder'\n        'click #down-class'            : 'onChangeOrder'\n        'click #up-size'               : 'onChangeOrder'\n        'click #down-size'             : 'onChangeOrder'\n        'click #up-lastModification'   : 'onChangeOrder'\n        'click #down-lastModification' : 'onChangeOrder'\n\n        # Event delegation.\n        'click a.link-wrapper'              : (e) -> @viewProxy 'onFileLinkClicked'    , e\n        'click a.file-tags'                 : (e) -> @viewProxy 'onTagClicked'         , e\n        'click a.file-delete'               : (e) -> @viewProxy 'onDeleteClicked'      , e\n        'click a.file-share'                : (e) -> @viewProxy 'onShareClicked'       , e\n        'click a.file-edit'                 : (e) -> @viewProxy 'onEditClicked'        , e\n        'click a.file-edit-save'            : (e) -> @viewProxy 'onSaveClicked'        , e\n        'click a.file-edit-cancel'          : (e) -> @viewProxy 'onCancelClicked'      , e\n        'click a.file-move'                 : (e) -> @viewProxy 'onMoveClicked'        , e\n        'click a.broken-button'             : (e) -> @viewProxy 'onDeleteClicked'      , e\n        'keydown input.file-edit-name'      : (e) -> @viewProxy 'onKeyPress'           , e\n        'click li.itemRow'                  : (e) -> @viewProxy 'onLineClicked'        , e\n        'click a.cancel-upload-button'      : (e) -> @viewProxy 'onCancelUploadClicked', e\n        'click div.selector-wrapper button' : (e) -> @viewProxy 'onSelectClicked'      , e\n        'mouseenter .icon-type': (e) -> @viewProxy 'onFileLinkOver'       , e\n        'mouseleave .icon-type': (e) -> @viewProxy 'onFileLinkOut'        , e\n\n    initialize: (options) ->\n        super options\n\n        @itemViewOptions = ->\n            isSearchMode: options.isSearchMode\n            uploadQueue: options.uploadQueue\n\n        @numSelectedElements = options.numSelectedElements\n\n        @chevron = order: @collection.order, type: @collection.type\n\n        @listenTo @collection, 'add', @addFile\n        @listenTo @collection, 'remove', @removeFile\n        @listenTo @collection, 'sort', @render\n\n        # Event delegation.\n        @listenTo @collection, 'change', _.partial(@viewProxy, 'refresh')\n        @listenTo @collection, 'sync error', _.partial(@viewProxy, 'onSyncError')\n        @listenTo @collection, 'toggle-select', _.partial(@viewProxy, 'onToggleSelect')\n        @listenTo @collection, 'add remove reset',  _.partial(@viewProxy, 'onCollectionChanged')\n        @listenTo @collection, 'upload-complete',  _.partial(@viewProxy, 'onUploadComplete')\n\n\n\n    addFile: (model, collection, options) ->\n        @longList.addRow(collection.indexOf(model))\n        @updateNbFiles()\n\n\n    removeFile: (model, collection, options) ->\n        @longList.removeRow(options.index)\n        @updateNbFiles()\n\n\n    getRenderData: ->\n        _.extend super(),\n            numSelectedElements: @numSelectedElements\n            numElements: @collection.size()\n\n\n    beforeRender: ->\n        super()\n        @startPoint = performance.now()\n\n\n    afterRender: ->\n        super()\n        @displayChevron @chevron.order, @chevron.type\n        @updateNbFiles()\n\n        # Pool of views that matches the buffer of elements of LongList.\n        @pool = []\n\n        # LongList options.\n        options =\n            # unit used for the dimensions (px,em or rem)\n            DIMENSIONS_UNIT : 'px' #'em'\n\n            # Height reserved for each row (unit defined by DIMENSIONS_UNIT)\n            ROW_HEIGHT      : 48 #2\n\n            # number of \"screens\" before and after the viewport\n            # (ex : 1.5 => 1+2*1.5=4 screens always ready)\n            BUFFER_COEF   : 4\n\n            # number of \"screens\" before and after the viewport corresponding to\n            # the safe zone. The Safe Zone is the rows where viewport can go\n            # without trigering the movement of the buffer.\n            # Must be smaller than BUFFER_COEFF\n            SAFE_ZONE_COEF  : 3\n\n            # minimum duration between two refresh after scroll (ms)\n            THROTTLE        : 60\n\n            # max number of viewport height by seconds : beyond this speed the\n            # refresh is delayed to the nex throttle\n            MAX_SPEED       : 1.5\n\n            # call back when a row of the buffer is moved and must be completly\n            # redecorated\n            onRowsMovedCB   : @onRowsMoved.bind(@)\n\n        # DOM element the LongList will be bound to.\n        viewPortElement = @$(@collectionEl)[0]\n\n        # Initialize the list.\n        @longList = new LongList viewPortElement, options\n        @longList.initRows @collection.length\n\n        # init the file info popover\n        this.fileInfoCtrlr = new FileInfo(@$('.file-info')[0])\n\n\n    # Handler called when the list must update.\n    onRowsMoved: (rowsToDecorate) ->\n\n        for row, index in rowsToDecorate\n            if row.el\n                rank = row.rank\n                if row.el.view?\n                    model = @collection.at rank\n                    if model\n                        model.rank = rank\n                        view = row.el.view\n                        view.model = model\n                        view.reDecorate()\n\n                else\n                    model = @collection.at rank\n                    model.rank = rank\n                    options = _.extend {}, {model}, @itemViewOptions()\n                    view = new FileView options\n                    view.setElement row.el\n                    view.render()\n\n                    row.el.view = view\n                    @pool.push view\n\n        return true\n\n\n    # Manage event delegation. Events are listen to on the collection level,\n    # then the callback are called on the view that originally triggered them.\n    #\n    # * `methodName` is the method that will be called on the View.\n    # * `object` can be a File model or a DOMElement within FileView.$el\n    viewProxy: (methodName, object) ->\n\n        # Get view's cid. Views are indexed by cid. Object can be a File model\n        # or a DOMElement within FileView.$el.\n        if object.cid?\n            cid = object.cid\n        else\n            cid = @$(object.target).parents('li').data 'cid'\n\n            unless cid?\n                cid = @$(object.currentTarget).data 'cid'\n\n        # Get the view.\n        view = _.find @pool, (view) -> view.model.cid is cid\n\n        # In case of deletion, view may not exist anymore.\n        # If model isn't attached to a view in the pool, it is not found.\n        if view?\n            # Call `methodName` on the related view.\n            args = [].splice.call arguments, 1\n            if methodName == 'onFileLinkOver'\n                @onFileLinkOver view, args\n                return\n            else if methodName == 'onFileLinkOut'\n                @onFileLinkOut view, args\n                return\n            else\n                view[methodName].apply view, args\n                return\n        else\n            return\n\n\n    # display file info popover if relevant\n    onFileLinkOver: (targetView, event) ->\n        @fileInfoCtrlr.onEnterLink(targetView)\n\n\n    # hide file info popover if relevant\n    onFileLinkOut: (targetView, event) ->\n        @fileInfoCtrlr.onExitLink(targetView)\n\n\n    updateNbFiles: ->\n        nbElements = @collection.length\n\n        if nbElements > 0\n            @$(\"#file-amount-indicator\").html t 'element',\n                smart_count: nbElements\n            @$(\"#file-amount-indicator\").show()\n            @$(\"#no-files-indicator\").hide()\n        else\n            @$(\"#file-amount-indicator\").hide()\n            @$(\"#no-files-indicator\").show()\n\n    # Helpers to display correct chevron to sort files\n    displayChevron: (order, type) ->\n\n        if order is \"asc\"\n            @$(\"#up-#{type}\").addClass 'active'\n            @$(\"#up-#{type}\").removeClass 'unactive'\n            @$(\"#up-#{type}\").show()\n            @$(\"#down-#{type}\").removeClass 'active'\n            @$(\"#down-#{type}\").addClass 'unactive'\n            @$(\"#down-#{type}\").hide()\n        else\n            @$(\"#down-#{type}\").addClass 'active'\n            @$(\"#down-#{type}\").removeClass 'unactive'\n            @$(\"#down-#{type}\").show()\n            @$(\"#up-#{type}\").removeClass 'active'\n            @$(\"#up-#{type}\").addClass 'unactive'\n            @$(\"#up-#{type}\").hide()\n\n\n    # Changer sorting depending on the clicked chevron.\n    onChangeOrder: (event) ->\n        [order, type] = event.target.id.split '-'\n\n        order = if order is 'up' then 'desc' else 'asc'\n\n        @chevron = order: order, type: type\n        @collection.order = order\n        @collection.type = type\n        @collection.sort()\n\n    # Update inherited clearance. It's useful when the folder state is changed.\n    # It updates the displayed icon and the sharing state.\n    updateInheritedClearance: (clearance) ->\n        if clearance? and clearance.length > 0 and clearance[0].clearance?\n            for file in @collection.models\n                file.set 'inheritedClearance', clearance\n\n    destroy: ->\n        @stopListening @collection\n        super()\n","BaseView         = require '../lib/base_view'\nFilesView        = require './files'\nBreadcrumbsView  = require \"./breadcrumbs\"\nUploadStatusView = require './upload_status'\nModal            = require './modal'\nModalBulkMove    = require './modal_bulk_move'\nModalConflict    = require './modal_conflict'\nModalShareView   = null\n\nFile             = require '../models/file'\n\nBACKSPACE_KEY = 8\n\n###\nHandles the display logic for a folder.\nMain entry point of the interface: handles breadcrumb, buttons and files list\n###\nmodule.exports = class FolderView extends BaseView\n\n    el: 'body'\n\n    template: require './templates/folder'\n\n    events: ->\n        'click #button-new-folder': 'onNewFolderClicked'\n        'click #cancel-new-folder': 'onCancelFolder'\n        'click #cancel-new-file': 'onCancelFile'\n        'click #share-state': 'onShareClicked'\n        'click #download-link': 'onDownloadAsZipClicked'\n        'change #uploader': 'onFilesSelected'\n        'change #folder-uploader': 'onDirectorySelected'\n\n        'click #select-all': 'onSelectAllChanged'\n        'click .container': 'onDeselectAll'\n\n        'click #button-bulk-download': 'bulkDownload'\n        'click #button-bulk-remove': 'bulkRemove'\n        'click #button-bulk-move': 'bulkMove'\n\n        'dragstart #files': 'onDragStart'\n        'dragenter #files': 'onDragEnter'\n        'dragover #files': 'onDragEnter'\n        'dragleave #files': 'onDragLeave'\n        'drop #files': 'onDrop'\n\n        'keyup input#search-box': 'onSearchKeyPress'\n\n    initialize: (options) ->\n        super options\n        @baseCollection = options.baseCollection\n        @uploadQueue = options.uploadQueue\n\n        # not empty only if a search has started\n        @query = options.query\n\n        # prevent contacts loading in shared area\n        unless app.isPublic\n            ModalShareView ?= require \"./modal_share\"\n\n        # refresh folder action buttons after bulk actions\n        @listenTo @baseCollection, 'toggle-select', @toggleFolderActions\n        @listenTo @collection, 'remove', @toggleFolderActions\n\n        # when clearance is saved, we update the share button's icon\n        @listenTo @model, 'sync', @onFolderSync\n\n        # We create a queue to manage conflict, that process one item at a time\n        # so we can use a remembered choice\n        @conflictQueue = async.queue @resolveConflict.bind(@), 1\n        @conflictRememberedChoice = null\n\n        # reset remembered choice when all conflicts have been resolved\n        @conflictQueue.drain = => @conflictRememberedChoice = null\n\n        # adding the model to the queue when a conflict is detected by the\n        # upload queue\n        @listenTo @uploadQueue, 'conflict', @conflictQueue.push\n        @listenTo @uploadQueue, 'folderError', @onMozFolderError\n        @listenTo @uploadQueue, 'existingFolderError', @onExistingFolderError\n\n        return this\n\n    resolveConflict: (model, done) ->\n\n        # if the user has selected the remember choice option\n        # it is not asked again\n        if @conflictRememberedChoice?\n            model.solveConflict @conflictRememberedChoice\n            done()\n        else\n            # Ask the user his choice about overwriting the file\n            new ModalConflict model, (choice, rememberChoice) =>\n\n                # save the remembered choice if the user has set it\n                if rememberChoice?\n                    @conflictRememberedChoice = rememberChoice\n\n                model.solveConflict choice\n\n                done()\n\n    destroy: ->\n        # reset selection for each models\n        @collection.forEach (element) -> element.isSelected = false\n\n        # properly destroy subviews\n        @breadcrumbsView.destroy()\n        @breadcrumbsView = null\n        @filesList.destroy()\n        @filesList = null\n\n        # terminates conflict queue\n        @conflictQueue.kill()\n        @conflictQueue = null\n\n        super()\n\n    getRenderData: ->\n        supportsDirectoryUpload: @testEnableDirectoryUpload()\n        model: @model.toJSON()\n        clearance: @model.getClearance()\n        query: @query\n        zipUrl: @model.getZipURL()\n\n\n    afterRender: ->\n        @uploadButton = @$ '#button-upload-new-file'\n\n        # breadcrumb management\n        @renderBreadcrumb()\n\n        # files list management\n        @renderFileList()\n\n        # upload status management\n        @renderUploadStatus()\n\n        # We make a reload after the view is displayed to update\n        # the client without degrading UX, unless it's the first time the folder\n        # is rendered (data has just been loaded).\n        if @model.hasContentBeenRendered()\n            @refreshData()\n            @$(\"#loading-indicator\").show()\n        else\n            @model.isContentRendered = true\n            @$(\"#loading-indicator\").hide()\n\n    renderBreadcrumb: ->\n        @$('#crumbs').empty()\n        @breadcrumbsView = new BreadcrumbsView\n            collection: @model.breadcrumb\n            model: @model\n        @$(\"#crumbs\").append @breadcrumbsView.render().$el\n\n    renderFileList: ->\n\n        @filesList = new FilesView\n            model: @model\n            collection: @collection\n            uploadQueue: @uploadQueue\n            numSelectedElements: @getSelectedElements().length\n            isSearchMode: @model.get('type') is \"search\"\n\n        @filesList.render()\n\n    renderUploadStatus: ->\n        @uploadStatus = new UploadStatusView\n            collection: @uploadQueue.uploadCollection\n            uploadQueue: @uploadQueue\n\n        @uploadStatus.render().$el.appendTo @$('#upload-status-container')\n\n    spin: (state=true) ->\n        if state\n            @$(\"#loading-indicator\").show()\n        else\n            @$(\"#loading-indicator\").hide()\n\n    # Refresh folder's content and manage spinner\n    refreshData: ->\n        @spin()\n        @baseCollection.getFolderContent @model, =>\n            @spin false\n\n            # if the inherited clearance has changed, we need to refresh\n            # the share button's icon\n            @onFolderSync()\n\n    ###\n        Button handlers\n    ###\n\n    onNewFolderClicked: ->\n\n        # There is already a new folder.\n        if @newFolder\n            # Look for the view into the pool.\n            view = _.find @filesList.pool, (view) =>\n                return view.model.cid is @newFolder.cid\n            view.$('.file-edit-name').focus()\n        else\n            @newFolder ?= new File\n                name: ''\n                type: 'folder'\n                path: @model.getRepository()\n                tags: [].concat(@model.get('tags'))\n\n            # Insert at the begining to prevent useless sorting.\n            @baseCollection.add @newFolder, at: 0\n\n            # Look for the view into the pool.\n            view = _.find @filesList.pool, (view) =>\n                return view.model.cid is @newFolder.cid\n            view.onEditClicked ''\n\n            @newFolder.once 'sync destroy', => @newFolder = null\n\n    onShareClicked: ->\n        new ModalShareView\n            model: @model\n\n    ###\n        Drag and Drop and Upload\n    ###\n    onDragStart: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n\n    onDragEnter: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        if not @isPublic or @canUpload\n            @uploadButton.addClass 'btn-cozy-contrast'\n            @$('#files-drop-zone').show()\n\n    onDragLeave: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        if not @isPublic or @canUpload\n            @uploadButton.removeClass 'btn-cozy-contrast'\n            @$('#files-drop-zone').hide()\n\n    onDrop: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        return false if @isPublic and not @canUpload\n\n        # folder drag and drop is only supported in Chrome\n        if event.dataTransfer.items?\n            @onFilesSelectedInChrome event\n        else\n            @onFilesSelected event\n\n        @uploadButton.removeClass 'btn-cozy-contrast'\n        @$('#files-drop-zone').hide()\n\n    onDirectorySelected: (event) ->\n        input = @$ '#folder-uploader'\n        files = input[0].files\n        return unless files.length\n        @uploadQueue.addFolderBlobs files, @model\n        # reset the input\n        input.replaceWith input.clone true\n\n    onFilesSelected: (event) =>\n        files = event.dataTransfer?.files or event.target.files\n\n        if files.length\n            @uploadQueue.addBlobs files, @model\n\n\n    onFilesSelectedInChrome: (e) ->\n        items = e.dataTransfer.items\n        return unless items.length\n\n        files = []\n        errors = []\n\n        # Once all entries have been parsed, they are added to the upload queue.\n        addAllToQueue = =>\n\n            processUpload = =>\n                @uploadQueue.addFolderBlobs files, @model\n\n            if errors.length > 0\n                formattedErrors = errors\n                    .map (name) -> \"\\\"#{name}\\\"\"\n                    .join ', '\n                localeOptions =\n                    files: formattedErrors\n                    smart_count: errors.length\n\n                new Modal t('chrome error dragdrop title'), \\\n                    t('chrome error dragdrop content', localeOptions), \\\n                    t('chrome error submit'), null, (confirm) -> processUpload()\n            else\n                processUpload()\n\n\n        # An entry can be a folder or a file.\n        parseEntriesRecursively = (entry, path, done) =>\n            path = path or \"\"\n            path = \"#{path}/\" if path.length > 0\n\n            # If it's a file we add it to the file list with a proper\n            # relative path.\n            if entry.isFile\n                entry.file (file) ->\n                    file.relativePath = \"#{path}#{file.name}\"\n                    files.push file\n                    done()\n                , (error) ->\n                    errors.push entry.name\n                    done()\n\n            # If it's a directory, recursively call the function to reach\n            # the leaves of the file tree.\n            else if entry.isDirectory\n                reader = entry.createReader()\n\n                # .readEntries only return chunks of 100 elements, so it must\n                # be called multiple times, until there is no more entries.\n                do unshiftFolder = ->\n                    reader.readEntries (entries) ->\n                        if entries.length is 0\n                            done()\n                        else\n                            async.eachSeries entries, (subEntry, next) ->\n                                parseEntriesRecursively subEntry, \"#{path}#{entry.name}\", next\n                            , unshiftFolder\n\n        # Start the parsing process.\n        async.eachSeries items, (item, next) ->\n            entry = item.webkitGetAsEntry()\n            parseEntriesRecursively entry, null, next\n        , addAllToQueue\n\n\n    ###\n        Search\n    ###\n    onSearchKeyPress: (e) ->\n        if @searching isnt true\n            searching = true\n            setTimeout =>\n                query = @$('input#search-box').val().trim()\n\n                if query isnt ''\n                    route = \"#search/#{query}\"\n\n                # query is empty and backspace is pressed = returns to home\n                else if e.keyCode is BACKSPACE_KEY\n                    route = ''\n\n                # nothing should be done\n                else\n                    route = null\n\n                window.app.router.navigate route, true if route?\n                searching = false\n            , 1000\n\n    # Refreshes the view by changing the files list\n    # we basically re-do @initialize but only render file list\n    # to prevent the focus loss in the search field\n    updateSearch: (model, collection) ->\n        @stopListening @model\n        @stopListening @collection\n        @model = model\n        @collection = collection\n\n        $('#upload-buttons').hide()\n\n        # the first time the view is displayed, it doesn't exist yet\n        if @filesList?\n            @filesList.destroy()\n            # because destroying the view also removes the element\n            @$('#loading-indicator').after $ '<div id=\"files\"></div>'\n        @renderBreadcrumb()\n        @renderFileList()\n\n\n    ###\n        Select elements management\n    ###\n    onSelectAllChanged: (event) ->\n        isChecked = @getSelectedElements().length is @collection.size()\n        @collection.forEach (model) ->\n            model.setSelectedViewState not isChecked\n\n\n    onDeselectAll: (event) ->\n        if event.target.id is 'files'\n            @collection.forEach (model) ->\n                model.setSelectedViewState false\n\n\n    # Gets the number of selected elements from the collection\n    getSelectedElements: ->\n        return @collection.filter (model) -> return model.isViewSelected()\n\n\n    # we don't show the same actions wether there are selected elements or not\n    toggleFolderActions: (event) ->\n        {isShiftPressed} = event\n\n        selectedElements = @getSelectedElements()\n\n        # If shift key is hold, the user wants to select multiple elements in\n        # one click.\n        if isShiftPressed\n            @handleSelectWithShift()\n\n        if selectedElements.length > 0\n            @$('#share-state').hide()\n            @$('#button-upload-new-file').hide()\n            @$('#button-upload-folder').hide()\n            @$('#button-new-folder').hide()\n            @$('#download-link').hide() # in public area\n            @$('#bulk-actions-btngroup').addClass 'enabled'\n\n            if app.isPublic\n                @$('#bulk-actions-btngroup').show()\n                @$('#button-bulk-download').show()\n\n        else\n            if app.isPublic\n                @$('#download-link').show() # in public area\n                clearance = @model.getClearance()?[0]\n                if $('body').hasClass 'can-upload'\n                    @$('#button-upload-new-file').show()\n                    @$('#button-upload-folder').show()\n                    @$('#button-new-folder').show()\n                @$('#bulk-actions-btngroup').hide()\n                @$('#button-bulk-download').hide()\n            else\n                @$('#share-state').show()\n                @$('#button-upload-new-file').show()\n                @$('#button-upload-folder').show()\n                @$('#button-new-folder').show()\n                @$('#bulk-actions-btngroup').removeClass 'enabled'\n\n\n        # Check if all checkbox should be selected. It is selected\n        # when it's forced or when collection length == amount of selected\n        # files\n        if selectedElements.length is 0 or @collection.size() is 0\n            @$('#select-all i').removeClass 'fa-minus-square-o'\n            @$('#select-all i').removeClass 'fa-check-square-o'\n            @$('#select-all i').addClass 'fa-square-o'\n        else if selectedElements.length is @collection.size()\n            @$('#select-all i').removeClass 'fa-square-o'\n            @$('#select-all i').removeClass 'fa-minus-square-o'\n            @$('#select-all i').addClass 'fa-check-square-o'\n        else\n            @$('#select-all i').removeClass 'fa-square-o'\n            @$('#select-all i').removeClass 'fa-check-square-o'\n            @$('#select-all i').addClass 'fa-minus-square-o'\n\n\n    # Handle the selection of multiple items within a range.\n    handleSelectWithShift: ->\n        selectedElements = @getSelectedElements()\n\n        # There must be at least two items to be able to select items between\n        # them.\n        if selectedElements.length >= 2\n\n            # Define the range within items will be selected.\n            firstSelected = selectedElements[0]\n            lastSelected = selectedElements[selectedElements.length - 1]\n            firstSelectedIndex = @collection.indexOf firstSelected\n            lastSelectedIndex = @collection.indexOf lastSelected\n\n            @collection\n                # Get the items to select.\n                .filter (model, index) ->\n                    return firstSelectedIndex < index < lastSelectedIndex and\n                           not model.isViewSelected()\n\n                # Select them.\n                .forEach (model) -> model.toggleViewSelected()\n\n\n    ###\n        Bulk actions management\n    ###\n    bulkRemove: ->\n        new Modal t(\"modal are you sure\"), t(\"modal delete msg\"), \\\n                  t(\"modal delete ok\"), t(\"modal cancel\"), (confirm) =>\n            if confirm\n\n                # Mark elements as pending deletion.\n                selectedElements = @getSelectedElements()\n                window.pendingOperations.deletion += selectedElements.length\n\n                # Remove all models instead of removing one by one after each\n                # model.destroy, to prevent elements from disappearing in the\n                # meantime.\n                for model in selectedElements\n                    @baseCollection.remove(model)\n\n                # Filter the destroys' result to know which have failed so they\n                # can be re-added to the collection.\n                async.filter selectedElements, (model, next) ->\n                    model.destroy\n                        success: ->\n                            window.pendingOperations.deletion--\n                            next false\n                        error: ->\n                            window.pendingOperations.deletion--\n                            # Mark the model has not deleted on the server to it\n                            # can be re-added to the collection.\n                            next true\n\n                        silent: false\n                        wait: true\n\n                , (undeletedModels) =>\n                    # Re-add the models that have failed to be deleted on the\n                    # server.\n                    if undeletedModels.length > 0\n                        messageOptions = smart_count: undeletedModels.length\n                        Modal.error t(\"modal delete error\", messageOptions)\n                        sortedModelsInError = _.sortBy(\n                            undeletedModels\n                            , (model) -> return model.rank\n                        )\n                        for model in sortedModelsInError\n                            @baseCollection.add(model)\n\n\n    bulkMove: ->\n        new ModalBulkMove\n            collection: @getSelectedElements()\n            parentPath: @model.getRepository()\n\n    bulkDownload: ->\n        selectedElements = @getSelectedElements()\n        if selectedElements.length > 1\n            selectedPaths = selectedElements.map (element) ->\n                if element.isFolder()\n                    return \"#{element.getRepository()}/\"\n                else\n                    return \"#{element.getRepository()}\"\n            url = @model.getZipURL()\n\n            serializedSelection = selectedPaths.join ';'\n\n            # To trigger a download from a POST request, we must create an hidden\n            # form and submit it.\n            inputValue = \"\"\"\n            value=\"#{serializedSelection}\"\n            \"\"\"\n            form = \"\"\"\n            <form id=\"temp-zip-download\" action=\"#{url}\" method=\"post\">\n                <input type=\"hidden\" name=\"selectedPaths\" #{inputValue}/>\n            </form>\n            \"\"\"\n            $('body').append form\n            $('#temp-zip-download').submit()\n            $('#temp-zip-download').remove()\n\n        else\n            # download only file selected\n            a = document.createElement 'a'\n            a.href = selectedElements[0].getDownloadUrl()\n            a.dispatchEvent(new window.MouseEvent('click', 'view': window, 'bubbles': true, 'cancelable': true ))\n\n\n    ###\n        Misc\n    ###\n    testEnableDirectoryUpload: ->\n        input = $('<input type=\"file\">')[0]\n        supportsDirectoryUpload = input.directory? or\n                                  input.mozdirectory? or\n                                  input.webkitdirectory? or\n                                  input.msdirectory?\n        return supportsDirectoryUpload\n\n    # We don't want the user to download the ZIP if the folder is empty\n    onDownloadAsZipClicked: (event) ->\n        if @collection.length is 0\n            event.preventDefault()\n            Modal.error t 'modal error zip empty folder'\n\n    # Updates the share button's icon and content\n    onFolderSync: ->\n        clearance = @model.getClearance()\n        if clearance is 'public'\n            shareStateContent = \"\"\"\n                <span class=\"fa fa-globe\"></span>\n                <span class=\"text\">#{t 'shared'}</span>\n            \"\"\"\n        else if clearance? and clearance.length > 0\n            shareStateContent = \"\"\"\n                <span class=\"fa fa-globe\"></span>\n                <span class=\"text\">#{t 'shared'}</span>\n                <span>(#{clearance.length})</span>\n            \"\"\"\n        else\n            shareStateContent = \"\"\n\n        @$('#folder-state').html shareStateContent\n        @filesList.updateInheritedClearance [clearance: clearance]\n\n    # Display an error when the user tries to upload a folder in Firefox.\n    onMozFolderError: ->\n        Modal.error t('modal error firefox dragdrop folder')\n\n\n    # Display an error when the user tries to drag and drop an existing folder.\n    onExistingFolderError: (model) ->\n        Modal.error t('modal error existing folder', name: model.get('name'))\n\n\n","\n###*\n * this module is in charge of displaying a photo gallery when an image is\n * clicked\n###\nmodule.exports = class Gallery\n\n    ###*\n     * will open the diaporama when a photo is clicked\n     * @param  {BackboneModel} modelClicked Model of the file clicked\n    ###\n    show: (modelClicked) ->\n\n        # 1/ preprare the div of a fake thumbnail (input for baguettebox.js)\n        gal = document.getElementById('gallery')\n        if gal == null\n            gal = document.createElement('div')\n            gal.id = 'gallery'\n            gal.style.display = 'none'\n            document.body.appendChild gal\n        else\n            gal.innerHTML = ''\n\n        # 2/ populate the div with the links to the photo to display\n        a_toSimulateClick = null\n        window.app.router.folderView.collection.forEach (model)=>\n            if !model.isImage()\n                return\n            a      = document.createElement('a')\n            a.href = model.getScreenUrl()\n            gal.appendChild a\n            if model == modelClicked\n                a_toSimulateClick = a\n\n        # 3/ run baguetteBox\n        window.baguetteBox.run '#gallery',\n            captions  : true\n            buttons   : 'auto'\n            async     : false\n            preload   : 2\n            animation : 'slideIn'\n\n        # 4/ launch the display of the diaporama. For that we have to simulate\n        # a click on a thumbnail.\n        event = document.createEvent('MouseEvent')\n        event.initMouseEvent 'click', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null\n        event.preventDefault()\n        a_toSimulateClick.dispatchEvent event\n\n        return\n\n\n","BaseView = require '../lib/base_view'\n\nmodule.exports = class ModalView extends BaseView\n\n    id: \"dialog-modal\"\n    className: \"modal fade\"\n    attributes:\n        'tab-index': -1\n    template: require './templates/modal'\n    value: 0\n\n    events: ->\n        \"click #modal-dialog-no\"  : \"onNo\"\n        \"click #modal-dialog-yes\" : \"onYes\"\n\n    constructor: (@title, @msg, @yes, @no, @cb, @hideOnYes=true) ->\n        super()\n\n    initialize: ->\n        @$el.on 'hidden.bs.modal', @close.bind(@)\n\n        @render()\n        @show()\n\n    onYes: ->\n        @cb true if @cb\n        @hide()\n\n    onNo: ->\n        @cb false if @cb\n        @hide() if @hideOnYes\n\n    onShow: ->\n\n    close: ->\n        setTimeout @destroy.bind(@), 500\n\n    show: ->\n        @$el.modal 'show'\n        @$el.trigger 'show'\n\n    hide: ->\n        @$el.modal 'hide'\n        @$el.trigger 'hide'\n\n    render: ->\n        @$el.append @template title: @title, msg: @msg, yes: @yes, no: @no\n        $(\"body\").append @$el\n        @afterRender()\n        @\n\nmodule.exports.error = (code, cb) ->\n    new ModalView t(\"modal error\"), code, t(\"modal ok\"), false, cb\n","Modal = require \"./modal\"\nclient = require \"../lib/client\"\n\nmodule.exports = class ModalBulkMoveView extends Modal\n\n    formTemplate: -> \"\"\"\n            <div class=\"move-widget\">\n            <span> #{t 'move elements to'}: </span>\n            <select class=\"move-select\"></select>\n            </div>\n    \"\"\"\n\n    movedTemplate: (path) ->\n        \"\"\"\n        <div id=\"moved-infos\">\n        <span>#{ t 'elements successfully moved to'}: /#{path}.</span>\n        <button class=\"btn btn-link cancel-move-btn\">\n            #{t 'cancel'}\n        </button>\n        </div>\n    \"\"\"\n\n    optionTemplate: (path) -> \"\"\"\n        <option value=\"#{path}\">#{path}</option>\n    \"\"\"\n\n    constructor: (options) ->\n\n        super t('moving selected elements'), '', t('move'), t('close')\n\n        # collection is the selected elements\n        @collection = options.collection\n        @parentPath = options.parentPath\n\n    afterRender: ->\n        # retrieve list of all folders\n        client.get 'folders/list', (err, paths) =>\n            if err?\n                Modal.error err\n            else\n                # Add root folder to list.\n                paths.push '/' if @parentPath isnt  \"\"\n\n                # generate the list of paths where elements cannot be moved\n                # this list is composed of the selected folders\n                forbiddenPaths = @collection\n                    .filter (element) -> element.isFolder()\n                    .map (element) -> element.getRepository()\n\n                allowedPaths = _.filter paths, (path) =>\n                    # we append a / to prevent issue where folders\n                    # share the same prefix\n                    testedPath = path + '/'\n\n                    # if the path is a child of one of the forbidden paths\n                    # or the parent path, then it should not be displayed\n                    isAllowed = not _.some forbiddenPaths, (forbiddenPath) ->\n                        testedPath.indexOf(forbiddenPath) is 0\n\n                    return isAllowed and path isnt @parentPath\n\n                # Fill folder combobox with folder list.\n                @moveForm = $ @formTemplate()\n                for path in allowedPaths\n                    @moveForm.find('select').append @optionTemplate path\n\n                @$el.find('.modal-body').append @moveForm\n\n    onYes: ->\n        # Shows loading indicator\n        @$('#modal-dialog-yes').html t 'moving...'\n\n        # Gets the new path\n        newPath = $('.move-select').val().substring 1\n        previousPath = @parentPath\n\n        @bulkUpdate newPath, (err) =>\n            # Hides loading indicator\n            @$('#modal-dialog-yes').hide()\n\n            if err?\n                # Shows an error\n                Modal.error t 'modal error file exists'\n            else\n                # Shows the success form\n                @moveForm.fadeOut => @moveForm.remove()\n                movedInfos = $ @movedTemplate newPath\n\n                # Cancel handler\n                cancelButton =  movedInfos.find '.cancel-move-btn'\n                cancelButton.click =>\n                    @bulkUpdate previousPath, (err) =>\n                        if err?\n                            Modal.error t 'error occured canceling move'\n                        else\n                            @onNo()\n\n                @$el.find('.modal-body').append movedInfos\n\n    # Process the update for all the selected elements\n    bulkUpdate: (newPath, callback) ->\n        window.pendingOperations.move++\n        # Process the update 1 by 1\n        async.eachSeries @collection, (model, cb) ->\n            id = model.get 'id'\n            type = model.get 'type'\n            client.put \"#{type}s/#{id}\", path: newPath, cb\n        , (err) ->\n            window.pendingOperations.move--\n            callback err\n","Modal = require \"./modal\"\nclient = require \"../lib/client\"\n\nmodule.exports = class ModalConflictView extends Modal\n\n    conflictTemplate: ->\n        rememberLabel = t 'overwrite modal remember label'\n        return \"\"\"\n            <div class=\"move-widget\">\n            <p>#{t 'overwrite modal content', fileName: @model.get 'name'}</p>\n            <p>\n                <label for=\"rememberChoice\">#{rememberLabel}</label>\n                <input id=\"rememberChoice\" type=\"checkbox\"/>\n            </p>\n            </div>\n    \"\"\"\n\n    constructor: (@model, @callback) ->\n        super t('overwrite modal title'), '', \\\n              t('overwrite modal yes button'), \\\n              t('overwrite modal no button'), \\\n              @confirmCallback\n\n    confirmCallback: (confirm) ->\n        rememberChoice = @$('#rememberChoice').prop 'checked'\n        rememberedChoice = confirm if rememberChoice\n        @callback confirm, rememberedChoice\n\n    afterRender: ->\n        @conflictForm = $ @conflictTemplate()\n        @$el.find('.modal-body').append @conflictForm\n\n","BaseView = require '../lib/base_view'\nModal = require \"./modal\"\nclient = require \"../lib/client\"\nCozyClearanceModal = require \"cozy-clearance/modal_share_view\"\n\n# extends the cozy-clearance modal to files specifics\nmodule.exports = class ModalShareView extends CozyClearanceModal\n\n    # display inherited details on summary's click\n    events: -> _.extend super,\n        'click #inherited-share-summary a': =>\n            @$('#inherited-share-list').show()\n            @$('#inherited-share-summary').hide()\n\n    # retrieve inherited rules\n    initialize: (options) ->\n        @type = @model.get('type')\n        super\n        @summaryemails = []\n        client.get \"clearance/#{@model.id}\", (err, data) =>\n            if err\n                Modal.error 'server error occured', => @$el.modal 'hide'\n            else\n                @inherited = data.inherited\n\n                @forcedShared = @inherited.length > 0\n\n                @makePublic() if @isPrivateClearance()\n\n                # actually render content\n                @refresh()\n\n    # allow rw permissions for folder, customize message depending on type\n    permissions: ->\n        if @type is 'folder'\n            'r': 'perm r folder'\n            'rw': 'perm rw folder'\n        else\n            'r': t 'perm r file'\n\n    # do not allow adding permissions for user who already have them by inheritance\n    typeaheadFilter: (item) =>\n        email = item.toString().split(';')[0]\n        super and email not in @summaryemails\n\n    # force 'shared' display if forced shared by inheritance\n    getRenderData: ->\n        out = super\n        if @forcedShared\n            if @inherited?\n                if @inherited[0].clearance is 'public'\n                    out.clearance = 'public'\n                else\n                    guests = []\n                    for folder in @inherited\n                        guests.push guest for guest in folder.clearance\n                    out.clearance = @getClearanceWithContacts guests\n        return out\n\n    # ignore click on 'private' button when forced public by inheritance\n    makePrivate: ->\n        return if @forcedShared\n        super\n\n    # support forced public by inheritance and add inherited summary\n    afterRender: ->\n        super\n\n        if @forcedShared\n            @$('#share-public').addClass 'toggled'\n            @$('#select-mode-section').hide()\n\n            if @inherited[0].clearance is 'public'\n                text = t('forced public')\n                @$('#select-mode-section').after $('<p>').text text\n                $('#share-input').hide()\n                $('#add-contact').hide()\n                $('.input-group').prev('p').hide()\n                $('#public-url').removeClass 'disabled'\n                setTimeout ->\n                    $('#public-url').focus().select()\n                , 200\n            else\n                text = t('forced shared')\n                @$('#select-mode-section').after $('<p>').text text\n                $('#share-input').hide()\n                $('#add-contact').hide()\n                $('.input-group').prev('p').hide()\n                $('.input-group').prev('p').prev('p').hide()\n                $('#public-url').prev('p').hide()\n                $('#public-url').prev('p').prev('p').hide()\n                $('#public-url').hide()\n                $('.revoke').hide()\n                $('.changeperm').prop 'disabled', true\n\n            $('#modal-dialog-no').hide()\n            $('#modal-dialog-yes').html t('ok')\n\n        else\n            listitems = []\n            summary = []\n\n            for folder in @inherited when folder.clearance.length isnt 0\n                text = t('inherited from') + folder.name\n                listitems.push $('<li>').addClass('header').text text\n                for rule in folder.clearance when folder.clearance\n                    summary.push rule.email\n                    listitems.push $('<li>').text rule.email\n\n            if summary.length isnt 0\n                @summaryemails = summary\n                text = t('also have access') + ': ' + summary.join(', ') + '. '\n                summary = $('<div id=\"inherited-share-summary\">').text text\n                summary.append $('<a>').text t('details')\n                list = $('<ul id=\"inherited-share-list\">').hide()\n                list.append item for item in listitems\n                @$('#share-list').after summary, list\n\n        # if there is a writing guest\n        guestCanWrite = _.findWhere @model.get('clearance'), perm: 'rw'\n        if guestCanWrite\n            checkbox = $('<input id=\"notifs\" type=\"checkbox\">')\n            checkbox.prop 'checked', @model.get 'changeNotification'\n            text = t('change notif')\n            html = '<label class=\"notifs-label\" for=\"notifs\">'\n            label = $(html).append checkbox, text\n            @$('#share-list').after label\n\n\n    # include the changes notification in PUT request\n    saveData: ->\n        changeNotification = @$('#notifs').prop('checked') or false\n        _.extend super, changeNotification: changeNotification\n\n    onYes: ->\n        if @forcedShared\n            @close()\n        else\n            super()\n\n    onNo: ->\n        if @forcedShared\n            @close()\n        else\n            super()\n\n","FolderView = require './folder'\nclient = require '../lib/client'\n\nmodule.exports = class PublicFolderView extends FolderView\n\n    events: -> _.extend super,\n        'click #notifications': 'onToggleNotificationClicked'\n\n\n    initialize: (options) ->\n        super options\n        @rootFolder = options.rootFolder\n\n    afterRender: ->\n        super()\n\n        # we use those class to show/hide stuff via CSS (buttons, controls, etc.)\n        classes = ' public'\n        classes += ' can-upload' if @rootFolder.canUpload\n        @$el.addClass classes\n\n    getRenderData: ->\n        _.extend super(),\n            isPublic: true\n            areNotificationsEnabled: @rootFolder.publicNotificationsEnabled\n            hasPublicKey: @rootFolder.publicKey.length > 0\n\n    # Enable or disable guest notifications\n    onToggleNotificationClicked: ->\n\n        # Notifications are only handled for the root folder\n        key = window.location.search\n        url = \"#{@model.urlRoot()}#{@rootFolder.id}/notifications#{key}\"\n\n        # toggle notifications button and persist state in database\n        if @rootFolder.publicNotificationsEnabled\n            @rootFolder.publicNotificationsEnabled = false\n            @$('#notifications').html '&nbsp;'\n            @$('#notifications').spin 'tiny'\n            client.put url, notificationsState: false, (err) =>\n                @$('#notifications').spin false\n                unless err?\n                    @$('#notifications').html t 'notifications disabled'\n                    @$('#notifications').removeClass 'toggled'\n        else\n            @rootFolder.publicNotificationsEnabled = true\n            @$('#notifications').html '&nbsp;'\n            @$('#notifications').spin 'tiny'\n            client.put url, notificationsState: true, (err) =>\n                @$('#notifications').spin false\n                unless err?\n                    @$('#notifications').html t 'notifications enabled'\n                    @$('#notifications').addClass 'toggled'","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),model = locals_.model;\nif ( model.id == \"root\")\n{\nbuf.push(\"<li><a href=\\\"#\\\"><span>Files</span></a></li>\");\n}\nelse\n{\nif ( model.type == \"search\")\n{\nbuf.push(\"<li><a\" + (jade.attr(\"href\", \"#search/\" + (model.id) + \"\", true, false)) + \">\" + (jade.escape((jade_interp = model.name) == null ? '' : jade_interp)) + \"</a></li>\");\n}\nelse\n{\nbuf.push(\"<li><a\" + (jade.attr(\"href\", \"#folders/\" + (model.id) + \"\", true, false)) + \">\" + (jade.escape((jade_interp = model.name) == null ? '' : jade_interp)) + \"</a></li>\");\n}\n};return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),downloadUrl = locals_.downloadUrl;\nbuf.push(\"<div role=\\\"gridcell\\\" class=\\\"extensible-column\\\"><a style=\\\"display:none\\\" class=\\\"file-path\\\"></a><div class=\\\"caption-wrapper\\\"><div class=\\\"caption\\\"><a class=\\\"link-wrapper btn-link\\\"><div style=\\\"display: none\\\" class=\\\"spinholder\\\"><img src=\\\"images/spinner.svg\\\"/></div><i class=\\\"icon-type\\\"><img class=\\\"thumb\\\"/><span class=\\\"fa fa-globe\\\"></span></i><span class=\\\"file-name\\\"></span></a></div><ul class=\\\"tags\\\"></ul><div class=\\\"block-empty\\\"></div><div class=\\\"operations\\\"><a\" + (jade.attr(\"title\", \"\" + (t('tooltip tag')) + \"\", true, false)) + \" class=\\\"file-tags\\\"><span class=\\\"fa fa-tag\\\"></span></a><a\" + (jade.attr(\"title\", \"\" + (t('tooltip share')) + \"\", true, false)) + \" class=\\\"file-share\\\"><span class=\\\"fa fa-share-alt\\\"></span></a><a\" + (jade.attr(\"title\", \"\" + (t('tooltip edit')) + \"\", true, false)) + \" class=\\\"file-edit\\\"><span class=\\\"fa fa-pencil-square-o\\\"></span></a><a\" + (jade.attr(\"href\", \"\" + (downloadUrl) + \"\", true, false)) + \" target=\\\"_blank\\\"\" + (jade.attr(\"title\", \"\" + (t('tooltip download')) + \"\", true, false)) + \" class=\\\"file-download\\\"><span class=\\\"fa fa-download\\\"></span></a></div></div></div><div role=\\\"gridcell\\\" class=\\\"size-column-cell\\\"></div><div role=\\\"gridcell\\\" class=\\\"type-column-cell\\\"></div><div role=\\\"gridcell\\\" class=\\\"date-column-cell\\\"></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),iconClass = locals_.iconClass,thumbSrc = locals_.thumbSrc,model = locals_.model;\nbuf.push(\"<div role=\\\"gridcell\\\" class=\\\"extensible-column\\\"><a style=\\\"display:none\\\" class=\\\"file-path\\\"></a><div class=\\\"caption-wrapper\\\"><div class=\\\"caption\\\"><a class=\\\"link-wrapper btn-link\\\"><div style=\\\"display: none\\\" class=\\\"spinholder\\\"><img src=\\\"images/spinner.svg\\\"/></div><i\" + (jade.cls([\"\" + (iconClass) + \"\"], [true])) + \"><img\" + (jade.attr(\"src\", \"\" + (thumbSrc) + \"\", true, false)) + \" class=\\\"thumb\\\"/><span class=\\\"fa fa-globe\\\"></span></i></a></div><input\" + (jade.attr(\"value\", model.name, true, false)) + \" class=\\\"caption file-edit-name\\\"/><a class=\\\"btn btn-sm btn-cozy file-edit-save\\\">\" + (jade.escape((jade_interp = t(\"file edit save\")) == null ? '' : jade_interp)) + \"</a><a class=\\\"btn btn-sm btn-link file-edit-cancel\\\">\" + (jade.escape((jade_interp = t(\"file edit cancel\")) == null ? '' : jade_interp)) + \"</a><ul class=\\\"tags\\\"></ul><div class=\\\"block-empty\\\"></div><!-- empty!--></div></div><div role=\\\"gridcell\\\" class=\\\"size-column-cell\\\"></div><div role=\\\"gridcell\\\" class=\\\"type-column-cell\\\"></div><div role=\\\"gridcell\\\" class=\\\"date-column-cell\\\"></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),numSelectedElements = locals_.numSelectedElements,numElements = locals_.numElements,model = locals_.model;\nbuf.push(\"<!-- List's header.--><div role=\\\"rowheader\\\"><div role=\\\"columnheader\\\" class=\\\"extensible-column\\\"><button id=\\\"select-all\\\">\");\nif ( numSelectedElements == 0 || numElements == 0)\n{\nbuf.push(\"<i class=\\\"fa fa-square-o\\\"></i>\");\n}\nelse if ( numSelectedElements == numElements)\n{\nbuf.push(\"<i class=\\\"fa fa-check-square-o\\\"></i>\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"fa fa-minus-square-o\\\"></i>\");\n}\nbuf.push(\"</button><a id=\\\"down-name\\\" class=\\\"btn unactive fa fa-chevron-down\\\">\" + (jade.escape(null == (jade_interp = t('name')    ) ? \"\" : jade_interp)) + \"</a><a id=\\\"up-name\\\" class=\\\"btn unactive fa fa-chevron-up\\\">\" + (jade.escape(null == (jade_interp = t('name')) ? \"\" : jade_interp)) + \"</a></div><div role=\\\"columnheader\\\" class=\\\"size-column-cell\\\"><a id=\\\"down-size\\\" class=\\\"btn unactive fa fa-chevron-down\\\">\" + (jade.escape(null == (jade_interp = t('size')) ? \"\" : jade_interp)) + \"</a><a id=\\\"up-size\\\" class=\\\"btn unactive fa fa-chevron-up\\\">\" + (jade.escape(null == (jade_interp = t('size')) ? \"\" : jade_interp)) + \"</a></div><div role=\\\"columnheader\\\" class=\\\"type-column-cell\\\"><a id=\\\"down-class\\\" class=\\\"btn unactive fa fa-chevron-down\\\">\" + (jade.escape(null == (jade_interp = t('type')) ? \"\" : jade_interp)) + \"</a><a id=\\\"up-class\\\" class=\\\"btn unactive fa fa-chevron-up\\\">\" + (jade.escape(null == (jade_interp = t('type')) ? \"\" : jade_interp)) + \"</a></div><div role=\\\"columnheader\\\" class=\\\"date-column-cell\\\"><a id=\\\"down-lastModification\\\" class=\\\"btn unactive fa fa-chevron-down\\\">\" + (jade.escape(null == (jade_interp = t('date')) ? \"\" : jade_interp)) + \"</a><a id=\\\"up-lastModification\\\" class=\\\"btn unactive fa fa-chevron-up\\\">\" + (jade.escape(null == (jade_interp = t('date')) ? \"\" : jade_interp)) + \"</a></div></div><!-- List of elements.--><ul id=\\\"table-items-body\\\" role=\\\"grid\\\"><!-- the file info display (popover)--><div class=\\\"file-info\\\"></div></ul><!-- Footer.--><footer id=\\\"file-amount-indicator\\\"></footer><footer id=\\\"no-files-indicator\\\">\");\nif ( model.type == 'search')\n{\nbuf.push(\"\" + (jade.escape((jade_interp = t('no file in search')) == null ? '' : jade_interp)) + \"\");\n}\nelse\n{\nbuf.push(\"\" + (jade.escape((jade_interp = t('no file in folder')) == null ? '' : jade_interp)) + \"\");\n}\nbuf.push(\"</footer>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),isPublic = locals_.isPublic,hasPublicKey = locals_.hasPublicKey,query = locals_.query,model = locals_.model,clearance = locals_.clearance,supportsDirectoryUpload = locals_.supportsDirectoryUpload,areNotificationsEnabled = locals_.areNotificationsEnabled,zipUrl = locals_.zipUrl;\nbuf.push(\"<div id=\\\"affixbar\\\" data-spy=\\\"affix\\\" data-offset-top=\\\"1\\\"><div class=\\\"container\\\"><header class=\\\"row\\\"><div class=\\\"col-lg-12\\\"><div id=\\\"crumbs\\\" class=\\\"pull-left\\\"></div><div class=\\\"pull-right\\\">\");\nif ( !isPublic || hasPublicKey)\n{\nbuf.push(\"<input id=\\\"search-box\\\" type=\\\"search\\\"\" + (jade.attr(\"value\", \"\" + (query) + \"\", true, false)) + \" placeholder=\\\"Search\\\" class=\\\"pull-right\\\"/>\");\n}\nif ( model.type != 'search')\n{\nbuf.push(\"<div id=\\\"upload-buttons\\\" class=\\\"pull-right\\\">\");\nif ( model.id != 'root')\n{\nbuf.push(\"<span id=\\\"folder-state\\\">\");\nif ( clearance == 'public')\n{\nbuf.push(\"<span class=\\\"fa fa-globe\\\"></span><span class=\\\"text\\\">\" + (jade.escape((jade_interp = t('shared')) == null ? '' : jade_interp)) + \"</span>\");\n}\nelse if ( clearance && clearance.length > 0)\n{\nbuf.push(\"<span class=\\\"fa fa-globe\\\"></span><span class=\\\"text\\\">\" + (jade.escape((jade_interp = t('shared')) == null ? '' : jade_interp)) + \"</span><span>&nbsp;(\" + (jade.escape((jade_interp = clearance.length) == null ? '' : jade_interp)) + \")</span>\");\n}\nbuf.push(\"</span><a id=\\\"share-state\\\"\" + (jade.attr(\"title\", \"\" + (t('share')) + \"\", true, false)) + \" class=\\\"btn btn-cozy btn-cozy-contrast\\\"><span class=\\\"fa fa-share-alt\\\"></span></a>\");\n}\nbuf.push(\"<a id=\\\"button-upload-new-file\\\" class=\\\"btn btn-cozy\\\"><input id=\\\"uploader\\\" type=\\\"file\\\" multiple=\\\"multiple\\\"\" + (jade.attr(\"title\", t('upload button'), true, false)) + \"/><div class=\\\"action-icon file-uploader\\\"></div></a>\");\nif ( supportsDirectoryUpload)\n{\nbuf.push(\"<a id=\\\"button-upload-folder\\\" class=\\\"btn btn-cozy\\\"><input id=\\\"folder-uploader\\\" type=\\\"file\\\" directory=\\\"directory\\\" mozdirectory=\\\"mozdirectory\\\" webkitdirectory=\\\"webkitdirectory\\\"\" + (jade.attr(\"title\", t('upload folder msg'), true, false)) + \"/><div class=\\\"action-icon folder-uploader\\\"></div></a>\");\n}\nbuf.push(\"<a id=\\\"button-new-folder\\\"\" + (jade.attr(\"title\", t('new folder button'), true, false)) + \" class=\\\"btn btn-cozy\\\"><div class=\\\"action-icon folder-new\\\"></div></a><div id=\\\"bulk-actions-btngroup\\\" class=\\\"btn-group\\\">\");\nif ( isPublic)\n{\nbuf.push(\"<a id=\\\"button-bulk-download\\\"\" + (jade.attr(\"title\", \"\" + (t('download all')) + \"\", true, false)) + \" class=\\\"btn btn-cozy-contrast\\\"><span class=\\\"label\\\">\" + (jade.escape((jade_interp = t(\"download all\")) == null ? '' : jade_interp)) + \"&nbsp;</span><span class=\\\"fa fa-download icon-white\\\"></span></a>\");\n}\nelse\n{\nbuf.push(\"<a id=\\\"button-bulk-download\\\"\" + (jade.attr(\"title\", \"\" + (t('download all')) + \"\", true, false)) + \" class=\\\"btn btn-cozy\\\"><span class=\\\"fa fa-download\\\"></span></a>\");\n}\nbuf.push(\"<a id=\\\"button-bulk-move\\\"\" + (jade.attr(\"title\", \"\" + (t('move all')) + \"\", true, false)) + \" class=\\\"btn btn-cozy btn-cozy\\\"><span class=\\\"fa fa-file\\\"></span><span class=\\\"fa fa-arrow-right\\\"></span></a><a id=\\\"button-bulk-remove\\\"\" + (jade.attr(\"title\", \"\" + (t('remove all')) + \"\", true, false)) + \" class=\\\"btn btn-cozy btn-cozy\\\"><span class=\\\"fa fa-trash-o\\\"></span></a></div></div>\");\nif ( isPublic && hasPublicKey)\n{\nif ( areNotificationsEnabled)\n{\nbuf.push(\"<a id=\\\"notifications\\\" class=\\\"btn btn-cozy toggled\\\">\" + (jade.escape(null == (jade_interp = t('notifications enabled')) ? \"\" : jade_interp)) + \"</a>\");\n}\nelse\n{\nbuf.push(\"<a id=\\\"notifications\\\" class=\\\"btn btn-cozy\\\">\" + (jade.escape(null == (jade_interp = t('notifications disabled')) ? \"\" : jade_interp)) + \"</a>\");\n}\nbuf.push(\"&nbsp;\");\n}\nbuf.push(\"<a id=\\\"download-link\\\"\" + (jade.attr(\"href\", \"\" + (zipUrl) + \"\", true, false)) + (jade.attr(\"title\", t(\"download\"), true, false)) + \" class=\\\"btn btn-cozy-contrast\\\">\" + (jade.escape((jade_interp = t(\"download\")) == null ? '' : jade_interp)) + \"&nbsp;<i class=\\\"icon-arrow-down icon-white\\\"></i></a>\");\n}\nbuf.push(\"</div></div></header><div class=\\\"row\\\"><div id=\\\"upload-status-container\\\" class=\\\"col-lg-12\\\"></div></div></div></div><div class=\\\"container\\\"><div class=\\\"row\\\"><div id=\\\"content\\\" class=\\\"col-lg-12\\\"><div id=\\\"loading-indicator\\\"><img src=\\\"images/spinner.svg\\\" width=\\\"20\\\"/></div><div id=\\\"files\\\" class=\\\"files\\\"></div><div id=\\\"files-drop-zone\\\"><div class=\\\"overlay\\\"></div><div class=\\\"vertical-container\\\"><p>\" + (jade.escape(null == (jade_interp = t('drop message')) ? \"\" : jade_interp)) + \"</p></div></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),title = locals_.title,msg = locals_.msg,no = locals_.no,yes = locals_.yes;\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><button type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"close\\\">×</button><h4 class=\\\"modal-title\\\">\" + (jade.escape((jade_interp = title) == null ? '' : jade_interp)) + \"</h4></div><div class=\\\"modal-body\\\"><p>\" + (jade.escape((jade_interp = msg) == null ? '' : jade_interp)) + \"</p></div><div class=\\\"modal-footer\\\">\");\nif ( no)\n{\nbuf.push(\"<button id=\\\"modal-dialog-no\\\" type=\\\"button\\\" class=\\\"btn btn-link\\\">\" + (jade.escape((jade_interp = no) == null ? '' : jade_interp)) + \"</button>\");\n}\nif ( yes)\n{\nbuf.push(\"<button id=\\\"modal-dialog-yes\\\" type=\\\"button\\\" class=\\\"btn btn-cozy\\\">\" + (jade.escape((jade_interp = yes) == null ? '' : jade_interp)) + \"</button>\");\n}\nbuf.push(\"</div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><button type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"close\\\">×</button><h4 class=\\\"modal-title\\\">\" + (jade.escape((jade_interp = t(\"new folder caption\")) == null ? '' : jade_interp)) + \"</h4></div><div class=\\\"modal-body\\\"><fieldset><div class=\\\"form-group\\\"><label for=\\\"inputName\\\">\" + (jade.escape((jade_interp = t(\"new folder msg\")) == null ? '' : jade_interp)) + \"</label><input id=\\\"inputName\\\" type=\\\"text\\\" class=\\\"form-control\\\"/></div><div id=\\\"folder-upload-form\\\" class=\\\"form-group hide\\\"><br/><p class=\\\"text-center\\\">\" + (jade.escape(null == (jade_interp = t('upload folder separator')) ? \"\" : jade_interp)) + \"</p><label for=\\\"inputName\\\">\" + (jade.escape((jade_interp = t(\"upload folder msg\")) == null ? '' : jade_interp)) + \"</label><input id=\\\"folder-uploader\\\" type=\\\"file\\\" directory=\\\"directory\\\" mozdirectory=\\\"mozdirectory\\\" webkitdirectory=\\\"webkitdirectory\\\" class=\\\"form-control\\\"/></div></fieldset></div><div class=\\\"modal-footer\\\"><button id=\\\"modal-dialog-no\\\" type=\\\"button\\\" data-dismiss=\\\"modal\\\" class=\\\"btn btn-link\\\">\" + (jade.escape((jade_interp = t(\"new folder close\")) == null ? '' : jade_interp)) + \"</button><button id=\\\"modal-dialog-yes\\\" type=\\\"button\\\" disabled=\\\"disabled\\\" class=\\\"btn btn-cozy-contrast\\\">\" + (jade.escape((jade_interp = t(\"new folder send\")) == null ? '' : jade_interp)) + \"</button></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),value = locals_.value;\nbuf.push(\"<div class=\\\"progress active\\\"><div role=\\\"progressbar\\\"\" + (jade.attr(\"aria-valuenow\", \"\" + (value) + \"\", true, false)) + \" aria-valuemin=\\\"0\\\" aria-valuemax=\\\"100\\\"\" + (jade.attr(\"style\", \"width: \" + (value) + \"%\", true, false)) + \" class=\\\"progress-bar progress-bar-info\\\">\" + (jade.escape((jade_interp = value) == null ? '' : jade_interp)) + \"%</div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),value = locals_.value;\nbuf.push(\"<span>\" + (jade.escape(null == (jade_interp = t('upload running')) ? \"\" : jade_interp)) + \"</span><div id=\\\"dismiss\\\" class=\\\"btn btn-cozy pull-right\\\">\" + (jade.escape(null == (jade_interp = t('ok')) ? \"\" : jade_interp)) + \"</div><div class=\\\"progress active pull-right\\\"><div\" + (jade.attr(\"style\", \"width: \" + value, true, false)) + \" class=\\\"progress-bar progress-bar-info\\\"></div><div class=\\\"progress-bar progress-bar-content\\\">\" + (jade.escape((jade_interp = t('total progress')) == null ? '' : jade_interp)) + \" \" + (jade.escape((jade_interp = value) == null ? '' : jade_interp)) + \"</div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","BaseView = require '../lib/base_view'\nFile = require '../models/file'\nProgressBar = require '../widgets/progressbar'\n\nmodule.exports = class UploadStatusView extends BaseView\n\n    id: \"upload-status\"\n    template: require './templates/upload_status'\n\n    events: ->\n        'click #dismiss': 'resetCollection'\n\n    initialize: (options) ->\n        super options\n        @uploadQueue = options.uploadQueue\n\n        @listenTo @collection, 'add', @uploadCount\n        @listenTo @collection, 'remove', @uploadCount\n        @listenTo @uploadQueue, 'reset', @render\n        @listenTo @uploadQueue, 'upload-progress', @progress\n        @listenTo @uploadQueue, 'upload-complete', @complete\n\n    getRenderData: ->\n        if @collection.progress\n            {loadedBytes, totalBytes} = @collection.progress\n            value = parseInt(100 * loadedBytes / totalBytes) + '%'\n        else\n            value = '0 %'\n\n        return data =\n            value: value\n            collection: @collection\n\n    progress: (e) ->\n        @$el.removeClass 'success danger warning'\n        progress = parseInt(100 * e.loadedBytes / e.totalBytes)\n        percentage =  \"#{progress}%\"\n        @progressbar.width percentage\n        @progressbarContent.text \"#{t('total progress')} : #{percentage}\"\n\n    complete: ->\n        @$('.progress').remove()\n        result = @uploadQueue.getResults()\n        if result.success > 0 or result.errorList.length > 0 \\\n        or result.existingList.length > 0\n            @dismiss.show()\n\n            @$el.addClass result.status\n            @$('span').text [\n                if result.success\n                    t 'upload complete', smart_count: result.success\n                if result.existingList.length\n                    @makeExistingSentence result.existingList\n\n                if result.errorList.length\n                    @makeErrorSentence result.errorList\n            ].join ' '\n        else\n            @resetCollection()\n\n    # generate a sentence explaining existing files\n    makeExistingSentence: (existing) ->\n        parts = [existing[0].get('name')]\n        if existing.length > 1\n            parts.push t('and x files', smart_count: existing.length - 1)\n        parts.push t 'already exists'\n\n        return parts.join ' '\n\n    # generate a sentence explaining error files\n    makeErrorSentence: (errors) ->\n        parts = []\n        parts.push \"#{errors.pop().get 'name'}\"\n        if errors.length > 1\n            parts.push t 'and x files', smart_count: errors.length - 1\n        parts.push t 'failed to upload', smart_count: errors.length - 1\n        if errors.length > 1\n            parts.push ': '\n            parts.push \"#{errors.pop().get 'name'}\"\n            parts.push \", #{error.get 'name'}\" for error in errors\n\n        return parts.join ' '\n\n\n    resetCollection: -> @uploadQueue.reset()\n\n\n    uploadCount: (e) ->\n        if @collection.length > 0\n            @$el.show()\n            $('#content').addClass 'mt108'\n        else\n            @render()\n\n        @render() if @completed and not @collection.completed\n\n\n    afterRender: ->\n        @$el.removeClass 'success danger warning'\n\n        @progressbar = @$ '.progress-bar-info'\n        @progressbarContent = @$ '.progress-bar-content'\n        @dismiss = @$('#dismiss').hide()\n\n        if @collection.length is 0\n            @$el.hide()\n            $('#content').removeClass 'mt108'\n        else\n            $('#content').addClass 'mt108'\n\n        if @uploadQueue.completed then @complete()\n\n","BaseView = require '../lib/base_view'\n\nmodule.exports = class ProgressbarView extends BaseView\n\n    className: 'progressview'\n    template: require '../views/templates/progressbar'\n    value: 0\n\n    initialize: ->\n        @listenTo @model, 'progress', @update\n        @listenTo @model, 'sync', @destroy\n\n        @value = @getProgression @model.loaded, @model.total\n\n    update: (e) ->\n        @value = @getProgression e.loaded, e.total\n        @$('.progress-bar').text(@value + '%').width @value + '%'\n\n    getProgression: (loaded, total) ->\n        return parseInt(loaded / total * 100)\n\n    getRenderData: ->\n        value: @value\n        name: @model.get 'name'\n","BaseView     = require '../lib/base_view'\n\nmodule.exports = class TagsView2 extends BaseView\n\n\n    events: ->\n        'click .tag'          : 'tagClicked'\n        'click .tag .deleter' : 'deleteTag'\n        'focus input'         : 'onFocus'\n        'blur input'          : 'onBlur'\n        'keydown input'       : 'onKeyDown'\n\n\n    inputTemplate: -> \"\"\"\n        <input type=\"text\" placeholder=\"#{t('tag')}\">\n    \"\"\"\n\n\n    initialize: ->\n        @tags              = []\n        @lastHideInputTime = 0\n        @lastSelectTime    = 0\n        @input             = null # ref to the input element if created\n\n\n    onBlur: (e) =>\n        if @input\n            @hideInput()\n        e.stopPropagation()\n\n        # comment previous lines and\n        # un-comment the followin for debug so that the autocomplete suggestion\n        # doesn't close when element looses focus\n        # Tag to search the other place to un-comment : azeklh\n        # @input.typeahead('open')\n\n\n    onKeyDown: (e) =>\n\n        val = @input.val()\n        # console.log e.keyCode, val\n\n        # ESC\n        if e.keyCode is 27\n            # don't use hideInput, otherwise there will also be a on blur event\n            # and there would be two call to hideInput...\n            if @lastNavigatedItem == null\n                @input.blur()\n            else\n                @input.typeahead('open')\n\n        # TAB, ENTER : add the tag in the file\n        if val and e.keyCode in [9, 13]\n            @tags ?= []\n            if val in @tags\n                return\n            @tags.push val\n            window.tags.push val\n            window.tags.sort (a, b) ->\n                return a.toLowerCase().localeCompare(b.toLowerCase())\n            @setTags @tags\n            @input.typeahead('val', '')\n            @lastNavigatedItem = null\n            e.preventDefault()\n            e.stopPropagation()\n            return\n\n        # ENTER and no value\n        if val=='' and e.keyCode is 13\n            time = new Date()\n            if time - @lastSelectTime < 200\n                # console.log \"close asked too quick !\"\n                return\n            @input.blur()\n\n        #UP, DOWN\n        if e.keyCode in [40, 38]\n            # keep track of the items seen with UP & DOWN\n            @lastNavigatedItem = val\n        else\n            @lastNavigatedItem = null\n\n\n    tagClicked: (e) ->\n        tag = e.target.dataset.value\n        # simulate search\n        $(\"#search-box\").val(\"tag:#{tag}\").trigger 'keyup'\n\n\n    setTags: (newTags) =>\n        @tags = newTags\n        @tags ?= []\n        @refresh()\n        clearTimeout @saveLater\n        @saveLater = setTimeout =>\n            @model.save tags: @tags\n        , 1000 # 3s\n\n\n    deleteTag: (e) =>\n        tag = e.target.parentNode.dataset.value\n        @setTags _.without @tags, tag\n        e.stopPropagation()\n        e.preventDefault()\n\n\n    refresh: (model) =>\n        if model?\n            @model = model\n            @tags  = @model.get('tags')\n            @listenTo @model, 'change:tags', =>\n                @tags = @model.get('tags')\n                @refresh()\n\n        @$('.tag').remove()\n        html = (\"\"\"\n                <li class=\"tag\" data-value=\"#{tag}\">\n                    #{tag}\n                    <span class=\"deleter fa fa-times\"></span>\n                </li>\n            \"\"\" for tag in @tags or []).join ''\n        @$el.prepend html\n\n\n    hideInput: =>\n        console.log 'tags.hideInput'\n        if !@input\n            return\n        @lastHideInputTime = new Date()\n        @input.typeahead('destroy')\n        @input.remove()\n        @input = null\n\n\n    showInput: =>\n        # don't show if this one has been hidden less than 200ms before (happens\n        # if you click on the show button while the input has focus)\n        time = new Date()\n        if time - @lastHideInputTime < 200\n            # console.log \"show asked too quick !\"\n            return\n        if @input\n            @input.typeahead('open')\n        else\n            @$el.append(@inputTemplate)\n            @input = @$el.children().last()\n            @showAutoComp()\n\n\n    showAutoComp: () =>\n        console.log 'showAutoComp'\n        @possibleTags = _.difference(window.tags,@tags)\n\n        ###*\n         * in charge to evaluate the items matching the query (string type by\n         * the user in the input\n        ###\n        substringMatcher = (query, cb) =>\n            items = @possibleTags\n            lastQuery = query\n\n            if query == ''\n                cb items\n                return\n\n            # an array that will be populated with the item wich matches\n            matches = []\n\n            # regexs used to determine if a string matches\n            queryWords = query.toLowerCase().trim().split(' ')\n            regExpList = []\n            for word in queryWords\n                if !reg = regExpHistory[word]\n                    reg = new RegExp( word.split('').join('.*?'), 'g' )\n                    regExpHistory[word] = reg\n                regExpList.push reg\n\n            # iterate through the pool of strings to find those that matche\n            # all the regexp\n            for item in items\n                itemMatched = true\n                for regExp in regExpList\n                    if not regExp.test(item.toLowerCase())\n                        itemMatched = false\n                        break\n                    regExp.lastIndex = 0\n                if itemMatched\n                    matches.push item\n\n            cb matches\n\n\n        ###*\n         * in charge to produce the html for a suggestion line\n         * @param  {String} item the suggestion text\n         * @return {String}      html string\n        ###\n        suggestionTemplator = (item)=>\n            val = @input.typeahead('val')\n            if val == ''\n                return html = \"<p>#{item}</p>\"\n            queryWords = val.toLowerCase().trim().split(' ')\n            itemLC = item.toLowerCase()\n            fullWordsToHighlight = Array(item.length)\n\n            for word in queryWords\n                wordRegexp = regExpHistory[word]\n                wordRegexp.lastIndex = 0\n                fullWordMatch_N = 0\n                fuzzyWordsToHighlight = Array(item.length)\n\n                # for each word of the query look for an occurence to\n                # highlight\n                while match = wordRegexp.exec(itemLC)\n                    # if the occurence is a contiguous string, keep it\n                    if match[0].length == word.length\n                        fullWordMatch_N++\n                        trackCharsToHighlight(itemLC, fullWordsToHighlight,match.index,word)\n                    # else keep it only if so far there was no full match\n                    else if fullWordMatch_N == 0\n                        trackCharsToHighlight(itemLC, fuzzyWordsToHighlight,match.index,word)\n                # if there were only fuzzy match, fusionnates the fuzzy\n                # chars to highllight with the full match chars.\n                if fullWordMatch_N == 0\n                    for isToHighlight,n in fuzzyWordsToHighlight\n                        if isToHighlight\n                            fullWordsToHighlight[n] = true\n\n            return html = highlightItem(item,fullWordsToHighlight)\n\n        ###*\n         * instanciation of the autocomplete (typeahead.js)\n        ###\n        @input.typeahead {\n          hint      : true\n          highlight : true\n          minLength : 0\n        },\n          limit     : 20,\n          name      : \"tag\",\n          source    : substringMatcher,\n          templates :\n            suggestion: suggestionTemplator\n\n        ###*\n         * listen to selections (mouse click in the suggestions)\n        ###\n        @input.bind 'typeahead:select', (ev, suggestion) =>\n            # console.log('typeahead:select ' + suggestion)\n            @lastSelectTime = new Date()\n            @tags ?= []\n            if suggestion in @tags\n                return\n            @tags.push suggestion\n            # remove the chosen suggestion from the possible tags\n            @possibleTags = _.without(@possibleTags,suggestion)\n            @setTags @tags\n            # force to evaluate the suggestions because the possible tags has changed\n            @input.typeahead('val', 'qsfqsdgf')\n            @input.typeahead('val', '')\n            @lastNavigatedItem = null\n\n        ###*\n         * listen when the suggestions are closed in order to reopen it if it is\n         * a click (select) that triggered the close.\n        ###\n        @input.bind 'typeahead:close', (ev, suggestion) =>\n            # console.log('typeahead:close ' + suggestion)\n            time = new Date()\n            if time - @lastSelectTime < 200\n                # console.log \"close asked too quick !\"\n                @input.typeahead('open')\n                return\n            # un-comment for debug so that the autocomplete suggestion doesn't\n            # close when element looses focus\n            # Tag to search the other place to un-comment : azeklh\n            # @input.typeahead('open')\n\n        @input.focus()\n        @lastNavigatedItem = null\n\n\n\n\n###\n    functions for the auto complete (highliths helpers)\n###\n\n\nregExpHistory = {}\nlastQuery     = ''\n\n\ntrackCharsToHighlight = (item, charsToHighlight,startIndex,word)->\n    charsToHighlight[startIndex] = true\n    nChars = item.length\n    charIndex = startIndex\n    wordIndex = 1\n    while charIndex < nChars\n        char = item[charIndex]\n        if  char == word[wordIndex]\n            charsToHighlight[charIndex] = true\n            if ++wordIndex >= word.length\n                return\n        charIndex++\n    return\n\n\nhighlightItem = (item,charsToHighlight) ->\n    res = '<p>'\n    previousWasToHighlight = undefined\n    for isToHighlight, n in charsToHighlight\n        if isToHighlight == previousWasToHighlight\n           res +=  item[n]\n        else\n            if previousWasToHighlight\n                res += '</strong>' + item[n]\n            else\n                res += '<strong class=\"tt-highlight\">' + item[n]\n        previousWasToHighlight = isToHighlight\n    if previousWasToHighlight\n        return res += '</strong></p>'\n    else\n        return res += '</p>'\n"]}